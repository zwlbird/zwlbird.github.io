<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Qt | .oOo.</title><meta name="keywords" content="Qt,qss"><meta name="author" content="Smt"><meta name="copyright" content="Smt"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="qt临时存储库https:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;qtproject&#x2F;online&#x2F;qtsdkrepository&#x2F;windows_x86&#x2F;root&#x2F;qt&#x2F; &amp;#122;&amp;#119;&amp;#x6c;&amp;#57;&amp;#51;&amp;#x31;&amp;#48;&amp;#50;&amp;#53;&amp;#x40;&amp;#x71;&amp;#113;&amp;#46;&amp;#x63;&amp;#x6f;&amp;#x6d;  Zhai123 QT中QString">
<meta property="og:type" content="article">
<meta property="og:title" content="Qt">
<meta property="og:url" content="https://zwlbird.github.io/2021/06/27/Qt/index.html">
<meta property="og:site_name" content=".oOo.">
<meta property="og:description" content="qt临时存储库https:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;qtproject&#x2F;online&#x2F;qtsdkrepository&#x2F;windows_x86&#x2F;root&#x2F;qt&#x2F; &amp;#122;&amp;#119;&amp;#x6c;&amp;#57;&amp;#51;&amp;#x31;&amp;#48;&amp;#50;&amp;#53;&amp;#x40;&amp;#x71;&amp;#113;&amp;#46;&amp;#x63;&amp;#x6f;&amp;#x6d;  Zhai123 QT中QString">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2023/12/12/SNjXLprxbadKoJ8.jpg">
<meta property="article:published_time" content="2021-06-27T14:14:42.000Z">
<meta property="article:modified_time" content="2024-02-23T09:52:11.939Z">
<meta property="article:author" content="Smt">
<meta property="article:tag" content="Qt">
<meta property="article:tag" content="qss">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2023/12/12/SNjXLprxbadKoJ8.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://zwlbird.github.io/2021/06/27/Qt/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Qt',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-02-23 17:52:11'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s2.loli.net/2023/12/12/SNjXLprxbadKoJ8.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">.oOo.</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Qt</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-06-27T14:14:42.000Z" title="发表于 2021-06-27 22:14:42">2021-06-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-02-23T09:52:11.939Z" title="更新于 2024-02-23 17:52:11">2024-02-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Qt/">Qt</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">38.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>159分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Qt"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2021/06/27/Qt/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/2021/06/27/Qt/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="qt临时存储库"><a href="#qt临时存储库" class="headerlink" title="qt临时存储库"></a>qt临时存储库</h1><p><a target="_blank" rel="noopener" href="https://mirrors.ustc.edu.cn/qtproject/online/qtsdkrepository/windows_x86/root/qt/">https://mirrors.ustc.edu.cn/qtproject/online/qtsdkrepository/windows_x86/root/qt/</a></p>
<p><a href="mailto:&#122;&#119;&#x6c;&#57;&#51;&#x31;&#48;&#50;&#53;&#x40;&#x71;&#113;&#46;&#x63;&#x6f;&#x6d;">&#122;&#119;&#x6c;&#57;&#51;&#x31;&#48;&#50;&#53;&#x40;&#x71;&#113;&#46;&#x63;&#x6f;&#x6d;</a>  Zhai123</p>
<h1 id="QT中QString-格式化-arg前面自动补0"><a href="#QT中QString-格式化-arg前面自动补0" class="headerlink" title="QT中QString 格式化 arg前面自动补0"></a>QT中QString 格式化 arg前面自动补0</h1><p>如这样的字符串： 00：01：23</p>
<p>将3个int转化为字符串时，使用arg的其它参数；</p>
<p>代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QString str = QString(&quot;%1:%2:%3&quot;).arg(0,2,10,QLatin1Char(&#x27;0&#x27;)).arg(1,2,10,QLatin1Char(&#x27;0&#x27;)) .arg(23,2,10,QLatin1Char(&#x27;0&#x27;));</span><br></pre></td></tr></table></figure>

<p>arg中第二个参数表示字符串的位数，第三个参数表示int的进制，第4个参数表示自动补全的字符；</p>
<p>如，改为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QString str = QString(&quot;%1:%2:%3&quot;).arg(0,4,10,QLatin1Char(&#x27;x&#x27;)).arg(1,2,10,QLatin1Char(&#x27;0&#x27;)) .arg(23,2,10,QLatin1Char(&#x27;0&#x27;));</span><br></pre></td></tr></table></figure>

<p>则输出为：xxx0:01:23</p>
<h1 id="手动生成moc"><a href="#手动生成moc" class="headerlink" title="手动生成moc"></a>手动生成moc</h1><p>Qt 程序在交由标准编译器编译之前，先要使用 moc 分析 C++ 源文件。如果它发现在一个头文件中包含了宏 Q_OBJECT，则会生成另外一个 C++ 源文件。这个源文件中包含了 Q_OBJECT 宏的实现代码。这个新的文件名字将会是原文件名前面加上 moc_ 构成。这个新的文件同样将进入编译系统，最终被链接到二进制代码中去。因此我们可以知道，这个新的文件不是“替换”掉旧的文件，而是与原文件一起参与编译。</p>
<p>vs2010集成Qt后，编译无法生成moc文件，此时可以采用手动方式生成：</p>
<p>在命令行下输入moc yourfilename.h -o moc_youfilename.cpp生成不带Q_OBJENT的源文件。</p>
<p> 下面给出例子手动生成moc的例子：</p>
<p>1、首先在运行窗口中输入cmd</p>
<p><img src="/2021/06/27/Qt/0.06866217441539683.png" alt="img"></p>
<p>2、在cmd中输入：cd  C:\Qt\4.7.4\bin进入Qt安装目录，如下图：</p>
<p><img src="/2021/06/27/Qt/0.5271939532118008.png" alt="img"></p>
<p>3、输入：moc “E:\03 Code\QUnitTest\DlgFindDialog.h” -o “E:\03 Code\QUnitT</p>
<p>est\moc_DlgFindDialog.cpp” 后回车</p>
<p><img src="/2021/06/27/Qt/0.20485906613358248.png" alt="img"></p>
<p>4、打开E:\03 Code\QUnitTest，moc_DlgFindDialog.cpp已经生成</p>
<p><img src="/2021/06/27/Qt/0.6527109725512811.png" alt="img"></p>
<p>5、到此moc文件已经生成完毕。</p>
<h1 id="编译rcc"><a href="#编译rcc" class="headerlink" title="编译rcc"></a>编译rcc</h1><p>资源修改步骤<br>1，在项目里加入resource.qrc使用，增加资源放开注释<br>RESOURCES += <br>    resource/resource.qrc<br>2，添加并正常使用资源<br>3，更新资源二进制文件resource.rcc，在resource文件夹里cmd执行<br>rcc –binary resource.qrc -o resource.rcc<br>4，在项目中删除resource.qrc，注释掉，重新编译项目</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pro中注释</span><br><span class="line">#RESOURCES += resource/resource.qrc</span><br><span class="line">程序的main文件中加：</span><br><span class="line">QResource::<span class="built_in">registerResource</span>(<span class="string">&quot;./resource/resource.rcc&quot;</span>);</span><br></pre></td></tr></table></figure>

<h1 id="qimage-创建背景色透明"><a href="#qimage-创建背景色透明" class="headerlink" title="qimage 创建背景色透明"></a>qimage 创建背景色透明</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> QImage _image(m_pImgProvider-&gt;img.<span class="built_in">size</span>(),m_pImgProvider-&gt;img.format());</span><br><span class="line">QImage  mask = _image.<span class="built_in">createMaskFromColor</span>((<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>),Qt::MaskOutColor);</span><br><span class="line">_image.<span class="built_in">setAlphaChannel</span>(mask);</span><br></pre></td></tr></table></figure>

<h1 id="QPainter-设置线形，填充，笔帽，圆点"><a href="#QPainter-设置线形，填充，笔帽，圆点" class="headerlink" title="QPainter 设置线形，填充，笔帽，圆点"></a>QPainter 设置线形，填充，笔帽，圆点</h1><p><img src="/2021/06/27/Qt/1da2b7ee-dc93-48cd-ae1f-33428210c629.jpg" alt="img"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> QPen pen1;</span><br><span class="line">pen1.<span class="built_in">setCapStyle</span>(Qt::PenCapStyle::RoundCap);</span><br><span class="line">pen1.<span class="built_in">setColor</span>(Qt::red);</span><br><span class="line">pen1.<span class="built_in">setWidth</span>(<span class="number">20</span>);</span><br><span class="line">painter.<span class="built_in">setPen</span>(pen1);</span><br><span class="line">painter.<span class="built_in">drawPoint</span>(<span class="number">100</span>,<span class="number">100</span>);</span><br></pre></td></tr></table></figure>

<h1 id="随鼠标进入现实图片放大"><a href="#随鼠标进入现实图片放大" class="headerlink" title="随鼠标进入现实图片放大"></a>随鼠标进入现实图片放大</h1><p>.h</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> SHOWICONWIDGET_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SHOWICONWIDGET_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QLabel&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QWidget&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ShowIconWidget</span> :</span> <span class="keyword">public</span> QWidget</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">ShowIconWidget</span><span class="params">(QWidget *parent = <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setPixmap</span><span class="params">(<span class="keyword">const</span> QPixmap&amp; map)</span></span>;</span><br><span class="line">    ~<span class="built_in">ShowIconWidget</span>();</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">paintEvent</span><span class="params">(QPaintEvent *event)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">enterEvent</span><span class="params">(QEvent *event)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">leaveEvent</span><span class="params">(QEvent *event)</span></span>;</span><br><span class="line">signals:</span><br><span class="line"><span class="keyword">public</span> slots:</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    QLabel m_MaxMap;</span><br><span class="line">    QPixmap m_map;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// SHOWICONWIDGET_H</span></span></span><br></pre></td></tr></table></figure>

<p>.cpp</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;ShowIconWidget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QApplication&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QDesktopWidget&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QPainter&gt;</span></span></span><br><span class="line">ShowIconWidget::<span class="built_in">ShowIconWidget</span>(QWidget *parent) : <span class="built_in">QWidget</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">setMouseTracking</span>(<span class="literal">true</span>);</span><br><span class="line">    m_MaxMap.<span class="built_in">setParent</span>(<span class="keyword">this</span>);</span><br><span class="line">    m_MaxMap.<span class="built_in">setWindowFlag</span>(Qt::Tool);</span><br><span class="line">    m_MaxMap.<span class="built_in">setWindowFlag</span>(Qt::FramelessWindowHint);</span><br><span class="line">    m_MaxMap.<span class="built_in">setAttribute</span>(Qt::WA_TranslucentBackground);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ShowIconWidget::setPixmap</span><span class="params">(<span class="keyword">const</span> QPixmap &amp;map)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    m_map = map;</span><br><span class="line">    m_MaxMap.<span class="built_in">setPixmap</span>(m_map);</span><br><span class="line">    m_MaxMap.<span class="built_in">setFixedSize</span>(m_map.<span class="built_in">size</span>());</span><br><span class="line">&#125;</span><br><span class="line">ShowIconWidget::~<span class="built_in">ShowIconWidget</span>()</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ShowIconWidget::paintEvent</span><span class="params">(QPaintEvent *event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> QPainter p;</span><br><span class="line">    p.<span class="built_in">begin</span>(<span class="keyword">this</span>);</span><br><span class="line">    p.<span class="built_in">drawPixmap</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="keyword">this</span>-&gt;<span class="built_in">width</span>(),<span class="keyword">this</span>-&gt;<span class="built_in">height</span>(),m_map);</span><br><span class="line">    p.<span class="built_in">end</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ShowIconWidget::enterEvent</span><span class="params">(QEvent *event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QRect screenRect = QApplication::<span class="built_in">desktop</span>()-&gt;<span class="built_in">screenGeometry</span>();</span><br><span class="line">    <span class="keyword">int</span> x,y;</span><br><span class="line">    <span class="keyword">if</span>(screenRect.<span class="built_in">height</span>()-<span class="built_in">cursor</span>().<span class="built_in">pos</span>().<span class="built_in">y</span>()&gt;m_MaxMap.<span class="built_in">height</span>())&#123;</span><br><span class="line">        y = <span class="built_in">cursor</span>().<span class="built_in">pos</span>().<span class="built_in">y</span>();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        y = <span class="built_in">cursor</span>().<span class="built_in">pos</span>().<span class="built_in">y</span>()-m_MaxMap.<span class="built_in">height</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(screenRect.<span class="built_in">width</span>()-<span class="built_in">cursor</span>().<span class="built_in">pos</span>().<span class="built_in">x</span>()&gt;m_MaxMap.<span class="built_in">width</span>())&#123;</span><br><span class="line">        x = <span class="built_in">cursor</span>().<span class="built_in">pos</span>().<span class="built_in">x</span>();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        x = <span class="built_in">cursor</span>().<span class="built_in">pos</span>().<span class="built_in">x</span>()-m_MaxMap.<span class="built_in">width</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    m_MaxMap.<span class="built_in">move</span>(x,y);</span><br><span class="line">    m_MaxMap.<span class="built_in">show</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ShowIconWidget::leaveEvent</span><span class="params">(QEvent *event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    m_MaxMap.<span class="built_in">hide</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>使用</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ShowIconWidget *w=new ShowIconWidget;</span><br><span class="line">w-&gt;setFixedSize(100,100);</span><br><span class="line">w-&gt;setPixmap(map);</span><br><span class="line">ui-&gt;horizontalLayout_28-&gt;addWidget(w);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ui-&gt;horizontalLayout_28 是ScrollArea里面的Layout</span><br></pre></td></tr></table></figure>

<h1 id="右键菜单"><a href="#右键菜单" class="headerlink" title="右键菜单"></a>右键菜单</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">QMenu* m_menu=nullptr;  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m_menu = new QMenu(this);</span><br><span class="line">QAction *act1 = new QAction(QStringLiteral(&quot;保存图片&quot;),m_menu);</span><br><span class="line">connect(act1,SIGNAL(triggered()),this,SLOT(slot_menuSave()));</span><br><span class="line">m_menu-&gt;addAction(act1);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m_menu-&gt;move(event-&gt;globalX(),event-&gt;globalY());</span><br><span class="line">m_menu-&gt;exec();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="QT—5种标准对话框"><a href="#QT—5种标准对话框" class="headerlink" title="QT—5种标准对话框"></a>QT—5种标准对话框</h1><p><img src="/2021/06/27/Qt/image-20231213170140063.png" alt="image-20231213170140063"></p>
<h2 id="QFileDialog文件对话框"><a href="#QFileDialog文件对话框" class="headerlink" title="QFileDialog文件对话框"></a>QFileDialog文件对话框</h2><p>文件对话框可以通过调用QFileDialog::getOpenFileName方法实现，方法的第一个参数指定窗体的父窗体、第二个参数指定窗体的标题、第三个参数指定窗体的打开目录、第四个参数用于限定打开的文件类型，有多个类型时中间用;;隔开。下面程序演示了当用户点击按钮后会弹出文件对话框，之后将用户选择的文件路劲显示在文本框中。</p>
<p><img src="/2021/06/27/Qt/a782bba90e64491cbfa26bebbd96f7bf.gif" alt="img"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//文件对话框</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Dialog::ShowFileDlg</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//打开文件对话框</span></span><br><span class="line">    <span class="comment">//函数返回打开的路径</span></span><br><span class="line">    QString sPath = QFileDialog::<span class="built_in">getOpenFileName</span>(</span><br><span class="line">                <span class="keyword">this</span>,<span class="comment">//指定父窗口</span></span><br><span class="line">                <span class="string">&quot;标准文件对话框&quot;</span>,<span class="comment">//打开文件对话框的标题</span></span><br><span class="line">                <span class="string">&quot;.&quot;</span>,<span class="comment">//打开目录，&quot;.&quot; 表示当前目录</span></span><br><span class="line">                <span class="string">&quot;C++ files(*.cpp);;&quot;</span></span><br><span class="line">                 <span class="string">&quot;C files(*.c);;&quot;</span></span><br><span class="line">                <span class="string">&quot;Header files(*.h)&quot;</span><span class="comment">//设置文件过滤器，有多个条件时中间以两个;;隔开</span></span><br><span class="line">                );</span><br><span class="line">    m_fileEdit-&gt;<span class="built_in">setText</span>(sPath);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="QColorDialog颜色对话框"><a href="#QColorDialog颜色对话框" class="headerlink" title="QColorDialog颜色对话框"></a>QColorDialog颜色对话框</h2><p>颜色对话框可以通过调用QColorDialog::getColor方法实现，方法的第一个参数表示默认选择的颜色。该方法会返回一个颜色类。</p>
<p><img src="/2021/06/27/Qt/5d553be71dac4627ab1ac8237839404c.png" alt="img"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Dialog::ShowColorDlg</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QColor color = QColorDialog::<span class="built_in">getColor</span>(</span><br><span class="line">                Qt::yellow<span class="comment">//默认选择的颜色</span></span><br><span class="line">                );</span><br><span class="line">    <span class="comment">//判断颜色选择是否合法</span></span><br><span class="line">    <span class="keyword">if</span>(color.<span class="built_in">isValid</span>())&#123;</span><br><span class="line">        <span class="comment">//设置边宽颜色</span></span><br><span class="line">        m_colorFrame-&gt;<span class="built_in">setPalette</span>(<span class="built_in">QPalette</span>(color));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="QFontDialog字体对话框"><a href="#QFontDialog字体对话框" class="headerlink" title="QFontDialog字体对话框"></a>QFontDialog字体对话框</h2><p>字体对话框可以通过调用QFontDialog::getFont方法实现，该方法需要传入一个<strong>bool类型的参数</strong>用来接收函数是否成功执行，方法会返回一个字体字体类。</p>
<p><img src="/2021/06/27/Qt/4dffdf93ee3f46c99a7562dce3d6591e.gif" alt="img"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//字体对话框</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Dialog::ShowFontDlg</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> ok;<span class="comment">//接收函数是否执行成功</span></span><br><span class="line">    QFont font = QFontDialog::<span class="built_in">getFont</span>(</span><br><span class="line">                    &amp;ok<span class="comment">//接收函数是否执行成功</span></span><br><span class="line">                );</span><br><span class="line">    <span class="keyword">if</span>(ok)&#123;</span><br><span class="line">        <span class="comment">//设置字体</span></span><br><span class="line">        m_fontEdit-&gt;<span class="built_in">setFont</span>(font);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="QInputDialog输入对话框"><a href="#QInputDialog输入对话框" class="headerlink" title="QInputDialog输入对话框"></a>QInputDialog输入对话框</h2><p><img src="/2021/06/27/Qt/f8aa363b765540f9a88b4ff3fd49b873.gif" alt="img"></p>
<p>设置姓名，可以调用的是QInputDialog::getText( )方法用来获取输入的单行文本。方法的第一个参数指定父窗体，第二个参数指定对话框的标题，第三个参数指定对话框显示的内容，第四个参数纸档输入框的模式，第五个参数指定默认值，第六个参数是一个bool类型用来接收函数是否执行成功。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//文本输入对话框</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InputDlg::editName</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> ok;</span><br><span class="line">    QString strName = QInputDialog::<span class="built_in">getText</span>(</span><br><span class="line">                <span class="keyword">this</span>,<span class="comment">//指定父窗体</span></span><br><span class="line">                <span class="string">&quot;标准文本输入对话框&quot;</span>,<span class="comment">//指定对话框标题</span></span><br><span class="line">                <span class="string">&quot;请编辑姓名&quot;</span>,<span class="comment">//提示字符串</span></span><br><span class="line">                QLineEdit::Normal,<span class="comment">//输入框显示模式</span></span><br><span class="line">                m_nameLabel-&gt;<span class="built_in">text</span>(),<span class="comment">//输入框的默认文本</span></span><br><span class="line">                &amp;ok<span class="comment">//接收函数调用是否成功</span></span><br><span class="line">                <span class="comment">//最后一个参数表示窗体风格，这里采用默认的</span></span><br><span class="line">                );</span><br><span class="line">    <span class="keyword">if</span>(ok &amp;&amp; !strName.<span class="built_in">isEmpty</span>())&#123;</span><br><span class="line">        m_nameLabel-&gt;<span class="built_in">setText</span>(strName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>设置性别，可以调用的是QInputDialog::getItem( ) 方法用来获取用户从下拉列表选择的值。QInputDialog第三个参数用来设置下拉列表框，要传入一个QStringList类型的值。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//条目输入对话框</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InputDlg::editSex</span><span class="params">()</span></span>&#123;</span><br><span class="line">    QStringList sexList;</span><br><span class="line">    <span class="keyword">bool</span> ok;</span><br><span class="line">    sexList&lt;&lt;<span class="string">&quot;男&quot;</span>&lt;&lt;<span class="string">&quot;女&quot;</span>&lt;&lt;<span class="string">&quot;未知&quot;</span>;</span><br><span class="line">    <span class="comment">//可选项是QString 类型，接收也是QString</span></span><br><span class="line">    QString strSex = QInputDialog::<span class="built_in">getItem</span>(</span><br><span class="line">                <span class="keyword">this</span>,</span><br><span class="line">                <span class="string">&quot;标准条目输入对话框&quot;</span>,<span class="comment">//指定对话框标题</span></span><br><span class="line">                <span class="string">&quot;请选择性别&quot;</span>,    <span class="comment">//指定显示内容</span></span><br><span class="line">                sexList,<span class="comment">//设置可选项，可选项是一个QStringList类型</span></span><br><span class="line">                <span class="number">0</span>,<span class="comment">//设置默认选选项</span></span><br><span class="line">                <span class="literal">false</span>,<span class="comment">//是否可编辑</span></span><br><span class="line">                &amp;ok<span class="comment">//接收函数是否调用成功</span></span><br><span class="line">                );</span><br><span class="line">    <span class="keyword">if</span>(ok &amp;&amp; !strSex.<span class="built_in">isEmpty</span>())&#123;</span><br><span class="line">        m_sexLabel-&gt;<span class="built_in">setText</span>(strSex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>设置年龄，可以调用QInputDialog::getInt方法用来获取用户填入的整数值。getInt方法的第四个参数和第五个参数分别用来设置整数的最小值和最大值，第六个参数用来设置步长，即点击增加按钮时每次增加的值。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InputDlg::editAge</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> ok;</span><br><span class="line">    <span class="keyword">int</span> age = QInputDialog::<span class="built_in">getInt</span>(</span><br><span class="line">                <span class="keyword">this</span>,</span><br><span class="line">                <span class="string">&quot;标注int数据类型输入对话框&quot;</span>,<span class="comment">//对话框标题</span></span><br><span class="line">                <span class="string">&quot;请编辑年龄&quot;</span>,<span class="comment">//对话框显示的内容</span></span><br><span class="line">                m_ageLabel-&gt;<span class="built_in">text</span>().<span class="built_in">toInt</span>(),<span class="comment">//默认值</span></span><br><span class="line">                <span class="number">0</span>,<span class="comment">//最小值</span></span><br><span class="line">                <span class="number">120</span>,<span class="comment">//最大值</span></span><br><span class="line">                <span class="number">1</span>,<span class="comment">//步长</span></span><br><span class="line">                &amp;ok<span class="comment">//接收函数是否调用成功</span></span><br><span class="line">                );</span><br><span class="line">    <span class="keyword">if</span>(ok)&#123;</span><br><span class="line">        m_ageLabel-&gt;<span class="built_in">setText</span>(<span class="built_in">QString</span>(<span class="string">&quot;%1&quot;</span>).<span class="built_in">arg</span>(age));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>设置分数，可以调用QInputDialog::getDouble方法用来获取用户填入的浮点数值。getDouble方法的第四个参数和第五个参数分别用来设置整数的最小值和最大值，第六个参数用来设置精度，即点数据的小数位。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InputDlg::editScore</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> ok;</span><br><span class="line">    <span class="keyword">double</span> score = QInputDialog::<span class="built_in">getDouble</span>(</span><br><span class="line">                <span class="keyword">this</span>,<span class="comment">//设置父窗体</span></span><br><span class="line">                <span class="string">&quot;标准double数据类型输入对话框&quot;</span>,<span class="comment">//对话框标题</span></span><br><span class="line">                <span class="string">&quot;请编辑分数&quot;</span>,<span class="comment">//对话框显示的内容</span></span><br><span class="line">                m_scoreLabel-&gt;<span class="built_in">text</span>().<span class="built_in">toDouble</span>(),<span class="comment">//默认值</span></span><br><span class="line">                <span class="number">0</span>,<span class="comment">//最小值</span></span><br><span class="line">                <span class="number">100</span>,<span class="comment">//最大值</span></span><br><span class="line">                <span class="number">1</span>,<span class="comment">//精度</span></span><br><span class="line">                &amp;ok<span class="comment">//接收函数是否执行成功</span></span><br><span class="line">                );</span><br><span class="line">    <span class="keyword">if</span>(ok)&#123;</span><br><span class="line">        m_scoreLabel-&gt;<span class="built_in">setText</span>(QString::<span class="built_in">number</span>(score));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>QMessageBox消息框</p>
<p><img src="/2021/06/27/Qt/3f49502b96e94515ad5abf64e8bc945e.gif" alt="img"></p>
<p>问题消息框，可以调用QMessageBox::question() 显示问题消息框，问题消息框可设置要显示的按钮，方法会返回一个枚举类型表示用户所点击的按钮。这里设置的是“确定”和“取消”按钮。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MsgBoxDlg::showQuestionMsgDlg</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    m_tipLabel-&gt;<span class="built_in">setText</span>(<span class="string">&quot;问题消息框&quot;</span>);</span><br><span class="line">    <span class="keyword">int</span> res = QMessageBox::<span class="built_in">question</span>(</span><br><span class="line">                <span class="keyword">this</span>,<span class="comment">//指定父窗体</span></span><br><span class="line">                <span class="string">&quot;问题消息框&quot;</span>,<span class="comment">//指定标题</span></span><br><span class="line">                <span class="string">&quot;已打开问题消息框，是否关闭？&quot;</span>,<span class="comment">//显示的文本</span></span><br><span class="line">                QMessageBox::Ok|QMessageBox::Cancel,<span class="comment">//标注按钮</span></span><br><span class="line">                QMessageBox::Ok<span class="comment">//默认选择的按钮</span></span><br><span class="line">                );</span><br><span class="line">    <span class="built_in"><span class="keyword">switch</span></span> (res) &#123;</span><br><span class="line">    <span class="keyword">case</span> QMessageBox::Ok:</span><br><span class="line">        m_tipLabel-&gt;<span class="built_in">setText</span>(<span class="string">&quot;问题消息框 - 确定&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> QMessageBox::Cancel:</span><br><span class="line">        m_tipLabel-&gt;<span class="built_in">setText</span>(<span class="string">&quot;问题消息框 - 取消&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>信息消息框，可以调用QMessageBox::information( )方法实现，信息消息框的作用是给用户展示一段消息，无需用户做出操作，函数参数也比较简单。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MsgBoxDlg::showInformationMsgDlg</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    m_tipLabel-&gt;<span class="built_in">setText</span>(<span class="string">&quot;信息消息框&quot;</span>);</span><br><span class="line">    QMessageBox::<span class="built_in">information</span>(</span><br><span class="line">                <span class="keyword">this</span>,<span class="comment">//父窗体</span></span><br><span class="line">                <span class="string">&quot;信息提示框&quot;</span>,<span class="comment">//标题</span></span><br><span class="line">                <span class="string">&quot;这是个信息提示框&quot;</span><span class="comment">//文本内容</span></span><br><span class="line">                );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>警告消息框，可以调用QMessageBox::waring方法，警告消息框同样可以设置消息框的按钮，方法会一个枚举类型表示用户的操作。这里设置的是“保存”、“忽视”和“取消”按钮。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MsgBoxDlg::showWarningMsgDlg</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    m_tipLabel-&gt;<span class="built_in">setText</span>(<span class="string">&quot;警告消息框&quot;</span>);</span><br><span class="line">    <span class="keyword">int</span> res = QMessageBox::<span class="built_in">warning</span>(</span><br><span class="line">                <span class="keyword">this</span>,<span class="comment">//父窗体</span></span><br><span class="line">                <span class="string">&quot;警告消息框&quot;</span>,<span class="comment">//标题</span></span><br><span class="line">                <span class="string">&quot;有为保存的文件&quot;</span>,<span class="comment">//警告内容</span></span><br><span class="line">                QMessageBox::Save|QMessageBox::Discard|QMessageBox::Cancel,</span><br><span class="line">                QMessageBox::Save<span class="comment">//默认选择的按钮</span></span><br><span class="line">                );</span><br><span class="line">    <span class="built_in"><span class="keyword">switch</span></span> (res) &#123;</span><br><span class="line">    <span class="keyword">case</span> QMessageBox::Save:</span><br><span class="line">        m_tipLabel-&gt;<span class="built_in">setText</span>(<span class="string">&quot;警告提示框 - 保存&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> QMessageBox::Discard:</span><br><span class="line">        m_tipLabel-&gt;<span class="built_in">setText</span>(<span class="string">&quot;警告提示框 - 忽视&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> QMessageBox::Cancel:</span><br><span class="line">        m_tipLabel-&gt;<span class="built_in">setText</span>(<span class="string">&quot;警告提示框 - 取消&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>错误消息框，可以调用QMessageBox::critical方法，错误消息框也相当于一种消息提醒，会比信息消息框的效果显目，调用方法和信息消息框类似。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MsgBoxDlg::showCriticalMsgDlg</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    m_tipLabel-&gt;<span class="built_in">setText</span>(<span class="string">&quot;错误消息框&quot;</span>);</span><br><span class="line">    QMessageBox::<span class="built_in">critical</span>(</span><br><span class="line">                <span class="keyword">this</span>,<span class="comment">//父窗体</span></span><br><span class="line">                <span class="string">&quot;错误消息框&quot;</span>,<span class="comment">//标题</span></span><br><span class="line">                <span class="string">&quot;发生重大错误！！&quot;</span><span class="comment">//显示内容</span></span><br><span class="line">                );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>关于消息框，调用QMessageBox::about方法，关于消息框也是一种消息提醒，调用方法与信息消息框类似。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MsgBoxDlg::showAboutMsgDlg</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    m_tipLabel-&gt;<span class="built_in">setText</span>(<span class="string">&quot;关于消息框&quot;</span>);</span><br><span class="line">    QMessageBox::<span class="built_in">about</span>(</span><br><span class="line">                <span class="keyword">this</span>,<span class="comment">//父窗体</span></span><br><span class="line">                <span class="string">&quot;关于消息框&quot;</span>,<span class="comment">//标题</span></span><br><span class="line">                <span class="string">&quot;这是个关于休斯顿的信息&quot;</span><span class="comment">//显示内容</span></span><br><span class="line">                );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>关于QT消息框，调用QMessageBox::aboutQt方法，关于QT消息框会弹出一个有关QT的信息。其他功能暂无。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MsgBoxDlg::showAboutQtMsgDlg</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    m_tipLabel-&gt;<span class="built_in">setText</span>(<span class="string">&quot;关于QT消息框&quot;</span>);</span><br><span class="line">    QMessageBox::<span class="built_in">aboutQt</span>(</span><br><span class="line">                <span class="keyword">this</span>,<span class="comment">//父窗体</span></span><br><span class="line">                <span class="string">&quot;关于QT消息框&quot;</span><span class="comment">//标题</span></span><br><span class="line">                );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="QMessageBox消息框"><a href="#QMessageBox消息框" class="headerlink" title="QMessageBox消息框"></a>QMessageBox消息框</h2><p>Qt 提供了 6 种通用的 QMessageBox 消息对话框，通过调用 QMessageBox 类中的 6 个静态成员方法，可以直接在项目中使用它们。</p>
<ol>
<li>information消息对话框<br>information 对话框常用于给用户提示一些关键的信息，它的外观如下图所示：</li>
</ol>
<p><img src="/2021/06/27/Qt/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Jab5a6a6LCU55qE54yrNzA4MQ==,size_7,color_FFFFFF,t_70,g_se,x_16.png" alt="img"></p>
<p>在项目中使用 information 消息对话框，直接调用 QMessageBox 类中的 information() 静态成员方法即可，该方法的语法格式如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">StandardButton <span class="title">QMessageBox::information</span><span class="params">(QWidget *parent,</span></span></span><br><span class="line"><span class="params"><span class="function">                                        <span class="keyword">const</span> QString &amp;title,</span></span></span><br><span class="line"><span class="params"><span class="function">                                        <span class="keyword">const</span> QString &amp;text,</span></span></span><br><span class="line"><span class="params"><span class="function">                                        StandardButtons buttons = Ok,</span></span></span><br><span class="line"><span class="params"><span class="function">                                        StandardButton defaultButton = NoButton)</span></span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/06/27/Qt/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Jab5a6a6LCU55qE54yrNzA4MQ==,size_20,color_FFFFFF,t_70,g_se,x_16.png" alt="img"></p>
<p>例如，使用 information() 函数实现图 2 所示的对话框，实现代码为：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QMessageBox::StandardButton result = QMessageBox::<span class="built_in">information</span>(&amp;widget, <span class="string">&quot;Title&quot;</span>,<span class="string">&quot;text&quot;</span>);</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>critical消息对话框<br>critical 消息对话框常用于给用户提示“操作错误”或“运行失败”的信息，它的外观如下图所示：</li>
</ol>
<p><img src="/2021/06/27/Qt/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Jab5a6a6LCU55qE54yrNzA4MQ==,size_6,color_FFFFFF,t_70,g_se,x_16.png" alt="img"></p>
<p>项目中使用 critical 消息对话框，直接调用 QMessageBox 类提供的 critical() 静态成员方法即可，该方法的语法格式为：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">StandardButton <span class="title">QMessageBox::critical</span><span class="params">(QWidget *parent,</span></span></span><br><span class="line"><span class="params"><span class="function">                                     <span class="keyword">const</span> QString &amp;title,</span></span></span><br><span class="line"><span class="params"><span class="function">                                     <span class="keyword">const</span> QString &amp;text,</span></span></span><br><span class="line"><span class="params"><span class="function">                                     StandardButtons buttons = Ok,</span></span></span><br><span class="line"><span class="params"><span class="function">                                     StandardButton defaultButton = NoButton)</span></span></span><br></pre></td></tr></table></figure>

<p> 例如，使用 critical() 函数实现图 3 所示的对话框，实现代码为：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QMessageBox::StandardButton result=QMessageBox::<span class="built_in">critical</span>(&amp;widget, <span class="string">&quot;Title&quot;</span>,<span class="string">&quot;text&quot;</span>);</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>question消息对话框<br>question 对话框常用于向用户提出问题并接收用户的答案，它的外观如下图所示：</li>
</ol>
<p><img src="/2021/06/27/Qt/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Jab5a6a6LCU55qE54yrNzA4MQ==,size_9,color_FFFFFF,t_70,g_se,x_16.png" alt="img"></p>
<p>项目中使用 question 对话框，可以直接调用 QMessageBox 类的 question() 静态成员方法，该方法的语法格式为：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">StandardButton <span class="title">QMessageBox::question</span><span class="params">(QWidget *parent,</span></span></span><br><span class="line"><span class="params"><span class="function">                                     <span class="keyword">const</span> QString &amp;title,</span></span></span><br><span class="line"><span class="params"><span class="function">                                     <span class="keyword">const</span> QString &amp;text,</span></span></span><br><span class="line"><span class="params"><span class="function">                                     StandardButtons buttons = StandardButtons( Yes | No ),</span></span></span><br><span class="line"><span class="params"><span class="function">                                     StandardButton defaultButton = NoButton)</span></span></span><br></pre></td></tr></table></figure>

<p> 例如，使用 question() 函数实现图 4 所示的对话框，实现代码为：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QMessageBox::StandardButton result=QMessageBox::<span class="built_in">question</span>(&amp;widget, <span class="string">&quot;Title&quot;</span>,<span class="string">&quot;text&quot;</span>);</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>warning消息对话框<br>warining 对话框常用于向用户显示一些警告信息，它的外观如下图所示：</li>
</ol>
<p><img src="/2021/06/27/Qt/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6Jab5a6a6LCU55qE54yrNzA4MQ==,size_5,color_FFFFFF,t_70,g_se,x_16.png" alt="img"></p>
<p> 项目中使用 warning 对话框，可以直接调用 QMessageBox 类的 warning() 静态成员方法，该方法的语法格式为：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">StandardButton <span class="title">QMessageBox::warning</span><span class="params">(QWidget *parent,</span></span></span><br><span class="line"><span class="params"><span class="function">                                    <span class="keyword">const</span> QString &amp;title,</span></span></span><br><span class="line"><span class="params"><span class="function">                                    <span class="keyword">const</span> QString &amp;text,</span></span></span><br><span class="line"><span class="params"><span class="function">                                    StandardButtons buttons = Ok,</span></span></span><br><span class="line"><span class="params"><span class="function">                                    StandardButton defaultButton = NoButton)</span></span></span><br></pre></td></tr></table></figure>

<p>例如，使用 warning() 函数实现图 5 所示的对话框，实现代码为：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QMessageBox::StandardButton result=QMessageBox::<span class="built_in">warning</span>(&amp;widget, <span class="string">&quot;Title&quot;</span>,<span class="string">&quot;text&quot;</span>);</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>about和aboutQt对话框<br>about 对话框常常作为介绍某个产品或某项功能的临时窗口，它的外观如下图所示：</li>
</ol>
<p><img src="/2021/06/27/Qt/9374a12d25774ef3ae9726f03b79bafe.png" alt="img"></p>
<p>项目中使用 about 对话框，直接调用 QMessageBox 类提供的 about() 静态成员方法即可，该方法的语法格式如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">QMessageBox::about</span><span class="params">(QWidget *parent, <span class="keyword">const</span> QString &amp;title, <span class="keyword">const</span> QString &amp;text)</span></span></span><br></pre></td></tr></table></figure>

<p>项目中使用 aboutQt 对话框，直接调用 QMessageBox 类提供的 aboutQt() 静态成员方法即可，该函数的语法格式如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">QMessageBox::aboutQt</span><span class="params">(QWidget *parent, <span class="keyword">const</span> QString &amp;title = QString())</span></span></span><br></pre></td></tr></table></figure>



<h2 id="自定义消息框"><a href="#自定义消息框" class="headerlink" title="自定义消息框"></a>自定义消息框</h2><p>自定义消息框设置了一个图标和三个按钮，其中两个按钮采用自定义形式，另一个按钮采用标准形式，当用户点击按钮后，从对话框中获取用户点击的按钮，然后显示出对应的文本。</p>
<p><img src="/2021/06/27/Qt/8531033c2a3d4bfb8dde95317c1ed0cf.gif" alt="img"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//自定义消息框</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Dialog::ShowCustomDlg</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    m_customLabel-&gt;<span class="built_in">setText</span>(<span class="string">&quot;自定义消息框&quot;</span>);</span><br><span class="line">    QMessageBox customMsgBox;</span><br><span class="line">    customMsgBox.<span class="built_in">setWindowTitle</span>(<span class="string">&quot;自定义消息框&quot;</span>);</span><br><span class="line">    <span class="comment">//返回一个按钮对象</span></span><br><span class="line">    <span class="comment">//自定义按钮</span></span><br><span class="line">    QPushButton *yes = customMsgBox.<span class="built_in">addButton</span>(</span><br><span class="line">                <span class="string">&quot;真的吗？&quot;</span>,<span class="comment">//指定文本</span></span><br><span class="line">                QMessageBox::ActionRole<span class="comment">//指定角色</span></span><br><span class="line">                );</span><br><span class="line">    <span class="comment">//自定义按钮</span></span><br><span class="line">    QPushButton *no = customMsgBox.<span class="built_in">addButton</span>(</span><br><span class="line">                <span class="string">&quot;假的&quot;</span>,<span class="comment">//指定文本</span></span><br><span class="line">                QMessageBox::ActionRole<span class="comment">//指定角色</span></span><br><span class="line">                );</span><br><span class="line">    <span class="comment">//标准按钮</span></span><br><span class="line">    QPushButton *cancel = customMsgBox.<span class="built_in">addButton</span>(</span><br><span class="line">                QMessageBox::Cancel);</span><br><span class="line">    <span class="comment">//设置图标</span></span><br><span class="line">    customMsgBox.<span class="built_in">setIconPixmap</span>(<span class="built_in">QPixmap</span>(<span class="string">&quot;msg.jpg&quot;</span>));</span><br><span class="line">    customMsgBox.<span class="built_in">exec</span>();</span><br><span class="line">    <span class="keyword">if</span>(customMsgBox.<span class="built_in">clickedButton</span>()==yes)&#123;</span><br><span class="line">        m_customLabel-&gt;<span class="built_in">setText</span>(<span class="string">&quot;点了“真的吗？”&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(customMsgBox.<span class="built_in">clickedButton</span>()==no)&#123;</span><br><span class="line">        m_customLabel-&gt;<span class="built_in">setText</span>(<span class="string">&quot;点了“假的   ”&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(customMsgBox.<span class="built_in">clickedButton</span>()==cancel)&#123;</span><br><span class="line">        m_customLabel-&gt;<span class="built_in">setText</span>(<span class="string">&quot;点了“取消”&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="重写QLabel，提升UI部件，调用PaintEvent"><a href="#重写QLabel，提升UI部件，调用PaintEvent" class="headerlink" title="重写QLabel，提升UI部件，调用PaintEvent"></a>重写QLabel，提升UI部件，调用PaintEvent</h1><p>.h</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> MYQLABEL_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MYQLABEL_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QLabel&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyQLabel</span> :</span> <span class="keyword">public</span> QLabel</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">MyQLabel</span>(QWidget  *parent=<span class="number">0</span>);</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">paintEvent</span><span class="params">(QPaintEvent *event)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">mousePressEvent</span><span class="params">(QMouseEvent *e)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">mouseMoveEvent</span><span class="params">(QMouseEvent *event)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">mouseReleaseEvent</span><span class="params">(QMouseEvent *event)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">wheelEvent</span><span class="params">(QWheelEvent *event)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// MYQLABEL_H</span></span></span><br></pre></td></tr></table></figure>

<p>.cpp</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;MyQLabel.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QPainter&gt;</span></span></span><br><span class="line">MyQLabel::<span class="built_in">MyQLabel</span>(QWidget  *parent):</span><br><span class="line">       <span class="built_in">QLabel</span>(parent)<span class="comment">//注意这里，不能写QWidget，否则ui.h文件会报错</span></span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MyQLabel::paintEvent</span><span class="params">(QPaintEvent *event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QImage img;</span><br><span class="line">    img.<span class="built_in">load</span>(<span class="string">&quot;E:\\Projects\\SpxFrame\\radarFrame\\asdfa.jpg&quot;</span>);</span><br><span class="line">    <span class="keyword">static</span> QPainter painter;</span><br><span class="line">    painter.<span class="built_in">begin</span>(<span class="keyword">this</span>);</span><br><span class="line">    painter.<span class="built_in">drawImage</span>(<span class="built_in">QRectF</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="keyword">this</span>-&gt;<span class="built_in">width</span>(),<span class="keyword">this</span>-&gt;<span class="built_in">height</span>()),img);</span><br><span class="line">    painter.<span class="built_in">end</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MyQLabel::mousePressEvent</span><span class="params">(QMouseEvent *e)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;<span class="built_in">setCursor</span>(Qt::ClosedHandCursor);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MyQLabel::mouseMoveEvent</span><span class="params">(QMouseEvent *event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MyQLabel::wheelEvent</span><span class="params">(QWheelEvent *event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ui文件</p>
<p><img src="/2021/06/27/Qt/041e2433-0fe9-4b23-b224-9e29be08f00c.png" alt="img"></p>
<p>然后在使用这个部件的类里面就可以通过ui.MyQLabel这样的方式访问重写的类中的函数和变量了，比如传递图片进去调用PaintEvent等等，这样在PaintEvent中就可以在this画布上直接draw，不用在外部set静态的图片了。</p>
<h1 id="QThread"><a href="#QThread" class="headerlink" title="QThread"></a>QThread</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">QThread *thread = <span class="keyword">new</span> <span class="built_in">QThread</span>( );</span><br><span class="line"> Task    *task   = <span class="keyword">new</span> <span class="built_in">Task</span>();</span><br><span class="line"> task-&gt;<span class="built_in">moveToThread</span>(thread);</span><br><span class="line"> <span class="built_in">connect</span>( thread, <span class="built_in">SIGNAL</span>(<span class="built_in">started</span>()), task, <span class="built_in">SLOT</span>(<span class="built_in">doWork</span>()) );</span><br><span class="line"> <span class="built_in">connect</span>( task, <span class="built_in">SIGNAL</span>(<span class="built_in">workFinished</span>()), thread, <span class="built_in">SLOT</span>(<span class="built_in">quit</span>()) );<span class="comment">//从Qt4.4开始，qthreads-no-longer-abstract，run 默认调用 QThread::exec(),即启动消息队列</span></span><br><span class="line"> <span class="comment">//automatically delete thread and task object when work is done:</span></span><br><span class="line"> <span class="built_in">connect</span>( thread, <span class="built_in">SIGNAL</span>(<span class="built_in">finished</span>()), task, <span class="built_in">SLOT</span>(<span class="built_in">deleteLater</span>()) );</span><br><span class="line"> <span class="built_in">connect</span>( thread, <span class="built_in">SIGNAL</span>(<span class="built_in">finished</span>()), thread, <span class="built_in">SLOT</span>(<span class="built_in">deleteLater</span>()) );</span><br><span class="line"> thread-&gt;<span class="built_in">start</span>();</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span> :</span> <span class="keyword">public</span> QObject</span><br><span class="line"> &#123;</span><br><span class="line"> Q_OBJECT</span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">      <span class="built_in">Task</span>();</span><br><span class="line">      ~<span class="built_in">Task</span>();</span><br><span class="line">  <span class="keyword">public</span> slots:</span><br><span class="line">      <span class="function"><span class="keyword">void</span> <span class="title">doWork</span><span class="params">()</span></span>;</span><br><span class="line">  signals:</span><br><span class="line">     <span class="function"><span class="keyword">void</span> <span class="title">workFinished</span><span class="params">()</span></span>;</span><br><span class="line"> &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A *a = <span class="keyword">new</span> A;</span><br><span class="line">QThread *t = <span class="keyword">new</span> QThread;</span><br><span class="line">a-&gt;<span class="built_in">moveToThread</span>(t);</span><br><span class="line"><span class="built_in">connect</span>(t, <span class="built_in">SIGNAL</span>(<span class="built_in">started</span>()), a, <span class="built_in">SLOT</span>(<span class="built_in">start</span>()));</span><br><span class="line"><span class="built_in">connect</span>(a, <span class="built_in">SIGNAL</span>(<span class="built_in">finish</span>()), a, <span class="built_in">SLOT</span>(<span class="built_in">deleteLater</span>()));</span><br><span class="line"><span class="built_in">connect</span>(a, <span class="built_in">SIGNAL</span>(<span class="built_in">destroyed</span>()), t, <span class="built_in">SLOT</span>(<span class="built_in">quit</span>()));</span><br><span class="line"><span class="built_in">connect</span>(t, <span class="built_in">SIGNAL</span>(<span class="built_in">finished</span>()), t, <span class="built_in">SLOT</span>(<span class="built_in">deleteLater</span>()));</span><br><span class="line">a在销毁后是会发出<span class="built_in">destroyed</span>()信号的，a完成后可以先让a销毁，然后a发出销毁的信号后t再退出，t退出完毕后销毁。这样就可以了。</span><br></pre></td></tr></table></figure>

<h1 id="QCoreApplication和QApplication的区别"><a href="#QCoreApplication和QApplication的区别" class="headerlink" title="QCoreApplication和QApplication的区别"></a>QCoreApplication和QApplication的区别</h1><p>\1. QCoreApplication用于non-GUI的应用程序（不需要依赖QtGui库），QApplication用于包含GUI的应用程序（需要用到QtGui库）。</p>
<p>\2. QApplication继承了QGuiApplication类，而QGuiApplication继承了QCoreApplication类，而QCoreApplication又继承QObject的，而QObject就是QT中最基本的基类，也就是QT的根基。</p>
<h1 id="pro文件相关"><a href="#pro文件相关" class="headerlink" title="pro文件相关"></a>pro文件相关</h1><p><strong>Qt</strong>程序一般使用Qt提供的<strong>qmake</strong>工具来编译。</p>
<p>qmake工具可以使用与平台无关的.pro文件生成与平台相关的<strong>makefile</strong>。该工具包含了调用Qt内置代码生成工具（<strong>moc</strong>，<strong>uic</strong>，<strong>rcc</strong>）的必要逻辑规则。</p>
<p>可以在命令行下，输入<strong>qmake -project</strong>来生成平台无关的pro文件。</p>
<p>工程文件pro主要分为三种：app（单独的应用程序），lib（静态和动态库），subdirs（递归编译）。工程类型可以使用<strong>TEMPLATE</strong>变量来指定。</p>
<p>如： TEMPLATE = app(默认不指定的情况下是app工程)</p>
<p>对于app工程或者lib工程，有以下这些经常使用的变量：</p>
<p><strong>HEADERS</strong>：指定C++头文件</p>
<p><strong>SOURCES</strong>：指定C++实现文件</p>
<p><strong>FORMS</strong>：指定需要uic处理的ui文件</p>
<p><strong>RESOURCES</strong>：指定需要rcc处理的qrc文件</p>
<p><strong>DEFINES</strong>：指定预定义预处理器符号</p>
<p><strong>INCLUDEPATH</strong>：指定C++编译器搜索头文件路径</p>
<p><strong>LIBS</strong>：指定工程要链接的库</p>
<p><strong>CONFIG</strong>：指定工程配置和编译参数</p>
<p><strong>QT</strong>：指定工程所要使用的Qt模块</p>
<p><strong>VERSION</strong>：指定目标库版本号</p>
<p><strong>TARGET</strong>：指定可执行文件或库的基本文件名，默认为当前目录名</p>
<p><strong>DESTDIR</strong>：指定可执行文件放置的目录</p>
<p><strong>DLLDESTDIR</strong>：指定目标库文件放置的目录</p>
<p>模板变量<strong>TEMPLATE</strong>规定qmake为应用程序生成哪种makefile。下面是可供使用的选择：</p>
<table>
<thead>
<tr>
<th>TEMPLATE的宏</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>app</td>
<td>应用程序</td>
</tr>
<tr>
<td>lib</td>
<td>库dll</td>
</tr>
<tr>
<td>subdirs</td>
<td>子项目</td>
</tr>
<tr>
<td>vcapp</td>
<td>应用的visual studio项目</td>
</tr>
<tr>
<td>vclib</td>
<td>库的visual studio项目</td>
</tr>
<tr>
<td>aux</td>
<td>创建一个 Makefile 但不进行构建。</td>
</tr>
</tbody></table>
<p><strong>CONFIG</strong>：指定工程配置和编译参数</p>
<p>CONFIG配置工程和编译器的设置，以下取值定义了所要连编的库/应用程序的类型：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>release</td>
<td>配置项目为发布模式。如果同时指定了 debug，则最后的配置项生效。</td>
</tr>
<tr>
<td>debug</td>
<td>配置项目为调试模式。</td>
</tr>
<tr>
<td>debug_and_release</td>
<td>配置项目为调试和发布模式。同时创建调试和发布项目。</td>
</tr>
<tr>
<td>debug_and_release_target</td>
<td>此项为默认设置。如果配置了 debug_and_release，调试和发布项目将在属于自己的文件目录生成。</td>
</tr>
<tr>
<td>build_all</td>
<td>如果配置了 debug_and_release，将默认生成调试和发布项目。</td>
</tr>
<tr>
<td>autogen_precompile_source</td>
<td>自动生成包含在 .pro 文件中指定的预编译头文件和</td>
</tr>
<tr>
<td>ordered</td>
<td>当模板指定为 subdirs 时，此配置项会根据 .pro 文件的顺序进行编译处理。注意：不鼓励使用此项。应按照 SUBDIRS  说明文档中的变量指定依赖项。</td>
</tr>
<tr>
<td>precompile_header</td>
<td>增加预编译头文件支持。</td>
</tr>
<tr>
<td>precompile_header_c (MSVC only)</td>
<td>增加对 C 文件的预编译头文件支持。</td>
</tr>
<tr>
<td>warn_on</td>
<td>编译器尽可能多的输出警告信息。如果同时配置了 warn_off，则最后的配置项生效。</td>
</tr>
<tr>
<td>warn_off</td>
<td>编译器尽可能少的输出警告信息。</td>
</tr>
<tr>
<td>exceptions</td>
<td>启用异常支持配置。默认设置。</td>
</tr>
<tr>
<td>exceptions_off</td>
<td>停用异常支持配置。</td>
</tr>
<tr>
<td>ltcg</td>
<td>启用链接时进行代码生成配置。默认关闭。</td>
</tr>
<tr>
<td>rtti</td>
<td>启用 RTTI 支持配置。默认情况使用编译器默认值。</td>
</tr>
<tr>
<td>rtti_off</td>
<td>停用 RTTI 支持配置。默认情况使用编译器默认值。</td>
</tr>
<tr>
<td>stl</td>
<td>启用 STL 支持配置。默认情况使用编译器默认值。</td>
</tr>
<tr>
<td>stl_off</td>
<td>停用 STL 支持配置。默认情况使用编译器默认值。</td>
</tr>
<tr>
<td>thread</td>
<td>启用线程支持配置。当 CONFIG 配置项中包含 qt 时默认启用。</td>
</tr>
<tr>
<td>utf8_source</td>
<td>明确项目源文件使用 UTF-8 进行编码。默认情况使用编译器默认值。</td>
</tr>
<tr>
<td>hide_symbols</td>
<td>将二进制文件中符号的默认可见性设置为隐藏。默认情况使用编译器默认值。</td>
</tr>
<tr>
<td>c99</td>
<td>启用 C99 编译支持。如果编译器不支持 C99 或无法选择 C 标准，则此选项无效。默认情况使用编译器默认值。</td>
</tr>
<tr>
<td>c11</td>
<td>启用 C11 编译支持。如果编译器不支持 C11 或无法选择 C 标准，则此选项无效。默认情况使用编译器默认值。</td>
</tr>
<tr>
<td>strict_c</td>
<td>停用对 C 编译器扩展支持。默认情况扩展支持处于启用状态。</td>
</tr>
<tr>
<td>c++11</td>
<td>启用 C++11 编译支持。如果编译器不支持 C++11 或无法选择 C++ 标准，则此选项无效。默认情况使用编译器默认值。</td>
</tr>
<tr>
<td>c++14</td>
<td>启用 C++14 编译支持。如果编译器不支持 C++14 或无法选择 C++ 标准，则此选项无效。默认情况使用编译器默认值。</td>
</tr>
<tr>
<td>c++1z</td>
<td>启用 C++17 编译支持。如果编译器不支持 C++17 或无法选择 C++ 标准，则此选项无效。默认情况使用编译器默认值。</td>
</tr>
<tr>
<td>c++17</td>
<td>与 c++1z 相同。</td>
</tr>
<tr>
<td>c++2a</td>
<td>启用 C++2a 编译支持。如果编译器不支持 C++2a 或无法选择 C++ 标准，则此选项无效。默认情况使用编译器默认值。</td>
</tr>
<tr>
<td>c++latest</td>
<td>启用编译器对最新的 C++ 语言标准的支持。默认情况下，此选项处于停用状态。</td>
</tr>
<tr>
<td>strict_c++</td>
<td>停用对 C++ 编译器扩展支持。默认情况下扩展支持处于启用状态。</td>
</tr>
<tr>
<td>depend_includepath</td>
<td>启用自动追加 INCLUDEPATH 到 DEPENDPATH。默认配置。</td>
</tr>
<tr>
<td>lrelease</td>
<td>对 TRANSLATIONS 和 EXTRA_TRANSLATIONS 中列出的所有文件执行 lrelease。如果未配置  embed_translations，则需要将生成的 .qm 文件装载至 QM_FILES_INSTALL_PATH 中。使用  QMAKE_LRELEASE_FLAGS 向 lrelease 调用添加选项。默认不配置。</td>
</tr>
<tr>
<td>embed_translations</td>
<td>根据 QM_FILES_RESOURCE_PREFIX 设置，将 lrelease 生成的翻译文件嵌入可执行文件中。此外还需要配置  lrelease。默认不配置。</td>
</tr>
<tr>
<td>create_libtool</td>
<td>在当前构建的库创建一个 libtool 类型的 .la 文件。</td>
</tr>
<tr>
<td>create_pc</td>
<td>在当前构建的库创建一个 pkg-config 类型的 .pc 文件。</td>
</tr>
<tr>
<td>no_batch</td>
<td>NMake only：关闭 NMake 批处理规则或推理规则的生成。</td>
</tr>
<tr>
<td>skip_target_version_ext</td>
<td>在 Windows 环境中，禁止自动将版本号附加到 DLL 文件名中。</td>
</tr>
<tr>
<td>suppress_vcproj_warnings</td>
<td>禁止 VS 项目生成器的警告。</td>
</tr>
<tr>
<td>windeployqt</td>
<td>链接后自动调用windeployqt，并将输出添加为部署项。</td>
</tr>
<tr>
<td>dont_recurse</td>
<td>禁止 qmake 在子项目递归执行。</td>
</tr>
<tr>
<td>no_include_pwd</td>
<td>当前目录不添加至 INCLUDEPATHS。</td>
</tr>
<tr>
<td>compile_included_sources</td>
<td>默认情况下，qmake 不编译包含在其他源文件的源文件。默认不配置此项。</td>
</tr>
</tbody></table>
<p><strong>常用qmake函数</strong></p>
<table>
<thead>
<tr>
<th>函数</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>message</td>
<td>在General Messages输出</td>
</tr>
<tr>
<td>message($$(PATH))</td>
<td>输出环境变量</td>
</tr>
<tr>
<td>log</td>
<td>输出信息(不换行)</td>
</tr>
<tr>
<td>include</td>
<td>一般用于包含pri文件</td>
</tr>
<tr>
<td>greaterThan</td>
<td>常用于判断Qt版本(greaterThan(QT_MAJOR_VERSION, 4): QT += widgets)</td>
</tr>
<tr>
<td>error</td>
<td>报警信息</td>
</tr>
</tbody></table>
<p>pro文件里，访问环境变量的用法是：$(varName)</p>
<p>pro文件里，访问Qt配置参数的用法：$$[varName]</p>
<p>在不同的编译平台上编译时，需要设定条件。如：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">win32&#123;</span><br><span class="line"> SOURCES += <span class="number">1</span><span class="selector-class">.cpp</span></span><br><span class="line">&#125;else&#123;</span><br><span class="line"> SOURCES += <span class="number">2</span><span class="selector-class">.cpp</span></span><br><span class="line">&#125;</span><br><span class="line">或者</span><br><span class="line">win32：SOURCES += <span class="number">3</span><span class="selector-class">.cpp</span></span><br></pre></td></tr></table></figure>

<p>pro文件常用代码:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">RC_ICONS = ruler<span class="selector-class">.ico</span></span><br><span class="line">DESTDIR = bin #用于指定可执行文件或库文件的生成路径。</span><br><span class="line">UI_DIR = $$compiled/ui  # 存放ui_mainwindow<span class="selector-class">.h</span>之类文件</span><br><span class="line">MOC_DIR = $$compiled/moc   # 存放moc文件</span><br><span class="line">OBJECTS_DIR = $$compiled/obj    # 存放<span class="selector-class">.o</span>文件</span><br><span class="line">RCC_DIR = $$compiled/res # 存放资源文件</span><br><span class="line">INCLUDEPATH += INCLUDEPATH \</span><br><span class="line">               INCLUDEPATH \</span><br><span class="line">LIBS += -L folderPath  //引入的lib文件的路径  -L：引入路径</span><br><span class="line">Release:LIBS += -L folderPath // release 版引入的lib文件路径</span><br><span class="line">Debug:LIBS += -L folderPath // Debug 版引入的lib 文件路径</span><br><span class="line">#引入的lib文件,用于引入动态链接库</span><br><span class="line">LIBS += qaxcontainer.lib</span><br><span class="line">#工程中包含的资源文件</span><br><span class="line">RESOURCES   = Scintilla.qrc</span><br><span class="line">BINLIB = ../../bin ../../xercesc/lib</span><br><span class="line">QMAKE_LIBDIR = $$&#123;BINLIB&#125;</span><br></pre></td></tr></table></figure>

<p> Qt 基础模块分为以下几个：</p>
<ul>
<li> Qt Core，提供核心的非 GUI  功能，所有模块都需要这个模块。这个模块的类包括了动画框架、定时器、各个容器类、时间日期类、事件、IO、JSON、插件机制、智能指针、图形（矩形、路径等）、线程、XML 等。所有这些类都可以通过 <QtCore> 头文件引入。</QtCore></li>
<li> Qt Gui，提供 GUI 程序的基本功能，包括与窗口系统的集成、事件处理、OpenGL 和 OpenGL ES 集成、2D 图像、字体、拖放等。这些类一般由  Qt 用户界面类内部使用，当然也可以用于访问底层的 OpenGL ES 图像 API。Qt Gui  模块提供的是所有图形用户界面程序都需要的通用功能。</li>
<li> Qt Multimedia，提供<strong>视频、音频、收音机以及摄像头</strong>等功能。这些类可以通过 <QtMultimedia> 引入，而且需要在 pro 文件中添加 QT += multimedia。</QtMultimedia></li>
<li> Qt Network，提供跨平台的网络功能。这些类可以通过 <QtNetwork> 引入，而且需要在 pro 文件中添加 QT += network。</QtNetwork></li>
<li> Qt Qml，提供供 <strong>QML</strong>（一种脚本语言，也提供 JavaScript 的交互机制） 使用的 C++ API。这些类可以通过 <QtQml> 引入，而且需要在 pro 文件中添加 QT += qml。</QtQml></li>
<li> Qt Quick，允许在 Qt/C++ 程序中嵌入 Qt Quick（一种基于 Qt 的高度动画的用户界面，<strong>适合于移动平台开发</strong>）。这些类可以通过 <QtQuick> 引入，而且需要在 pro 文件中添加 QT += quick。</QtQuick></li>
<li> Qt SQL，允许使用 SQL 访问<strong>数据库</strong>。这些类可以通过 <QtSql> 引入，而且需要在 pro 文件中添加 QT += sql。</QtSql></li>
<li> Qt Test，提供 Qt 程序的<strong>单元测试</strong>功能。这些类可以通过 <QtTest> 引入，而且需要在 pro 文件中添加 QT += testlib。</QtTest></li>
<li> Qt Webkit，基于 WebKit2 的实现以及一套全新的 QML API（顺便说一下，Qt 4.8 附带的是 QtWebkit 2.2）。</li>
</ul>
<h1 id="ui-创建widget并放大图片-dock停靠"><a href="#ui-创建widget并放大图片-dock停靠" class="headerlink" title="ui 创建widget并放大图片,dock停靠"></a>ui 创建widget并放大图片,dock停靠</h1><blockquote>
<p>MyExample-》DisplayBigLabel</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ShowIconWidget *w=<span class="keyword">new</span> ShowIconWidget;</span><br><span class="line">w-&gt;<span class="built_in">setFixedSize</span>(<span class="number">100</span>,<span class="number">100</span>);</span><br><span class="line">w-&gt;<span class="built_in">setPixmap</span>(map);</span><br><span class="line">ui-&gt;horizontalLayout_28-&gt;<span class="built_in">addWidget</span>(w);</span><br><span class="line"></span><br><span class="line">ui-&gt;horizontalLayout_28 是ScrollArea里面的Layout</span><br></pre></td></tr></table></figure>

<p> .h</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> SHOWICONWIDGET_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SHOWICONWIDGET_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QLabel&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QWidget&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ShowIconWidget</span> :</span> <span class="keyword">public</span> QWidget</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">ShowIconWidget</span><span class="params">(QWidget *parent = <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setPixmap</span><span class="params">(<span class="keyword">const</span> QPixmap&amp; map)</span></span>;</span><br><span class="line">    ~<span class="built_in">ShowIconWidget</span>();</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">paintEvent</span><span class="params">(QPaintEvent *event)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">enterEvent</span><span class="params">(QEvent *event)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">leaveEvent</span><span class="params">(QEvent *event)</span></span>;</span><br><span class="line">signals:</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> slots:</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    QLabel m_MaxMap;</span><br><span class="line">    QPixmap m_map;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// SHOWICONWIDGET_H</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>.cpp</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;ShowIconWidget.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QApplication&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QDesktopWidget&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QPainter&gt;</span></span></span><br><span class="line">ShowIconWidget::<span class="built_in">ShowIconWidget</span>(QWidget *parent) : <span class="built_in">QWidget</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">setMouseTracking</span>(<span class="literal">true</span>);</span><br><span class="line">    m_MaxMap.<span class="built_in">setParent</span>(<span class="keyword">this</span>);</span><br><span class="line">    m_MaxMap.<span class="built_in">setWindowFlag</span>(Qt::Tool);</span><br><span class="line">    m_MaxMap.<span class="built_in">setWindowFlag</span>(Qt::FramelessWindowHint);</span><br><span class="line">    m_MaxMap.<span class="built_in">setAttribute</span>(Qt::WA_TranslucentBackground);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ShowIconWidget::setPixmap</span><span class="params">(<span class="keyword">const</span> QPixmap &amp;map)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    m_map = map;</span><br><span class="line">    m_MaxMap.<span class="built_in">setPixmap</span>(m_map);</span><br><span class="line">    m_MaxMap.<span class="built_in">setFixedSize</span>(m_map.<span class="built_in">size</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ShowIconWidget::~<span class="built_in">ShowIconWidget</span>()</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ShowIconWidget::paintEvent</span><span class="params">(QPaintEvent *event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> QPainter p;</span><br><span class="line">    p.<span class="built_in">begin</span>(<span class="keyword">this</span>);</span><br><span class="line">    p.<span class="built_in">drawPixmap</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="keyword">this</span>-&gt;<span class="built_in">width</span>(),<span class="keyword">this</span>-&gt;<span class="built_in">height</span>(),m_map);</span><br><span class="line">    p.<span class="built_in">end</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ShowIconWidget::enterEvent</span><span class="params">(QEvent *event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QRect screenRect = QApplication::<span class="built_in">desktop</span>()-&gt;<span class="built_in">screenGeometry</span>();</span><br><span class="line">    <span class="keyword">int</span> x,y;</span><br><span class="line">    <span class="keyword">if</span>(screenRect.<span class="built_in">height</span>()-<span class="built_in">cursor</span>().<span class="built_in">pos</span>().<span class="built_in">y</span>()&gt;m_MaxMap.<span class="built_in">height</span>())&#123;</span><br><span class="line">        y = <span class="built_in">cursor</span>().<span class="built_in">pos</span>().<span class="built_in">y</span>();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        y = <span class="built_in">cursor</span>().<span class="built_in">pos</span>().<span class="built_in">y</span>()-m_MaxMap.<span class="built_in">height</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(screenRect.<span class="built_in">width</span>()-<span class="built_in">cursor</span>().<span class="built_in">pos</span>().<span class="built_in">x</span>()&gt;m_MaxMap.<span class="built_in">width</span>())&#123;</span><br><span class="line">        x = <span class="built_in">cursor</span>().<span class="built_in">pos</span>().<span class="built_in">x</span>();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        x = <span class="built_in">cursor</span>().<span class="built_in">pos</span>().<span class="built_in">x</span>()-m_MaxMap.<span class="built_in">width</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    m_MaxMap.<span class="built_in">move</span>(x,y);</span><br><span class="line">    m_MaxMap.<span class="built_in">show</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ShowIconWidget::leaveEvent</span><span class="params">(QEvent *event)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    m_MaxMap.<span class="built_in">hide</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="拖放配置文件到一个exe，打开该exe"><a href="#拖放配置文件到一个exe，打开该exe" class="headerlink" title="拖放配置文件到一个exe，打开该exe"></a>拖放配置文件到一个exe，打开该exe</h1><p>拖放文件到一个exe时<br>文件的路径会作为命令行参数传递给应用程序<br>可以根据这个参数作处理</p>
<p><strong>main的原型函数是：</strong><br>*<em>main(int argc, char *<em>argv)</em></em><br><strong>其中：</strong><br><strong>argc 表示接收的命令个数</strong><br><strong>argv 传入的命令内容</strong></p>
<p><strong>argc == 1 就是说参数的个数为1.</strong> </p>
<p>*<em>argv是字符串数组,存的是参数,定义为char*<em>或者char* argv[]</em></em></p>
<p><strong>【举例】</strong> </p>
<p><strong>比如你编译好的程序为my.exe</strong> </p>
<p><strong>（1）在命令行执行 my.exe</strong> </p>
<p><strong>则：此时argc就是1，接受参数是1个，即参数argv[0]是”my.exe”</strong> </p>
<p><strong>（2）在命令行执行 my.exe 1 2 3</strong> </p>
<p><strong>则：此时argc就是4，接受参数是4个，即参数argv[0]是”my.exe”，argv[1]是”1”，argv[2]是”2”，argv[3]是”3”;</strong></p>
<p>if (argc &gt;= 2)</p>
<p>  Cfg::get()-&gt;setConfigPath(argv[1]);</p>
<h1 id="程序每次只能有一个实例运行"><a href="#程序每次只能有一个实例运行" class="headerlink" title="程序每次只能有一个实例运行"></a>程序每次只能有一个实例运行</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QApplication::<span class="built_in">setAttribute</span>(Qt::AA_Use96Dpi);</span><br><span class="line">    <span class="built_in">qputenv</span>(<span class="string">&quot;QT_SCALE_FACTOR&quot;</span>,QString::<span class="built_in">number</span>(<span class="number">1.0</span>).<span class="built_in">toLatin1</span>());</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Q_INIT_RESOURCE</span>(MapControl_qrc);</span><br><span class="line">    <span class="function">QApplication <span class="title">a</span><span class="params">(argc, argv)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//用于确保只有一个实例在运行的共享内存键值</span></span><br><span class="line">    <span class="keyword">const</span> QString sharedMemoryKey = <span class="string">&quot;MySingleApplicationKey1&quot;</span>;</span><br><span class="line">    <span class="comment">//尝试创建共享内存，如果创建失败，则表示已有一个实例在运行</span></span><br><span class="line">    <span class="function">QSharedMemory <span class="title">sharedMemory</span><span class="params">(sharedMemoryKey)</span></span>;</span><br><span class="line">    <span class="keyword">if</span> (!sharedMemory.<span class="built_in">create</span>(<span class="number">1</span>)) &#123;</span><br><span class="line">        <span class="comment">// 已有实例在运行，向现有实例发送消息（文件路径）</span></span><br><span class="line">        QLocalSocket socket;</span><br><span class="line">        socket.<span class="built_in">connectToServer</span>(sharedMemoryKey);</span><br><span class="line">        <span class="keyword">if</span> (socket.<span class="built_in">waitForConnected</span>(<span class="number">500</span>)) &#123;</span><br><span class="line">            <span class="comment">// 获取命令行参数</span></span><br><span class="line">            QStringList args = QCoreApplication::<span class="built_in">arguments</span>();</span><br><span class="line">            <span class="keyword">if</span> (args.<span class="built_in">count</span>() &gt; <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="comment">// 第二个参数是文件路径</span></span><br><span class="line">                QString filePath = args.<span class="built_in">at</span>(<span class="number">1</span>);</span><br><span class="line">                <span class="comment">// 发送文件路径给现有实例</span></span><br><span class="line">                socket.<span class="built_in">write</span>(filePath.<span class="built_in">toUtf8</span>());</span><br><span class="line">                socket.<span class="built_in">flush</span>();</span><br><span class="line">                socket.<span class="built_in">waitForBytesWritten</span>(<span class="number">1000</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建本地服务器用于接收其他实例传递的文件路径</span></span><br><span class="line">    QLocalServer localServer;</span><br><span class="line">    <span class="keyword">if</span> (!localServer.<span class="built_in">listen</span>(sharedMemoryKey)) &#123;</span><br><span class="line">        <span class="comment">// 本地服务器监听失败</span></span><br><span class="line">        <span class="built_in">qDebug</span>()&lt;&lt;(<span class="string">&quot;Failed to start local server.&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    QResource::<span class="built_in">registerResource</span>(<span class="string">&quot;./resource.rcc&quot;</span>);</span><br><span class="line"></span><br><span class="line">    MainWindow w;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理新的文件路径</span></span><br><span class="line">    QObject::<span class="built_in">connect</span>(&amp;localServer, &amp;QLocalServer::newConnection, [&amp;]() &#123;</span><br><span class="line">        QLocalSocket *clientConnection = localServer.<span class="built_in">nextPendingConnection</span>();</span><br><span class="line">        <span class="keyword">if</span> (clientConnection) &#123;</span><br><span class="line">            <span class="keyword">if</span> (clientConnection-&gt;<span class="built_in">waitForReadyRead</span>(<span class="number">1000</span>)) &#123;</span><br><span class="line">                <span class="comment">// 读取文件路径</span></span><br><span class="line">                QByteArray data = clientConnection-&gt;<span class="built_in">readAll</span>();</span><br><span class="line">                QString filePath = QString::<span class="built_in">fromUtf8</span>(data);</span><br><span class="line">                <span class="comment">// 处理文件路径</span></span><br><span class="line">                <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">// 示例：显示文件路径</span></span><br><span class="line">                <span class="built_in">qDebug</span>()&lt;&lt;(<span class="string">&quot;File Path&quot;</span>+filePath);</span><br><span class="line">                w.<span class="built_in">decompression</span>(filePath);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//                w.resize(Cfg::get()-&gt;valI(&quot;width&quot;),Cfg::get()-&gt;valI(&quot;height&quot;));</span></span><br><span class="line">                <span class="comment">//                w.move(Cfg::get()-&gt;valI(&quot;X&quot;),Cfg::get()-&gt;valI(&quot;Y&quot;));</span></span><br><span class="line">                <span class="comment">//                w.show();</span></span><br><span class="line">                w.<span class="built_in">resize</span>(rect.<span class="built_in">width</span>(),rect.<span class="built_in">height</span>());</span><br><span class="line">                w.<span class="built_in">move</span>(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">                w.<span class="built_in">showMaximized</span>();</span><br><span class="line">                w.<span class="built_in">resizeLabel</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            clientConnection-&gt;<span class="built_in">deleteLater</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(argc==<span class="number">2</span>)</span><br><span class="line">        w.<span class="built_in">decompression</span>(argv[<span class="number">1</span>]);</span><br><span class="line">    </span><br><span class="line">    w.<span class="built_in">showMaximized</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> a.<span class="built_in">exec</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="文件后缀关联应用程序，双击文件打开对应程序"><a href="#文件后缀关联应用程序，双击文件打开对应程序" class="headerlink" title="文件后缀关联应用程序，双击文件打开对应程序"></a>文件后缀关联应用程序，双击文件打开对应程序</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43058397/article/details/113917992">https://blog.csdn.net/qq_43058397/article/details/113917992</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Albert_weiku/article/details/127652571">https://blog.csdn.net/Albert_weiku/article/details/127652571</a></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*******************************************************************</span></span><br><span class="line"><span class="comment">* 注册文件关联</span></span><br><span class="line"><span class="comment">*       className    // 自定义的类别</span></span><br><span class="line"><span class="comment">*       appPath      // 关联的程序目录</span></span><br><span class="line"><span class="comment">*       ext          // 关联的文件类型</span></span><br><span class="line"><span class="comment">*       extDes       // 该文件类型描述</span></span><br><span class="line"><span class="comment">*       iconPath     // 图标目录</span></span><br><span class="line"><span class="comment">*******************************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">registerFileRelation</span><span class="params">(<span class="keyword">const</span> QString&amp; className, <span class="keyword">const</span> QString&amp; appPath, <span class="keyword">const</span> QString&amp; ext, <span class="keyword">const</span> QString&amp; extDes, <span class="keyword">const</span> QString&amp; iconPath)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 读取注册表项的值,存在则不写入</span></span><br><span class="line">    <span class="function">QSettings <span class="title">settings</span><span class="params">(<span class="string">&quot;HKEY_CURRENT_USER\\Software\\Classes\\&quot;</span>+className+<span class="string">&quot;\\DefaultIcon\\&quot;</span>, QSettings::NativeFormat)</span></span>;</span><br><span class="line">    QVariant value = settings.<span class="built_in">value</span>(<span class="string">&quot;.&quot;</span>); <span class="comment">// 例如，读取 &quot;29&quot; 键对应的值</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (value.<span class="built_in">isValid</span>() &amp;&amp; value.<span class="built_in">toString</span>() == iconPath) &#123;</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;Value read from registry:&quot;</span> &lt;&lt; value.<span class="built_in">toString</span>();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;Registry value not found.&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//注册表中不存在，要写入</span></span><br><span class="line">    <span class="function">QString <span class="title">baseUrl</span><span class="params">(<span class="string">&quot;HKEY_CURRENT_USER\\Software\\Classes&quot;</span>)</span></span>;    <span class="comment">// 要添加的顶层目录</span></span><br><span class="line">    <span class="function">QSettings <span class="title">settingClasses</span><span class="params">(baseUrl,QSettings::NativeFormat)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 在...Classes\类别下创建一个新的类别，并设置该类别打开文件时的调用参数</span></span><br><span class="line">    settingClasses.<span class="built_in">setValue</span>(<span class="string">&quot;/&quot;</span> + className + <span class="string">&quot;/Shell/Open/Command/.&quot;</span>,<span class="string">&quot;\&quot;&quot;</span> + appPath + <span class="string">&quot;\&quot; \&quot;%1\&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 文件类型描述</span></span><br><span class="line">    settingClasses.<span class="built_in">setValue</span>(<span class="string">&quot;/&quot;</span> + className + <span class="string">&quot;/.&quot;</span>,extDes);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置该类别的默认图标默认图标</span></span><br><span class="line">    settingClasses.<span class="built_in">setValue</span>(<span class="string">&quot;/&quot;</span> + className + <span class="string">&quot;/DefaultIcon/.&quot;</span>,iconPath );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 关联ext 和 类别</span></span><br><span class="line">    settingClasses.<span class="built_in">setValue</span>(<span class="string">&quot;/&quot;</span> + ext + <span class="string">&quot;/OpenWithProgIds/&quot;</span> + className,<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 立即保存该修改</span></span><br><span class="line">    settingClasses.<span class="built_in">sync</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 强制刷新注册表</span></span><br><span class="line">    QSettings::<span class="built_in">setDefaultFormat</span>(QSettings::NativeFormat);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 通知系统刷新图标缓存</span></span><br><span class="line">    ::<span class="built_in">SHChangeNotify</span>(SHCNE_ASSOCCHANGED, SHCNF_IDLIST, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QApplication::<span class="built_in">setAttribute</span>(Qt::AA_Use96Dpi);</span><br><span class="line">    <span class="built_in">qputenv</span>(<span class="string">&quot;QT_SCALE_FACTOR&quot;</span>,QString::<span class="built_in">number</span>(<span class="number">1.0</span>).<span class="built_in">toLatin1</span>());</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Q_INIT_RESOURCE</span>(MapControl_qrc);</span><br><span class="line">    <span class="function">QApplication <span class="title">a</span><span class="params">(argc, argv)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">QString <span class="title">className</span><span class="params">(<span class="string">&quot;MyTZP&quot;</span>)</span></span>;                              <span class="comment">// 自定义的类别</span></span><br><span class="line">    <span class="function">QString <span class="title">appPath</span><span class="params">(argv[<span class="number">0</span>])</span></span>;                                <span class="comment">// 关联的程序目录</span></span><br><span class="line">    <span class="function">QString <span class="title">ext</span><span class="params">(<span class="string">&quot;.TZP&quot;</span>)</span></span>;                                     <span class="comment">// 关联的文件类型</span></span><br><span class="line">    <span class="function">QString <span class="title">extDes</span><span class="params">(<span class="string">&quot;TZQX&quot;</span>)</span></span>;                                  <span class="comment">// 该文件类型描述</span></span><br><span class="line">    QString iconPath=QApplication::<span class="built_in">applicationDirPath</span>()+<span class="string">&quot;/logo.ico&quot;</span>;<span class="comment">// 该文件类型描述</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">registerFileRelation</span>(className,appPath,ext,extDes,iconPath);</span><br><span class="line">    QDir::<span class="built_in">setCurrent</span>(QApplication::<span class="built_in">applicationDirPath</span>());</span><br><span class="line"></span><br><span class="line">    QResource::<span class="built_in">registerResource</span>(<span class="string">&quot;./resource.rcc&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    MainWindow w;</span><br><span class="line">    w.<span class="built_in">showMaximized</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> a.<span class="built_in">exec</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Qt-调用其他exe"><a href="#Qt-调用其他exe" class="headerlink" title="Qt 调用其他exe"></a>Qt 调用其他exe</h1><h2 id="传递参数1"><a href="#传递参数1" class="headerlink" title="传递参数1"></a>传递参数1</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">QProcess *myProcess=<span class="keyword">new</span> <span class="built_in">QProcess</span>(<span class="keyword">this</span>);</span><br><span class="line"><span class="comment">//QString program = &quot;..\\camera\\HCN_PTZControl\\release\\HCN_PTZControl.exe&quot;;</span></span><br><span class="line">QString program = <span class="string">&quot;.\\camera\\HCN\\HCN_PTZControl.exe&quot;</span>;<span class="comment">//&quot;./camera\\HCN\\HCN_PTZControl.exe&quot;;</span></span><br><span class="line">QStringList arguments;</span><br><span class="line"><span class="comment">//qDebug()&lt;&lt;&quot;-------------------------------------------------------------------------------------&quot;;</span></span><br><span class="line"><span class="comment">//TCPPort,camIP,camPort,camuser,camPass,video,UDPIP,UDPPort,boardUDPPort</span></span><br><span class="line">arguments&lt;&lt;QString::<span class="built_in">number</span>(Cfg::<span class="built_in">get</span>()-&gt;<span class="built_in">valI</span>(<span class="string">&quot;LeftTCPPort&quot;</span>))</span><br><span class="line">    &lt;&lt;QString::<span class="built_in">fromStdString</span>(ipport[<span class="number">0</span>])</span><br><span class="line">    &lt;&lt;QString::<span class="built_in">fromStdString</span>(ipport[<span class="number">1</span>])</span><br><span class="line">    &lt;&lt;QString::<span class="built_in">fromStdString</span>(ipport[<span class="number">2</span>])</span><br><span class="line">    &lt;&lt;QString::<span class="built_in">fromStdString</span>(ipport[<span class="number">3</span>])</span><br><span class="line">    &lt;&lt;QString::<span class="built_in">fromStdString</span>(Cfg::<span class="built_in">get</span>()-&gt;<span class="built_in">valS</span>(<span class="string">&quot;LeftvideoAddress&quot;</span>))<span class="comment">//可见光视频流</span></span><br><span class="line">    &lt;&lt;QString::<span class="built_in">fromStdString</span>(Cfg::<span class="built_in">get</span>()-&gt;<span class="built_in">valS</span>(<span class="string">&quot;LeftredAddress&quot;</span>))<span class="comment">//红外视频流</span></span><br><span class="line">    &lt;&lt;QString::<span class="built_in">fromStdString</span>(Cfg::<span class="built_in">get</span>()-&gt;<span class="built_in">valS</span>(<span class="string">&quot;LeftDetectIP&quot;</span>))<span class="comment">//检测IP</span></span><br><span class="line">    &lt;&lt;QString::<span class="built_in">number</span>(Cfg::<span class="built_in">get</span>()-&gt;<span class="built_in">valI</span>(<span class="string">&quot;LeftDetectPort&quot;</span>)) <span class="comment">//检测Port</span></span><br><span class="line">    &lt;&lt;QString::<span class="built_in">number</span>(Cfg::<span class="built_in">get</span>()-&gt;<span class="built_in">valI</span>(<span class="string">&quot;LeftSortPort&quot;</span>)) <span class="comment">//跟踪Port</span></span><br><span class="line">    &lt;&lt;QString::<span class="built_in">number</span>(Cfg::<span class="built_in">get</span>()-&gt;<span class="built_in">valI</span>(<span class="string">&quot;LeftBoard&quot;</span>)) <span class="comment">//标牌Port</span></span><br><span class="line">    &lt;&lt;QString::<span class="built_in">fromStdString</span>(Cfg::<span class="built_in">get</span>()-&gt;<span class="built_in">valS</span>(<span class="string">&quot;LeftControlIP&quot;</span>))<span class="comment">//控制红外切换</span></span><br><span class="line">    &lt;&lt;QString::<span class="built_in">number</span>(Cfg::<span class="built_in">get</span>()-&gt;<span class="built_in">valI</span>(<span class="string">&quot;LeftControlPort&quot;</span>))<span class="comment">//控制红外切换</span></span><br><span class="line">    &lt;&lt;QString::<span class="built_in">fromStdString</span>(Cfg::<span class="built_in">get</span>()-&gt;<span class="built_in">valS</span>(<span class="string">&quot;MessSendIp&quot;</span>))<span class="comment">//状态发送</span></span><br><span class="line">    &lt;&lt;QString::<span class="built_in">number</span>(Cfg::<span class="built_in">get</span>()-&gt;<span class="built_in">valI</span>(<span class="string">&quot;MessSendPort&quot;</span>))<span class="comment">//状态发送</span></span><br><span class="line">    &lt;&lt;QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;Left&quot;</span>);</span><br><span class="line"><span class="comment">//            qDebug()&lt;&lt;&quot;-------------------------------------------------------------------------------------&quot;&lt;&lt;arguments;</span></span><br><span class="line">myProcess-&gt;<span class="built_in">start</span>(program,arguments);</span><br></pre></td></tr></table></figure>

<h2 id="传递参数2"><a href="#传递参数2" class="headerlink" title="传递参数2"></a>传递参数2</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QProcess p;</span><br><span class="line">p.<span class="built_in">start</span>(<span class="string">&quot;cmd&quot;</span>, <span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;/c&quot;</span>&lt;&lt;QDir::<span class="built_in">currentPath</span>()+<span class="string">&quot;/readpdf/readpdf.exe --file &quot;</span>+filename);</span><br><span class="line">p.<span class="built_in">waitForStarted</span>();</span><br><span class="line">p.<span class="built_in">waitForFinished</span>();</span><br><span class="line">QString strTemp=QString::<span class="built_in">fromLocal8Bit</span>(p.<span class="built_in">readAllStandardOutput</span>());</span><br></pre></td></tr></table></figure>

<h2 id="带dos界面"><a href="#带dos界面" class="headerlink" title="带dos界面"></a>带dos界面</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">QProcess m_process;</span><br><span class="line">m_process.<span class="built_in">setWorkingDirectory</span>(<span class="string">&quot;E:/Projects/SpxFrame/212/TZweatherDisplay/Main/release/RouteOptimization/setUp/&quot;</span>);</span><br><span class="line">m_process.<span class="built_in">start</span>(<span class="string">&quot;cmd.exe&quot;</span>);                                                                                                     </span><br><span class="line">m_process.<span class="built_in">write</span>(<span class="string">&quot;start E:/Projects/SpxFrame/212/TZweatherDisplay/Main/release/RouteOptimization/setUp/setUp.exe\n&quot;</span>);            </span><br></pre></td></tr></table></figure>

<p><img src="/2021/06/27/Qt/image-20240115090347335.png" alt="image-20240115090347335"></p>
<h2 id="不带dos界面"><a href="#不带dos界面" class="headerlink" title="不带dos界面"></a>不带dos界面</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QProcess m_process;</span><br><span class="line">m_process.<span class="built_in">setWorkingDirectory</span>(<span class="string">&quot;E:/Projects/SpxFrame/212/TZweatherDisplay/Main/release/RouteOptimization/setUp/&quot;</span>);</span><br><span class="line">m_process.<span class="built_in">start</span>(<span class="string">&quot;E:/Projects/SpxFrame/212/TZweatherDisplay/Main/release/RouteOptimization/setUp/setUp.exe&quot;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="/2021/06/27/Qt/image-20240115090236827.png" alt="image-20240115090236827"></p>
<h1 id="字符串转json"><a href="#字符串转json" class="headerlink" title="字符串转json"></a>字符串转json</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QByteArray <span class="title">Route::Route2Json</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QByteArray json=<span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(RouteDataManager::<span class="built_in">getInstance</span>()-&gt;<span class="built_in">GetRouteName</span>()==<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> json;</span><br><span class="line"></span><br><span class="line">    QVector&lt;RouteStruct&gt; &amp; _vOriRoute =</span><br><span class="line">            RouteDataManager::<span class="built_in">getInstance</span>()-&gt;<span class="built_in">GetOriRoute</span>()[RouteDataManager::<span class="built_in">getInstance</span>()-&gt;<span class="built_in">GetRouteName</span>()];</span><br><span class="line"></span><br><span class="line">    QJsonObject jpath;</span><br><span class="line">    QJsonArray lines;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> point:_vOriRoute)</span><br><span class="line">    &#123;</span><br><span class="line">        lines.<span class="built_in">push_back</span>(<span class="built_in">QJsonObject</span>(&#123;</span><br><span class="line">                                        &#123;<span class="string">&quot;radius&quot;</span>,point._radius&#125;,</span><br><span class="line">                                        &#123;<span class="string">&quot;starboard&quot;</span>,point._starboard&#125;,</span><br><span class="line">                                        &#123;<span class="string">&quot;port&quot;</span>, point._port&#125;,</span><br><span class="line">                                        &#123;<span class="string">&quot;distance&quot;</span>,point._distance&#125;,        <span class="comment">//到当前点为止，累计的距离</span></span><br><span class="line">                                        &#123;<span class="string">&quot;usedtime&quot;</span>,point._usedtime&#125;,        <span class="comment">//到当前点为止，累计的耗时</span></span><br><span class="line">                                        &#123;<span class="string">&quot;type&quot;</span>,point._type&#125;,               <span class="comment">//点类型</span></span><br><span class="line">                                        &#123;<span class="string">&quot;arrivetime&quot;</span>, point._datatime&#125;,    <span class="comment">//到达时间 yyyyMMdd hh/mm/ss</span></span><br><span class="line">                                        &#123;<span class="string">&quot;schedual&quot;</span>,point._schedual&#125;,       <span class="comment">//计划使用的气象时次</span></span><br><span class="line">                                        &#123;<span class="string">&quot;lon&quot;</span>, point._latlon.<span class="built_in">rx</span>()&#125;,        <span class="comment">//经纬度</span></span><br><span class="line">                                        &#123;<span class="string">&quot;lat&quot;</span>, point._latlon.<span class="built_in">ry</span>()&#125;,</span><br><span class="line">                                        &#123;<span class="string">&quot;speed&quot;</span>,point._speed&#125;,              <span class="comment">//计划速度</span></span><br><span class="line">                                        &#123;<span class="string">&quot;Course&quot;</span>,point._bearing&#125;&#125;));        <span class="comment">//方位角</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    jpath.<span class="built_in">insert</span>(<span class="string">&quot;lines&quot;</span>, lines);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(ui-&gt;Rb_Distance-&gt;<span class="built_in">isChecked</span>())&#123;</span><br><span class="line">        jpath.<span class="built_in">insert</span>(<span class="string">&quot;type&quot;</span>, <span class="number">1</span>);</span><br><span class="line">        m_OptType=<span class="string">&quot;最短路径&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(ui-&gt;Rb_Time-&gt;<span class="built_in">isChecked</span>())&#123;</span><br><span class="line">        jpath.<span class="built_in">insert</span>(<span class="string">&quot;type&quot;</span>, <span class="number">2</span>);</span><br><span class="line">        m_OptType=<span class="string">&quot;最短时间&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(ui-&gt;Rb_Oil-&gt;<span class="built_in">isChecked</span>())&#123;</span><br><span class="line">        jpath.<span class="built_in">insert</span>(<span class="string">&quot;type&quot;</span>, <span class="number">3</span>);</span><br><span class="line">        m_OptType=<span class="string">&quot;最低油耗&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(ui-&gt;Rb_Comfort-&gt;<span class="built_in">isChecked</span>())&#123;</span><br><span class="line">        jpath.<span class="built_in">insert</span>(<span class="string">&quot;type&quot;</span>, <span class="number">4</span>);</span><br><span class="line">        m_OptType=<span class="string">&quot;最佳舒适&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(ui-&gt;Rb_All-&gt;<span class="built_in">isChecked</span>())&#123;</span><br><span class="line">        jpath.<span class="built_in">insert</span>(<span class="string">&quot;type&quot;</span>, <span class="number">5</span>);</span><br><span class="line">        m_OptType=<span class="string">&quot;多目标优化&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        jpath.<span class="built_in">insert</span>(<span class="string">&quot;type&quot;</span>, <span class="number">1</span>);</span><br><span class="line">        m_OptType=<span class="string">&quot;最短路径&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    json = <span class="built_in">QJsonDocument</span>(jpath).<span class="built_in">toJson</span>(QJsonDocument::Indented);</span><br><span class="line">    <span class="keyword">return</span> json;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Qt使用HTTP通信（以调用百度翻译api为例）"><a href="#Qt使用HTTP通信（以调用百度翻译api为例）" class="headerlink" title="Qt使用HTTP通信（以调用百度翻译api为例）"></a>Qt使用HTTP通信（以调用百度翻译api为例）</h1><p>Qt使用HTTP主要用到以下三个类：</p>
<p>QNetworkAccessManager 该类允许应用发送网络请求并接收响应。</p>
<p>QNetworkRequest 该类包含了一个由QNetworkAccessManager发送的请求。</p>
<p>QNetworkReply 该类包含接收到的数据部分和QNetworkAccessManager发送请求的头部。</p>
<p>1.工程文件.pro里必须有network</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QT       += core gui network</span><br></pre></td></tr></table></figure>

<p>2.阅读百度翻译api帮助文档，定义请求体各段内容：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">QString MainWindow::API = <span class="string">&quot;http://api.fanyi.baidu.com/api/trans/vip/translate?&quot;</span>;</span><br><span class="line">QString MainWindow::from = <span class="string">&quot;en&quot;</span>;</span><br><span class="line">QString MainWindow::to = <span class="string">&quot;zh&quot;</span>;</span><br><span class="line">QString MainWindow::appid=输入你申请的id;</span><br><span class="line">QString MainWindow::salt=<span class="string">&quot;1435660288&quot;</span>;</span><br><span class="line">QString MainWindow::password = 输入你申请的password;</span><br></pre></td></tr></table></figure>

<p>3.定义请求成功后的槽函数并在cpp文件中自行实现：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> slots:</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">replyFinished</span><span class="params">(QNetworkReply *)</span></span>;</span><br></pre></td></tr></table></figure>

<p>4.拼接百度翻译pai请求内容：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">QString url;</span><br><span class="line">QString str1 = appid + transwordFrom + salt + password;</span><br><span class="line">str1 = str1.<span class="built_in">toUtf8</span>();</span><br><span class="line">QString sign;</span><br><span class="line">QByteArray ba, bb;</span><br><span class="line"><span class="function">QCryptographicHash <span class="title">md</span><span class="params">(QCryptographicHash::Md5)</span></span>;</span><br><span class="line">ba.<span class="built_in">append</span>(str1);</span><br><span class="line">md.<span class="built_in">addData</span>(ba);</span><br><span class="line">bb = md.<span class="built_in">result</span>();</span><br><span class="line">sign.<span class="built_in">append</span>(bb.<span class="built_in">toHex</span>());</span><br><span class="line">url = API + <span class="string">&quot;q=&quot;</span> + transwordFrom + <span class="string">&quot;&amp;from=&quot;</span> + from + <span class="string">&quot;&amp;to=&quot;</span> + to + <span class="string">&quot;&amp;appid=&quot;</span> + appid + <span class="string">&quot;&amp;salt=&quot;</span> + salt + <span class="string">&quot;&amp;sign=&quot;</span> + sign;</span><br></pre></td></tr></table></figure>

<p>5.本来通过manager-&gt;<em>get</em>(QNetworkRequest(QUrl(url)));//发送请求</p>
<p>就可以等待槽函数响应了，但是会出现读取日文的while会阻塞主线程，槽函数响应不及时，所以需要不经过槽函数，就有了下面的代码</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">QEventLoop temp_loop;</span><br><span class="line">QNetworkReply *reply = manager-&gt;*get*(<span class="built_in">QNetworkRequest</span>(<span class="built_in">QUrl</span>(url)));<span class="comment">//发送请求</span></span><br><span class="line"><span class="built_in">connect</span>(reply, <span class="built_in">SIGNAL</span>(<span class="built_in">finished</span>()), &amp;temp_loop, <span class="built_in">SLOT</span>(<span class="built_in">quit</span>()));</span><br><span class="line">temp_loop.<span class="built_in">exec</span>();</span><br><span class="line"><span class="built_in">Sleep</span>(<span class="number">1000</span>);</span><br><span class="line"><span class="built_in">replyFinished</span>(Donttransword,reply);</span><br></pre></td></tr></table></figure>

<p><strong>//QNetworkAccessManager不使用信号/槽机制来获得QNetworkReply的解决办法</strong></p>
<p><strong>//<a target="_blank" rel="noopener" href="https://blog.csdn.net/sheldon0227/article/details/50170437">https://blog.csdn.net/sheldon0227/article/details/50170437</a></strong></p>
<p>6.replyFinished函数</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">JanToChn::replyFinished</span><span class="params">(QString Donttransword, QNetworkReply *reply)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QString mean = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    QTextCodec * codec = QTextCodec::<span class="built_in">codecForName</span>(<span class="string">&quot;Shift-JIS&quot;</span>);</span><br><span class="line">    QString all = reply-&gt;<span class="built_in">readAll</span>();</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; all;</span><br><span class="line">    QJsonParseError jsonError;</span><br><span class="line">    QJsonDocument json = QJsonDocument::<span class="built_in">fromJson</span>(all.<span class="built_in">toUtf8</span>(), &amp;jsonError);</span><br><span class="line">    <span class="keyword">if</span> (jsonError.error == QJsonParseError::NoError) &#123;</span><br><span class="line">        <span class="keyword">if</span> (json.<span class="built_in">isObject</span>()) &#123;</span><br><span class="line">            QJsonObject rootObj = json.<span class="built_in">object</span>();</span><br><span class="line">            <span class="keyword">if</span> (rootObj.<span class="built_in">contains</span>(<span class="string">&quot;trans_result&quot;</span>)) &#123;</span><br><span class="line">                QJsonValue resultValue = rootObj.<span class="built_in">value</span>(<span class="built_in">QString</span>(<span class="string">&quot;trans_result&quot;</span>));</span><br><span class="line">                <span class="built_in">qDebug</span>() &lt;&lt; resultValue;</span><br><span class="line">            </span><br><span class="line">                QJsonArray array = resultValue.<span class="built_in">toArray</span>();</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">                    QJsonObject explains = array.<span class="built_in">at</span>(i).<span class="built_in">toObject</span>();</span><br><span class="line">                    <span class="keyword">if</span> (explains.<span class="built_in">contains</span>(<span class="string">&quot;dst&quot;</span>)) &#123;</span><br><span class="line">                        QJsonValue dst = explains.<span class="built_in">value</span>(<span class="built_in">QString</span>(<span class="string">&quot;dst&quot;</span>));</span><br><span class="line">                        <span class="built_in">qDebug</span>() &lt;&lt; dst.<span class="built_in">toString</span>();</span><br><span class="line">                        mean = mean + dst.<span class="built_in">toString</span>();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                QByteArray encodedString = codec-&gt;<span class="built_in">fromUnicode</span>(mean);</span><br><span class="line">                <span class="built_in">qDebug</span>() &lt;&lt; mean; <span class="comment">//mean.toUtf8();//输出翻译结果</span></span><br><span class="line">                <span class="comment">//ui.textEditTransed-&gt;append(mean);</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    reply-&gt;<span class="built_in">deleteLater</span>();</span><br><span class="line">    Donttransword = Donttransword + <span class="string">&quot;;&quot;</span> + mean;</span><br><span class="line">    ui.textEditTransed-&gt;<span class="built_in">append</span>(Donttransword);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="TextEdit中显示日文"><a href="#TextEdit中显示日文" class="headerlink" title="TextEdit中显示日文"></a>TextEdit中显示日文</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置文件路径</span></span><br><span class="line">    <span class="function">QFile <span class="title">file</span><span class="params">(m_sOpenPath.toUtf8())</span></span>;</span><br><span class="line">    <span class="comment">//判断文件是否打开成功</span></span><br><span class="line">    <span class="keyword">if</span> (!file.<span class="built_in">open</span>(QIODevice::ReadOnly | QIODevice::Text))</span><br><span class="line">    &#123;</span><br><span class="line">        QMessageBox::<span class="built_in">warning</span>(<span class="keyword">this</span>, QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;打开文件&quot;</span>), QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;打开文件失败！&quot;</span>));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//文件流</span></span><br><span class="line">    <span class="function">QTextStream <span class="title">ts</span><span class="params">(&amp;file)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取文件中的数据</span></span><br><span class="line">    QString str_get;</span><br><span class="line">    <span class="comment">//就这句就这句，改变编码！！！！！！！！！！！！</span></span><br><span class="line">    ts.<span class="built_in">setCodec</span>(<span class="string">&quot;Shift-JIS&quot;</span>);</span><br><span class="line">    <span class="comment">//QTextCodec * codec = QTextCodec::codecForName(&quot;UTF-8&quot;);</span></span><br><span class="line">    <span class="comment">//循环文档数据至结尾</span></span><br><span class="line">    <span class="keyword">while</span> (!ts.<span class="built_in">atEnd</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//将全部数据绑定str_get</span></span><br><span class="line">        str_get = ts.<span class="built_in">readLine</span>();</span><br><span class="line">        ui.textEdit-&gt;<span class="built_in">append</span>(str_get);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//关闭文档</span></span><br><span class="line">    file.<span class="built_in">close</span>();</span><br><span class="line">TextEdit中是Unicode编码，可以直接显示日文，只要能读出来日文就行</span><br></pre></td></tr></table></figure>

<h1 id="qt多显示器获取不同显示器的分辨率和位置"><a href="#qt多显示器获取不同显示器的分辨率和位置" class="headerlink" title="qt多显示器获取不同显示器的分辨率和位置"></a><a target="_blank" rel="noopener" href="https://blog.csdn.net/x85371169/article/details/79351999">qt多显示器获取不同显示器的分辨率和位置</a></h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">QDesktopWidget *desktop = QApplication::<span class="built_in">desktop</span>();</span><br><span class="line"><span class="comment">//QRect screen1=desktop-&gt;screenGeometry(0);//主显示器</span></span><br><span class="line"><span class="comment">//QRect screen2=desktop-&gt;screenGeometry(1);//扩展显示器</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//获得当前程序所在屏幕的编号</span></span><br><span class="line"><span class="keyword">int</span> curWidgetScreenNum=desktop-&gt;<span class="built_in">screenNumber</span>(<span class="keyword">this</span>);</span><br><span class="line"><span class="comment">//当前程序所在屏幕的编号获取屏幕分辨率</span></span><br><span class="line">QRect rect = desktop-&gt;<span class="built_in">availableGeometry</span>(curWidgetScreenNum);</span><br><span class="line"><span class="built_in">move</span>(rect.<span class="built_in">x</span>(),rect.<span class="built_in">y</span>());</span><br><span class="line"><span class="built_in">resize</span>(rect.<span class="built_in">width</span>(), rect.<span class="built_in">height</span>());</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">const</span> QRect <span class="title">QDesktopWidget::screenGeometry</span><span class="params">(<span class="keyword">int</span> screen = <span class="number">-1</span>)</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"><span class="comment">//其中的参数就是显示器的id，默认是-1，如果是多个显示器，则显示器编号依次为0（主显示器）,1,2,3...，这个编号和你在设置里看到的编号没一点关系</span></span></span><br></pre></td></tr></table></figure>

<p>desktop-&gt;screenGeometry(1)会把任务栏也算上，如果不想要任务栏的rect，可以使用availableGeometry函数</p>
<p>在没创建widget的时候就想要获取一个分辨率信息用于初始化或者别的作用，可以通过 int curMonitor = desktop-&gt;primaryScreen(); 初始化显示器编号为主显示器的编号并由此获取主显示器的相关信息。curMonitor初始化为-1的时候获取到的也始终是主显示器的大小。</p>
<h1 id="QPainter旋转"><a href="#QPainter旋转" class="headerlink" title="QPainter旋转"></a>QPainter旋转</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 以pt1为基准,坐标原点在左下角（m_lastX，m_lastY，m_curX，m_curY坐标原点在左上角）</span></span><br><span class="line"><span class="function">QPointF <span class="title">c</span><span class="params">(m_lastX, <span class="keyword">this</span>-&gt;height()-m_lastY)</span></span>;<span class="comment">//交点</span></span><br><span class="line"><span class="function">QPointF <span class="title">pt1</span><span class="params">(m_lastX, <span class="keyword">this</span>-&gt;height()-m_lastY+<span class="number">10</span>)</span></span>;<span class="comment">//基准轴某一点</span></span><br><span class="line"><span class="function">QPointF <span class="title">pt2</span><span class="params">(m_curX, <span class="keyword">this</span>-&gt;height()-m_curY)</span></span>;<span class="comment">//目标点</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//重新计算角度和距离</span></span><br><span class="line"><span class="keyword">float</span> theta = <span class="built_in">getAngelOfTwoVector</span>(pt1,pt2,c);</span><br><span class="line"><span class="comment">//设定旋转中心点，把（0,0）点设置在(m_curX,m_curY)</span></span><br><span class="line">painter.<span class="built_in">translate</span>(m_curX,m_curY);</span><br><span class="line"><span class="comment">//旋转theta度，顺时针，正北为0度</span></span><br><span class="line">painter.<span class="built_in">rotate</span>(theta);</span><br><span class="line"><span class="comment">//绘制图标</span></span><br><span class="line">painter.<span class="built_in">drawPixmap</span>(<span class="number">-45</span>,<span class="number">-45</span>,<span class="number">90</span>,<span class="number">90</span>, MouseArraw);</span><br><span class="line"><span class="comment">//恢复旋转中心</span></span><br><span class="line">painter.<span class="built_in">resetTransform</span>();</span><br></pre></td></tr></table></figure>

<h2 id="任务栏隐藏图标"><a href="#任务栏隐藏图标" class="headerlink" title="任务栏隐藏图标"></a>任务栏隐藏图标</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//其实很简单，只要对窗口对象，设置一个父窗口就行。</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QApplication <span class="title">a</span><span class="params">(argc, argv)</span></span>;</span><br><span class="line">    QApplication::<span class="built_in">setQuitOnLastWindowClosed</span>(<span class="literal">false</span>);</span><br><span class="line">    QWidget* parent = <span class="keyword">new</span> QWidget;</span><br><span class="line">    Demo *pDemo = <span class="keyword">new</span> <span class="built_in">Demo</span>(parent);</span><br><span class="line">    pDemo-&gt;<span class="built_in">show</span>();</span><br><span class="line">    pDemo-&gt;<span class="built_in">activateWindow</span>();</span><br><span class="line">    <span class="keyword">int</span> ret = a.<span class="built_in">exec</span>();</span><br><span class="line">    <span class="keyword">delete</span> parent;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="MQTT"><a href="#MQTT" class="headerlink" title="MQTT"></a>MQTT</h1><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/dissun/p/10505007.html">https://www.cnblogs.com/dissun/p/10505007.html</a></p>
<h2 id="mosquitto-sub"><a href="#mosquitto-sub" class="headerlink" title="mosquitto_sub"></a>mosquitto_sub</h2><p>command：订阅主题，接收到消息时打印</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mosquitto_sub [-c] [-d] [-h hostname] [-i client_id] [-I client id prefix] [-k keepalive time] [-p port number] [-q message QoS] [--quiet] [-v] [ -u username [-Ppassword] ] [ --will-topic topic [--will-payload payload] [--will-qos qos] [--will-retain] ] -t message topic ...  </span><br></pre></td></tr></table></figure>

<p>options：<br>-c, –disable-clean-session：禁止’clean session’选项，即如果客户端断开连接，这个订阅仍然保留来接收随后到的QoS为1和2的消息，当改客户端重新连接之后，它将接收到已排在队列中的消息。建议使用此选项时，客户端id选项设为–id</p>
<p>-d, –debug：开启debug选项</p>
<p>-h, –host：说明所连接到的域名，默认是localhost</p>
<p>-i, –id：客户端的ID号，如果没有指定，默认是mosquitto_pub_加上客户端的进程id，不能和–id_prefix同时使用。</p>
<p>-I, –id-prefix：指定客户端ID的前缀，与客户端的进程ID连接组成客户端的ID，不能喝–id同时使用。</p>
<p>-k, –keepalive：给代理发送PING命令（目的在于告知代理该客户端连接保持且在正常工作）的间隔时间，默认是60s</p>
<p>-p, –port：说明客户端连接到的端口，默认是1883</p>
<p>-P, –pw：指定密码用于代理认证，使用此选项时必须有有效的用户名。</p>
<p>-q, –qos：指定消息的服务质量，可以为0,1,2，默认是0.</p>
<p>–quiet：如果指定该选项，则不会有任何错误被打印，当然，这排除了无效的用户输入所引起的错误消息。</p>
<p>-t, –topic：指定订阅的消息主题，允许同时订阅到多个主题</p>
<p>-u, –username：指定用户名用于代理认证。</p>
<p>-v, –verbose：冗长地打印收到的消息。若指定该选项，打印消息时前面会打印主题名——“主题 消息内容”，否则，只打印消息内容</p>
<p>–will-payload：如果指定该选项，则万一客户端意外和代理服务器断开，则该消息将被保留在服务端并发送出去，该选项必须同时用–will-topic指定主题。</p>
<p>–will-qos：指定Will的服务质量，默认是0.必须和选项 –will-topic同时使用.</p>
<p>–will-retain：如果指定该选项，则万一客户端意外断开，已被发送的消息将被当做retained消息。必须和选项 –will-topic同时使用.</p>
<p>–will-topic：指定客户端意外断开时，Will消息发送到的主题。</p>
<h2 id="mosquitto-pub"><a href="#mosquitto-pub" class="headerlink" title="mosquitto_pub"></a>mosquitto_pub</h2><p>command：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mosquitto_pub [-d] [-h hostname] [-i client_id] [-I client id prefix] [-p port number] [-q message QoS] [--quiet] [-r] &#123; -f file | -l | -m message | -n | -s&#125; [-u username [-P password] ] [ --will-topic topic [--will-payload payload] [--will-qos qos] [--will-retain] ] -t message-topic</span><br></pre></td></tr></table></figure>

<p>options：<br>-d, –debug ：开启debug选项</p>
<p>-f, –file：把一个文件的内容做为消息的内容发送。经测试，支持txt文件，不支持doc等其他形式文件。</p>
<p>-h, –host：说明所连接到的域名，默认是localhost</p>
<p>-i, –id：客户端的ID号，如果没有指定，默认是mosquitto_pub_加上客户端的进程id，不能和–id_prefix同时使用。</p>
<p>-I, –id-prefix ：指定客户端ID的前缀，与客户端的进程ID连接组成客户端的ID，不能和–id同时使用。</p>
<p>-l, –stdin-line：从总段读取输入发送消息，一行为一条消息，空白行不会被发送。</p>
<p>-m, –message：从命令行发送一条消息，-m后面跟发送的消息内容。</p>
<p>-n, –null-message：发送一条空消息。</p>
<p>-p, –port：连接的端口号，默认是1883.</p>
<p>-P, –pw：指定密码用于代理认证，使用此选项时必须有有效的用户名。</p>
<p>-q, –qos：指定消息的服务质量，可以为0,1,2，默认是0.</p>
<p>–quiet：如果指定该选项，则不会有任何错误被打印，当然，这排除了无效的用户输入所引起的错误消息。</p>
<p>-r, –retain：如果指定该选项，该条消息将被保留做为最后一条收到的消息。下一个订阅消息者将能至少收到该条消息。</p>
<p>-s, –stdin-file：从标准输入接收传输的消息内容，所有输入做为一条消息发送。</p>
<p>-t, –topic：指定消息所发布到哪个主题。</p>
<p>-u, –username：指定用户名用于代理认证。</p>
<p>–will-payload：如果指定该选项，则万一客户端意外和代理服务器断开，则该消息将被保留在服务端并发送出去，该选项必须同时用–will-topic指定主题。</p>
<p>–will-qos：指定Will的服务质量，默认是0.必须和选项 –will-topic同时使用.</p>
<p>–will-retain：如果指定该选项，则万一客户端意外断开，已被发送的消息将被当做retained消息。必须和选项 –will-topic同时使用.</p>
<p>–will-topic：指定客户端意外断开时，Will消息发送到的主题。</p>
<h2 id="mosquito-conf-配置"><a href="#mosquito-conf-配置" class="headerlink" title="mosquito.conf 配置"></a>mosquito.conf 配置</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#设置不允许匿名登录</span><br><span class="line">allow_anonymous false</span><br><span class="line">#设置账户密码文件位置为C:\MosquittoTest\pwfile.example</span><br><span class="line">password_file C:/Program Files/mosquitto/pwfile.example</span><br><span class="line">#监听的本机IP和端口</span><br><span class="line">listener 1883 192.168.30.251</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="用户文件配置"><a href="#用户文件配置" class="headerlink" title="用户文件配置"></a>用户文件配置</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mosquitto_passwd -c /MosquittoTest/pwfile.example zwl</span><br><span class="line">（使用-c 参数会导致清空密码文件，重新插入用户，但是不使用-c在Windows下没有成功）</span><br></pre></td></tr></table></figure>

<h2 id="重启服务"><a href="#重启服务" class="headerlink" title="重启服务"></a>重启服务</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mosquitto.exe -c mosquitto.conf -v</span><br></pre></td></tr></table></figure>

<h2 id="订阅"><a href="#订阅" class="headerlink" title="订阅"></a>订阅</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mosquitto_sub.exe -h 192.168.30.251 -p 1883 -u zwl -P iscas -i test1 -v -t first</span><br><span class="line">mosquitto_sub.exe -h 192.168.30.251 -p 1883 -u zwl -P iscas -i test2 -v -t second</span><br></pre></td></tr></table></figure>

<h2 id="发布"><a href="#发布" class="headerlink" title="发布"></a>发布</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mosquitto_pub.exe -h 192.168.30.251 -p 1883 -u zwl -P iscas -t first -m hello</span><br></pre></td></tr></table></figure>

<h2 id="编译问题"><a href="#编译问题" class="headerlink" title="编译问题"></a>编译问题</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">1.</span><br><span class="line">qmqttauthenticationproperties.h:33: error: C1083: 无法打开包括文件: “QtMqtt/qmqttglobal.h”: No such file or directory</span><br><span class="line">打开 qmqttauthenticationproperties.h 文件，发现有这么两句：</span><br><span class="line">#include &lt;QtMqtt/qmqttglobal.h&gt;</span><br><span class="line">#include &lt;QtMqtt/qmqtttype.h&gt;</span><br><span class="line">在 Qt 的 include 目录下新建一个 QtMqtt 文件夹（注意 x86 和 x64 所在的目录不一样），把 头文件都复制一份到这个目录。</span><br><span class="line">再编译就不报这个错误了。</span><br><span class="line">2.</span><br><span class="line">下一个错误是：qmqttconnection.cpp:169: error: C2039: “errorOccurred”: 不是“QAbstractSocket”的成员</span><br><span class="line">qmqttconnection.cpp 中 168行有这么一句：</span><br><span class="line">connect(socket, &amp;QAbstractSocket::errorOccurred, this, &amp;QMqttConnection::transportError);</span><br><span class="line">就是这句出了问题。查帮助文档或者源代码都可以发现 QAbstractSocket 没有 errorOccurred 这个 信号。有的那个信号叫：</span><br><span class="line">void error(QAbstractSocket::SocketError socketError)</span><br><span class="line">所以要改写成：</span><br><span class="line">connect(socket, static_cast&lt;void(QAbstractSocket::*)(QAbstractSocket::SocketError)&gt; (&amp;QAbstractSocket::error), </span><br><span class="line">            this, static_cast&lt;void(QMqttConnection::*)(QAbstractSocket::SocketError)&gt;(&amp;QMqttConnection::transportError) );</span><br><span class="line">3.</span><br><span class="line">再次编译。还有错误：</span><br><span class="line">qmqtttopicname.cpp:148: error: C2039: “KeepEmptyParts”: 不是“Qt”的成员</span><br><span class="line">qmqtttopicname.cpp 148 行代码是这样的：</span><br><span class="line">return d-&gt;name.split(QLatin1Char(&#x27;/&#x27;), Qt::KeepEmptyParts);</span><br><span class="line">改写成：</span><br><span class="line">return d-&gt;name.split(QLatin1Char(&#x27;/&#x27;), QString::KeepEmptyParts);</span><br><span class="line">4.</span><br><span class="line">再次编译，还有最后一个错误：</span><br><span class="line">qmqtttopicname.cpp:189: error: call to &#x27;qHash&#x27; is ambiguous</span><br><span class="line">qmqtttopicname.cpp 189行是：</span><br><span class="line">return qHash(name.d-&gt;name, seed);</span><br><span class="line">改为：</span><br><span class="line">return qHash(static_cast&lt;QString&gt;(name.d-&gt;name), static_cast&lt;uint&gt;(seed));</span><br><span class="line">5.</span><br><span class="line">类似的还有：</span><br><span class="line">return qHash(filter.d-&gt;filter, seed);</span><br><span class="line">改为：</span><br><span class="line">return qHash(static_cast&lt;QString&gt;(filter.d-&gt;filter), static_cast&lt;uint&gt;(seed));</span><br><span class="line"></span><br><span class="line">6.</span><br><span class="line">QList .resize()的问题</span><br><span class="line">	m_receiveAliases.resize(m_clientPrivate-&gt;m_serverConnectionProperties.maximumTopicAlias());</span><br><span class="line">	m_publishAliases.resize(m_clientPrivate-&gt;m_connectionProperties.maximumTopicAlias());</span><br><span class="line">QList 没有resize()函数</span><br><span class="line">转到m_publishAliases定义处：</span><br><span class="line">    QList&lt;QMqttTopicName&gt; m_receiveAliases;</span><br><span class="line">    QList&lt;QMqttTopicName&gt; m_publishAliases;</span><br><span class="line">改成：</span><br><span class="line"></span><br><span class="line">	QVector&lt;QMqttTopicName&gt; m_receiveAliases;</span><br><span class="line">    QVector&lt;QMqttTopicName&gt; m_publishAliases;</span><br><span class="line"></span><br><span class="line">7.</span><br><span class="line">error: ‘QStringView’ was not declared in this scope</span><br><span class="line">	QStringView root = QStringView&#123;d-&gt;filter&#125;.left(d-&gt;filter.size() - 1);</span><br><span class="line">改成：</span><br><span class="line"></span><br><span class="line">	QString root = QString&#123;d-&gt;filter&#125;.left(d-&gt;filter.size() - 1);</span><br><span class="line">没用过QStringView 也没见过，但通过函数功能看，类似QString，替换后还真可以了</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="Ubuntu下，Qt-调用bash执行python脚本"><a href="#Ubuntu下，Qt-调用bash执行python脚本" class="headerlink" title="Ubuntu下，Qt 调用bash执行python脚本"></a>Ubuntu下，Qt 调用bash执行python脚本</h1><p>调用方式</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span>  CondaInitialize    <span class="meta-string">&quot;__conda_setup=\&quot;$(&#x27;/home/iscas/anaconda3/bin/conda&#x27; &#x27;shell.bash&#x27; &#x27;hook&#x27; 2&gt; /dev/null)\&quot;\n&quot;</span> \</span></span><br><span class="line"><span class="meta">                            <span class="meta-string">&quot;if [ $? -eq 0 ]; then \n&quot;</span>      \</span></span><br><span class="line"><span class="meta">                            <span class="meta-string">&quot;    eval \&quot;$__conda_setup\&quot; \n&quot;</span>\</span></span><br><span class="line"><span class="meta">                            <span class="meta-string">&quot;else \n                        &quot;</span>\</span></span><br><span class="line"><span class="meta">                            <span class="meta-string">&quot;    if [ -f \&quot;/home/iscas/anaconda3/etc/profile.d/conda.sh\&quot; ]; then \n&quot;</span>   \</span></span><br><span class="line"><span class="meta">                            <span class="meta-string">&quot;        . \&quot;/home/iscas/anaconda3/etc/profile.d/conda.sh\&quot; \n&quot;</span>             \</span></span><br><span class="line"><span class="meta">                            <span class="meta-string">&quot;    else \n&quot;</span>   \</span></span><br><span class="line"><span class="meta">                            <span class="meta-string">&quot;        export PATH=\&quot;/home/iscas/anaconda3/bin:$PATH\&quot; \n&quot;</span>                \</span></span><br><span class="line"><span class="meta">                            <span class="meta-string">&quot;    fi \n&quot;</span>     \</span></span><br><span class="line"><span class="meta">                            <span class="meta-string">&quot;fi \n&quot;</span>         \</span></span><br><span class="line"><span class="meta">                            <span class="meta-string">&quot;unset __conda_setup \n&quot;</span>    \</span></span><br><span class="line"><span class="meta">                            </span></span><br><span class="line">OneAlgorithmForm *temp1=<span class="keyword">new</span> <span class="built_in">OneAlgorithmForm</span>(<span class="string">&quot;Video&quot;</span>,<span class="string">&quot;/home/iscas/video_yolov5/&quot;</span>,</span><br><span class="line">                                                 <span class="string">&quot;cd /home/iscas/video_yolov5/ \n&quot;</span></span><br><span class="line">                                                 CondaInitialize</span><br><span class="line">                                                 <span class="string">&quot;conda activate yolov5 \n&quot;</span></span><br><span class="line">                                                 <span class="string">&quot;python detect_202_hikvision.py --VideoPosition 右侧 --source_v udp://192.168.30.61:15843 --source_inf udp://192.168.30.61:15844 --local_port 5679 --out_port 43902 \n&quot;</span></span><br><span class="line">                                                 );</span><br></pre></td></tr></table></figure>

<p>需要注意，这种方式下，需要python文件的输出不能有缓冲，否则，只有当bash全部输出之后才会响应readyReadStandardOutput信号，python不缓冲输出可以在print后接一句sys.stdout.flush()</p>
<p>.h</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> ONEALGORITHMFORM_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ONEALGORITHMFORM_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QProcess&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QWidget&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Ui &#123;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OneAlgorithmForm</span>;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OneAlgorithmForm</span> :</span> <span class="keyword">public</span> QWidget</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">OneAlgorithmForm</span><span class="params">(QString name,QString path,QString parm,QWidget *parent = <span class="literal">nullptr</span>)</span></span>;</span><br><span class="line">    ~<span class="built_in">OneAlgorithmForm</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> slots:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">on_readoutput</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">on_readerror</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">on_pushButton_clicked</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::OneAlgorithmForm *ui;</span><br><span class="line">    QString m_name;</span><br><span class="line">    QString m_path;</span><br><span class="line">    QString m_parm;</span><br><span class="line">    QProcess* process=<span class="literal">NULL</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// ONEALGORITHMFORM_H</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>.cpp</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;OneAlgorithmForm.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;ui_OneAlgorithmForm.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QDebug&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QMessageBox&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QProcess&gt;</span></span></span><br><span class="line"></span><br><span class="line">OneAlgorithmForm::<span class="built_in">OneAlgorithmForm</span>(QString name,QString path,QString parm,QWidget *parent) :</span><br><span class="line">    <span class="built_in">QWidget</span>(parent),</span><br><span class="line">    <span class="built_in">ui</span>(<span class="keyword">new</span> Ui::OneAlgorithmForm)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line">    m_name=name;</span><br><span class="line">    m_path=path;</span><br><span class="line">    m_parm=parm;</span><br><span class="line"></span><br><span class="line">    ui-&gt;groupBox-&gt;<span class="built_in">setTitle</span>(m_name);</span><br><span class="line">    ui-&gt;label-&gt;<span class="built_in">setText</span>(m_path);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">OneAlgorithmForm::~<span class="built_in">OneAlgorithmForm</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">OneAlgorithmForm::on_pushButton_clicked</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(process==<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        process = <span class="keyword">new</span> <span class="built_in">QProcess</span>(<span class="keyword">this</span>);<span class="comment">//创建进程对象</span></span><br><span class="line">        <span class="built_in">connect</span>(process , <span class="built_in">SIGNAL</span>(<span class="built_in">readyReadStandardOutput</span>()) , <span class="keyword">this</span> , <span class="built_in">SLOT</span>(<span class="built_in">on_readoutput</span>()));</span><br><span class="line">        <span class="built_in">connect</span>(process , <span class="built_in">SIGNAL</span>(<span class="built_in">readyReadStandardError</span>()) , <span class="keyword">this</span> , <span class="built_in">SLOT</span>(<span class="built_in">on_readerror</span>()));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(ui-&gt;pushButton-&gt;<span class="built_in">text</span>()==<span class="string">&quot;run&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        ui-&gt;pushButton-&gt;<span class="built_in">setText</span>(<span class="string">&quot;stop&quot;</span>);</span><br><span class="line">        process-&gt;<span class="built_in">start</span>(<span class="string">&quot;bash&quot;</span>); <span class="comment">//启动终端(Windows下改为cmd)</span></span><br><span class="line">        process-&gt;<span class="built_in">waitForStarted</span>(); <span class="comment">//等待启动完成</span></span><br><span class="line">        process-&gt;<span class="built_in">write</span>(m_parm.<span class="built_in">toUtf8</span>()); <span class="comment">//向终端写入“ls”命令，注意尾部的“\n”不可省略</span></span><br><span class="line"></span><br><span class="line">        ui-&gt;plainTextEdit-&gt;<span class="built_in">appendPlainText</span>(<span class="string">&quot;start bash with :&quot;</span> + m_parm);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(ui-&gt;pushButton-&gt;<span class="built_in">text</span>()==<span class="string">&quot;stop&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        ui-&gt;pushButton-&gt;<span class="built_in">setText</span>(<span class="string">&quot;run&quot;</span>);</span><br><span class="line">        process-&gt;<span class="built_in">close</span>();</span><br><span class="line">        process-&gt;<span class="built_in">kill</span>();</span><br><span class="line">        process-&gt;<span class="built_in">waitForFinished</span>();</span><br><span class="line">        ui-&gt;plainTextEdit-&gt;<span class="built_in">appendPlainText</span>(<span class="string">&quot;stop bash with :&quot;</span> + m_parm);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">OneAlgorithmForm::on_readoutput</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(ui-&gt;plainTextEdit-&gt;<span class="built_in">blockCount</span>()&gt;<span class="number">1000</span>)</span><br><span class="line">        ui-&gt;plainTextEdit-&gt;<span class="built_in">clear</span>();</span><br><span class="line"></span><br><span class="line">    ui-&gt;plainTextEdit-&gt;<span class="built_in">appendPlainText</span>(QString::<span class="built_in">fromUtf8</span>(process-&gt;<span class="built_in">readAllStandardOutput</span>().<span class="built_in">data</span>())); <span class="comment">//将输出信息读取到编辑框</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">OneAlgorithmForm::on_readerror</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QMessageBox::<span class="built_in">information</span>(<span class="number">0</span>, <span class="string">&quot;Error&quot;</span>, process-&gt;<span class="built_in">readAllStandardError</span>().<span class="built_in">data</span>()); <span class="comment">//弹出信息框提示错误信息</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="Qt-发送图片"><a href="#Qt-发送图片" class="headerlink" title="Qt 发送图片"></a>Qt 发送图片</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">QByteArray ba;</span><br><span class="line"><span class="function">QBuffer <span class="title">buffer</span><span class="params">(&amp;ba)</span></span>;</span><br><span class="line">buffer.<span class="built_in">open</span>(QIODevice::WriteOnly);</span><br><span class="line">vedioimg.<span class="built_in">save</span>(&amp;buffer, <span class="string">&quot;PNG&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=ba.<span class="built_in">size</span>()/<span class="number">40000</span>;i++)&#123;</span><br><span class="line">    <span class="keyword">if</span>(ba.<span class="built_in">size</span>()-i*<span class="number">40000</span>&lt;<span class="number">40000</span>)&#123;</span><br><span class="line">        m_udp2-&gt;<span class="built_in">sendMsg</span>(ba.<span class="built_in">right</span>(ba.<span class="built_in">size</span>()-i*<span class="number">40000</span>));</span><br><span class="line">        <span class="keyword">this</span>-&gt;<span class="built_in">thread</span>()-&gt;<span class="built_in">msleep</span>(<span class="number">10</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    m_udp2-&gt;<span class="built_in">sendMsg</span>(ba.<span class="built_in">mid</span>(i*<span class="number">40000</span>,<span class="number">40000</span>));</span><br><span class="line">    <span class="keyword">this</span>-&gt;<span class="built_in">thread</span>()-&gt;<span class="built_in">msleep</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="QTableWidget"><a href="#QTableWidget" class="headerlink" title="QTableWidget"></a>QTableWidget</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ui-&gt;tableWidget-&gt;horizontalHeader()-&gt;setSectionResizeMode(QHeaderView::Stretch);</span><br></pre></td></tr></table></figure>

<h1 id="Qt-发邮件"><a href="#Qt-发邮件" class="headerlink" title="Qt 发邮件"></a>Qt 发邮件</h1><p> <a href="example.zip">example.zip</a> </p>
<p> <a href="%E8%AF%B4%E6%98%8E.txt">说明.txt</a> </p>
<p><img src="/2021/06/27/Qt/image-20231201164858897.png" alt="image-20231201164858897"></p>
<p>1.开启发送邮箱的smtp服务</p>
<p>2.用户名和发件人都是1的邮箱名，密码不是邮箱密码，是smtp的授权码</p>
<p>3.注意使用的smtp服务器（<a target="_blank" rel="noopener" href="https://blog.51cto.com/u_12528551/5900477%E3%80%81https://www.kkidc.com/about/detail/hcid/196/id/2000/%EF%BC%89">https://blog.51cto.com/u_12528551/5900477、https://www.kkidc.com/about/detail/hcid/196/id/2000/）</a></p>
<h2 id="附-常用邮箱SMTP服务器地址大全"><a href="#附-常用邮箱SMTP服务器地址大全" class="headerlink" title="附:常用邮箱SMTP服务器地址大全"></a>附:常用邮箱SMTP服务器地址大全</h2><p>　1. Gmail</p>
<p>　　POP服务器地址: pop.gmail.com</p>
<p>　　SMTP服务器地址: smtp.gmail.com</p>
<p>　　2. Outlook</p>
<p>　　POP服务器地址: outlook.office365.com</p>
<p>　　SMTP服务器地址: smtp.office365.com</p>
<p>　　3. Yahoo</p>
<p>　　POP服务器地址: pop.yahoo.com</p>
<p>　　SMTP服务器地址: smtp.mail.yahoo.com</p>
<p>　　4. 163邮箱</p>
<p>　　POP服务器地址: pop.163.com</p>
<p>　　SMTP服务器地址: smtp.163.com</p>
<p>　　5. QQ邮箱</p>
<p>　　POP服务器地址: pop.qq.com</p>
<p>　　SMTP服务器地址: smtp.qq.com</p>
<h2 id="SMTP服务器的作用"><a href="#SMTP服务器的作用" class="headerlink" title="SMTP服务器的作用"></a>SMTP服务器的作用</h2><p>SMTP服务器是一种用于发送和接收电子邮件的服务器。SMTP是Simple Mail Transfer Protocol的缩写，它是一种用于电子邮件传输的标准协议。SMTP服务器的作用是将电子邮件从发送者的计算机发送到接收者的计算机。</p>
<p>SMTP服务器的工作原理是通过TCP/IP协议将邮件从发送者的计算机传输到接收者的计算机。当发送者发送一封电子邮件时，邮件客户端会将邮件发送到SMTP服务器。SMTP服务器会将邮件传输到接收者的SMTP服务器，然后接收者的邮件客户端会从SMTP服务器中接收邮件。</p>
<p>SMTP服务器的作用不仅仅是传输电子邮件，它还可以对邮件进行过滤和检查。SMTP服务器可以检查邮件的内容和附件，以确保邮件不包含病毒或垃圾邮件。SMTP服务器还可以对邮件进行加密，以保护邮件的安全性。</p>
<p>SMTP服务器的配置非常重要，因为它直接影响到邮件的传输速度和可靠性。如果SMTP服务器配置不正确，邮件可能会被拒绝或延迟传输。因此，SMTP服务器的配置需要根据具体的需求进行调整。</p>
<h1 id="stylesheet"><a href="#stylesheet" class="headerlink" title="stylesheet"></a>stylesheet</h1><h2 id="参考网站"><a href="#参考网站" class="headerlink" title="参考网站"></a>参考网站</h2><p>Qt 4.8 UI Design with Qt : <a target="_blank" rel="noopener" href="https://doc.qt.io/archives/qt-4.8/qt-gui-concepts.html">https://doc.qt.io/archives/qt-4.8/qt-gui-concepts.html</a>  -&gt;可以选择Qt Style Sheets查看样式表相关</p>
<p>Qt 5 stylesheet :<a target="_blank" rel="noopener" href="https://doc.qt.io/qt-5/qtmodules.html">https://doc.qt.io/qt-5/qtmodules.html</a> -》可以跳转<a target="_blank" rel="noopener" href="https://doc.qt.io/qt-5/qtwidgets-index.html">Qt Widgets</a>，然后找QStyles</p>
<p>Qt翻译的中文网站: <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_24571549/article/details/64131396">https://blog.csdn.net/qq_24571549/article/details/64131396</a></p>
<p>属性列表 : <a target="_blank" rel="noopener" href="https://blog.csdn.net/WL0616/article/details/129118087">https://blog.csdn.net/WL0616/article/details/129118087</a></p>
<p>对于不理解的地方可以参考CSS：[CSS参考手册（里面有测试）  <a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/pr_background-clip.asp">https://www.w3school.com.cn/cssref/pr_background-clip.asp</a></p>
<p><img src="/2021/06/27/Qt/image-20231212111224516.png" alt="image-20231212111224516"></p>
<p><img src="/2021/06/27/Qt/image-20231212111210217.png" alt="image-20231212111210217"></p>
<p><em>Qt的样式/颜色机制主要有两个体系，一个是用调色板(QPalette) 另一个是样式表Style Sheets。在Qt4之前 Qt的图形化组件的各种颜色(前景色、背景色、文本色、选中色、非选中色等)有不同的函数，例如setBackgroundColor函数。但在Qt4之后这些函数不在使用，而是由QPalette调色板管理，当然样式表(Style Sheets)也是可以的，在Qt4.5以后Qt样式表已经完美支持Mac系统了，所有也是个不错的选择，特别是对有CSS使用经验的人来说。</em></p>
<h2 id="打印树结构"><a href="#打印树结构" class="headerlink" title="打印树结构"></a>打印树结构</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">QCalendarWidget *calendar = ui-&gt;dateEdit-&gt;<span class="built_in">calendarWidget</span>();</span><br><span class="line"><span class="built_in">dumpStructure</span>(calendar, <span class="number">0</span>);</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CalendarWidget::dumpStructure</span><span class="params">(<span class="keyword">const</span> QObject *obj, <span class="keyword">int</span> spaceCount)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="built_in">QString</span>(<span class="string">&quot;%1 %2 : %3&quot;</span>)</span><br><span class="line">                .<span class="built_in">arg</span>(<span class="string">&quot;&quot;</span>, spaceCount)</span><br><span class="line">                .<span class="built_in">arg</span>(obj-&gt;<span class="built_in">metaObject</span>()-&gt;<span class="built_in">className</span>())</span><br><span class="line">                .<span class="built_in">arg</span>(obj-&gt;<span class="built_in">objectName</span>());</span><br><span class="line"> </span><br><span class="line">    QObjectList list = obj-&gt;<span class="built_in">children</span>();</span><br><span class="line"> </span><br><span class="line">    foreach(QObject *child, list)&#123;</span><br><span class="line">        <span class="built_in">dumpStructure</span>(child, spaceCount + <span class="number">4</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="box-model"><a href="#box-model" class="headerlink" title="box model"></a>box model</h2><p><img src="/2021/06/27/Qt/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI5OTEyMzI1,size_16,color_FFFFFF,t_70#pic_center.png" alt="img"></p>
<p>使用样式表时，每个widget都被视为包含<code>四个同心矩形的框</code>：<strong>边距矩形（margin rectangle）、边框矩形（border rectangle）、填充矩形（padding rectangle）和内容矩形（content rectangle）</strong>。<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E7%9B%92%E5%AD%90%E6%A8%A1%E5%9E%8B&spm=1001.2101.3001.7020">盒子模型</a>如上图所示：</p>
<p>边距（margin）、边框（border）宽度和填充（padding）属性都默认为零。在这种情况下，所有四个矩形(边距、边框、填充和内容)完全重合。</p>
<p>可以使用<em>background-image</em>（背景图片）属性指定<em>widget</em>的背景。默认情况下，仅为边框内的区域绘制背景图像，但是可以通过background-clip（背景剪裁）属性进行更改。可以使用<em>background-repeat</em>（背景重复）和<em>background-origin</em>（背景原点）来控制背景图像的重复和原点。</p>
<p><strong>背景图像不随widget的大小缩放。</strong>要实现随 widget 大小缩放的“皮肤”或背景，必须使用<em>border-image</em>（边框图像）。由于 border-image 属性提供了备用背景，因此在指定border-image 时不需要指定 background-image。当两者都被设置时，border-image 绘制在 background-image 上。</p>
<p>此外，图像属性可用于在 border-image 上绘制图像。当指定的图像大小与 widget 的大小不匹配时，图像不会平铺（tile）或拉伸（stretch），需要使用image-position属性指定其对齐方式。与background-image和border-image不同，您可以在 image 属性中指定SVG，在这种情况下，图像会根据 widget 的大小自动缩放。</p>
<p>Qt 的绘制的步骤如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">为整个渲染操作设置剪辑(border-radius)。</span><br><span class="line">绘制背景(background-image)。</span><br><span class="line">绘制边框(border-image，border)。</span><br><span class="line">绘制叠加图像(image)。</span><br></pre></td></tr></table></figure>

<h3 id="附-盒子模型支持的组件"><a href="#附-盒子模型支持的组件" class="headerlink" title="附 盒子模型支持的组件"></a>附 盒子模型支持的组件</h3><table>
<thead>
<tr>
<th>QCheckBox</th>
<th>支持盒子模型。检查指示器可以使用::indicator子控件样式化。默认情况下，指示器被放置在左边。spacing属性指定检查指示器和文本之间的间距。</th>
</tr>
</thead>
<tbody><tr>
<td>QColumnView</td>
<td>可以使用image属性进行样式化。箭头指示器可以使用  ::left-arrow子控件和 ::right-arrow 子控件进行样式化</td>
</tr>
<tr>
<td>QComboBox</td>
<td>combobox周围的框架可以使用box  model设置样式。下拉按钮可以使用::drop-down子控件设置样式。默认情况下，下拉按钮放置在小部件的内边距矩形的右边。下拉按钮内的箭头标记可以使用::down-arrow子控件设置样式。默认情况下，箭头放置在下拉子控件的内容矩形的中心。</td>
</tr>
<tr>
<td>QDateEdit</td>
<td>看QSpinBox</td>
</tr>
<tr>
<td>QDateTimeEdit</td>
<td>看QSpinBox</td>
</tr>
<tr>
<td>QDialog</td>
<td>QDialog继承于QWidget，看QWidget</td>
</tr>
<tr>
<td>QDialogButtonBox</td>
<td>可以使用button-layout属性更改按钮的布局。</td>
</tr>
<tr>
<td>QDockWidget</td>
<td>停靠时支持标题栏和标题栏按钮的样式化。可以使用border属性对dock小部件边框进行样式化。::title子控件可用于自定义标题栏。关闭和浮动按钮分别使用::close按钮和::float按钮相对于::title子控件进行定位。当标题栏垂直时，设置:vertical伪类。另外，根据QDockWidget::DockWidgetFeature，设置了:closable，:floatable和:movable伪状态。</td>
</tr>
<tr>
<td>QDoubleSpinBox</td>
<td>看QSpinBox</td>
</tr>
<tr>
<td>QFrame</td>
<td>支持box  model。从4.3开始，在QLabel上设置样式表会自动将QFrame:: framstyle属性设置为QFrame::StyledPanel。</td>
</tr>
<tr>
<td>QGroupBox</td>
<td>支持box  model。标题可以使用::title子控件设置样式。默认情况下，标题的放置取决于QGroupBox::textAlignment。在可选QGroupBox的情况下，标题包括检查指示器。指示器使用::indicator子控件设置样式。spacing属性可以用来控制文本和指示符之间的间距。</td>
</tr>
<tr>
<td>QHeaderView</td>
<td>支持box  model。头视图的部分使用::section子控件进行样式化。子控件部分支持:middle、:first、:last、:only-one、:next-selected、:previous-selected、:selected和:checked伪状态。排序指示器可以使用::up-arrow和  ::down-arrow 子控件进行样式化。</td>
</tr>
<tr>
<td>QLabel</td>
<td>支持box  model。不支持:hover伪状态。从4.3开始，在QLabel上设置样式表会自动将QFrame::  framstyle属性设置为QFrame::StyledPanel。</td>
</tr>
<tr>
<td>QLineEdit</td>
<td>支持box  model。选中项的颜色和背景分别使用selection-color和selection-background-color设置样式。可以使用lineedit-password-character属性设置密码字符的样式。可以使用lineedit-password-mask-delay更改密码掩码延迟。</td>
</tr>
<tr>
<td>QListView</td>
<td>支持box  model。启用交替行颜色后，可以使用属性alternative  -background-color设置交替行颜色的样式。选中项的颜色和背景分别使用selection-color和selection-background-color设置样式。选择行为由show-decoration-selected属性控制。使用::item子控件对QListView中的项进行更细的控制。</td>
</tr>
<tr>
<td>QListWidget</td>
<td>看QListView</td>
</tr>
<tr>
<td>QMainWindow</td>
<td>支持分隔符的样式化。使用QDockWidget时，QMainWindow中的分隔符使用::separator子控件进行样式化。</td>
</tr>
<tr>
<td>QMenu</td>
<td>单个项目使用::item子控件设置样式。除了通常支持的伪状态外，item子控件还支持:selected、:default、:exclusive和  :non-exclusive伪状态。可选菜单项的指示符使用::indicator子控件设置样式。分隔符使用::separator子控件设置样式。对于子菜单项，箭头标记使用::right-arrow  和::left-arrow设置样式。使用::scroller对滚动条进行样式化。撕裂式使用::tearoff。</td>
</tr>
<tr>
<td>QMenuBar</td>
<td>spacing属性指定菜单项之间的间距。使用::item子控件对单个项进行样式化。</td>
</tr>
<tr>
<td>QMessageBox</td>
<td>message -  box-text-interaction-flags属性可用于更改与消息框中的文本的交互。</td>
</tr>
<tr>
<td>QProgressBar</td>
<td>进度条的块可以使用::chunk子控件设置样式。该块显示在小部件的内容矩形上。如果进度条显示文本，请使用text-align属性来定位文本。不确定进度条有:Indeterminate伪状态设置。</td>
</tr>
<tr>
<td>QPushButton</td>
<td>支持:default、:flat、:checked伪状态。从5.15开始，icon属性可以被设置为覆盖按钮图标。对于带有菜单的QPushButton，菜单指示器使用::menu-indicator子控件样式化。可检查按钮的外观可以使用:open和:closed伪状态定制。警告：如果你只在一个QPushButton上设置了背景色，背景可能不会出现，除非你设置了border属性为某个值。这是因为，在默认情况下，QPushButton绘制了一个与背景色完全重叠的本机边框。例如：</td>
</tr>
<tr>
<td>QRadioButton</td>
<td>检查指示器可以使用::indicator子控件样式化。默认情况下，指示器被放置在小部件Contents矩形的左上角。spacing属性指定检查指示器和文本之间的间距。</td>
</tr>
<tr>
<td>QScrollBar</td>
<td>窗口组件的内容矩形被认为是滑块移动的槽。QScrollBar的范围(即宽度或高度，取决于方向)分别使用width或height属性设置。要确定方向，可以使用:horizontal和:vertical伪状态。可以使用::handle子控件设置滑块的样式。设置min-width或min-height可以根据方向为滑块提供尺寸约束。      ::add-line子控件可用于设置按钮的样式以添加行。默认情况下，add-line子控件放置在小部件边框矩形的右上角，取决于::right-arrow  或 ::down-arrow. 。默认情况下，箭头放置在添加行子控件的Contents矩形的中心。     :: subline子控件可用于设置按钮的样式以减去一行。默认情况下，subline子控件放置在小部件边框矩形的右下角，取决于::left-arrow  或 ::up-arrow。默认情况下，箭头放置在子行子控件的Contents矩形的中心。::  subpage子控件可用于设置滑块减去页面的区域的样式。::add-page子控件可用于设置添加页面的滑块区域的样式。</td>
</tr>
<tr>
<td>QSizeGrip</td>
<td>支持 width、height和image 属性。</td>
</tr>
<tr>
<td>QSlider</td>
<td>对于水平滑动，必须提供 min-width和  height属性。对于垂直滑块，必须提供min-height和width属性。滑块的凹槽采用::groove样式。默认情况下，凹槽位于小部件的内容矩形中。滑块的头部使用::handle子控件设置样式。子控件在槽子控件的内容矩形中移动。</td>
</tr>
<tr>
<td>QSpinBox</td>
<td>向上按钮和箭头可以使用::up-button和::up-arrow子控件设置样式。默认情况下，向上按钮放置在小部件的内边距矩形的右上角。如果没有明确的尺寸，它将占据其参考矩形高度的一半。向上箭头放置在向上按钮的内容矩形的中心。可以使用::down-button和::down-arrow子控件为down按钮和箭头设置样式。默认情况下，down按钮放置在小部件的内边距矩形的右下角。如果没有明确的尺寸，它将占据其参考矩形高度的一半。底部箭头放置在底部按钮的内容矩形的中心。</td>
</tr>
<tr>
<td>QSplitter</td>
<td>分割器的句柄使用::handle子控件进行样式化</td>
</tr>
<tr>
<td>QStatusBar</td>
<td>只支持background属性。可以使用::item子控件对单个项的框架进行样式化。</td>
</tr>
<tr>
<td>QTabBar</td>
<td>单个选项卡可以使用::tab子控件设置样式。选项卡支持:only-one、:first、:last、:middle、:previous–selected、:next-selected、:selected等伪状态。:top、:left、:right、:bottom伪状态取决于选项卡的方向。选择状态的重叠制表符可以使用负边距或绝对位置模式创建。QTabBar的撕裂指示器使用::tear子控件进行样式设置。QTabBar为它的滚动条使用了两个QToolButton，可以使用QTabBar  QToolButton选择器设置样式。要指定滚动按钮的宽度，可以使用::scroller子控件。QTabBar中选项卡的对齐方式使用alignment属性设置样式。要更改QTabBar在QTabWidget中的位置，请使用tab-bar子控件(并设置subcontrol-position)。</td>
</tr>
<tr>
<td>QTabWidget</td>
<td>选项卡部件的框架使用::pane子控件设置样式。左角和右角分别使用::left-corner和::right-corner设置样式。tab  bar的位置由::tab-bar子控件控制。默认情况下，子控件具有QTabWidget在QWindowsStyle中的位置。要将QTabBar放在中间，请设置tab-bar子控件的subcontrol-position。:top、:left、:right、:bottom伪状态取决于选项卡的方向。.</td>
</tr>
<tr>
<td>QTableView</td>
<td>启用交替行颜色后，可以使用属性alternative-background-color设置交替行颜色的样式。选中项的颜色和背景分别使用selection-color和selection-background-color设置样式。QTableView中的拐角部件是作为QAbstractButton实现的，可以使用“QTableView  QTableCornerButton::section”选择器设置样式。     警告：如果你只在QTableCornerButton上设置了背景色，背景可能不会出现，除非你设置border属性为某个值。这是因为，在默认情况下，QTableCornerButton绘制了一个完全重叠背景色的本机边框。网格的颜色可以使用gridline-color属性指定。</td>
</tr>
</tbody></table>
<h2 id="Palette"><a href="#Palette" class="headerlink" title="Palette"></a>Palette</h2><p><strong>没有继承关系</strong>！！！</p>
<p>调色板顾名思义就是设置好颜色在要求的地方进行填充。调色板有两个最重要的函数：setBrush 和 setColor</p>
<h3 id="1-1-setBrush"><a href="#1-1-setBrush" class="headerlink" title="1.1 setBrush"></a>1.1 setBrush</h3><p>void QPalette::setBrush ( ColorGroup group, ColorRole role, const QBrush &amp; brush );</p>
<p>setBrush 即为画刷，就是设置好刷墙的刷子，它要设置三个问题：1.什么时候刷，2.在哪刷，3.刷成什么样？</p>
<h4 id="1-1-1-什么时候刷QPalette-ColorGroup"><a href="#1-1-1-什么时候刷QPalette-ColorGroup" class="headerlink" title="1.1.1 什么时候刷QPalette::ColorGroup"></a>1.1.1 什么时候刷QPalette::ColorGroup</h4><p>QPalette::Disabled<br>QPalette::Active<br>QPalette::Inactive<br>QPalette::NormalActive<br>大部分情况下QPalette::Active就可以。</p>
<h4 id="1-1-2-在哪刷QPalette-ColorRole"><a href="#1-1-2-在哪刷QPalette-ColorRole" class="headerlink" title="1.1.2 在哪刷QPalette::ColorRole"></a>1.1.2 在哪刷QPalette::ColorRole</h4><p>这个是最重要的参数，就是决定是刷背景色还是前景色，还是文本色等等，Assistant中有详细介绍，下面略作说明：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">QPalette::Window   通常指窗口部件的背景色;   </span><br><span class="line">QPalette::Background</span><br><span class="line">QPalette::WindowText   通常指窗口不见的前景色;</span><br><span class="line">QPalette::Foreground</span><br><span class="line">QPalette::Base         指文本输入窗口部件(比如QTxtEdit,QLinedit等)的背景色.</span><br><span class="line">QPalette::AlternateBase</span><br><span class="line">QPalette::ToolTipBase</span><br><span class="line">QPalette::ToolTipText</span><br><span class="line">QPalette::Text        与QPalette::Base一块使用,指文本输入窗口部件的前景色;</span><br><span class="line">QPalette::Button  指按钮窗口部件的背景色;</span><br><span class="line">QPalette::ButtonText  指按钮窗口部件的前景色.</span><br><span class="line">QPalette::BrightText </span><br></pre></td></tr></table></figure>



<h4 id="1-1-3-刷成什么样QBrush"><a href="#1-1-3-刷成什么样QBrush" class="headerlink" title="1.1.3 刷成什么样QBrush"></a>1.1.3 刷成什么样QBrush</h4><p>画刷QBrush 也是个功能强大的东东，鉴于你可能不怎么使用，你只知道能设置颜色就行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//注意要先调用setAutoFillBackground</span><br><span class="line">textEdit-&gt;setAutoFillBackground(true);</span><br><span class="line">QPalette palette;</span><br><span class="line">//设置QTextEdit文字颜色</span><br><span class="line">palette.setBrush(QPalette::Active, QPalette::Text, QBrush(Qt::yellow));</span><br><span class="line">//设置QTextEdit背景色</span><br><span class="line">palette.setBrush(QPalette::Active, QPalette::Base, QBrush(Qt::red));</span><br><span class="line">textEdit-&gt;setPalette(palette);</span><br></pre></td></tr></table></figure>

<h3 id="1-2-setColor"><a href="#1-2-setColor" class="headerlink" title="1.2 setColor"></a>1.2 setColor</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void  QPalette::setColor ( ColorGroup group, ColorRole role, const QColor &amp; color );</span><br></pre></td></tr></table></figure>


<p>虽然setColor参数和setBrush差不多，只是最后一个参数更简洁，直接设置好颜色就行。</p>
<p>1.3说明这就是调色板QPalette 的实现了，特别说明的一点是在QTextEdit使用是遇到了点小问题。初始化时使用了上面的那段代码，但想中途改变QTextEdit的背景色时，在调用同样方式确没有效果，多次测试没找到原因（难道是bug？），所有采用了下面这种方法：样式表(Style Sheets)</p>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//调色板设置背景颜色</span></span><br><span class="line"><span class="built_in">setAutoFillBackground</span>(<span class="literal">true</span>);    <span class="comment">// 这句要加上, 否则可能显示不出背景图.</span></span><br><span class="line">QPalette pal =<span class="keyword">this</span>-&gt;<span class="built_in">palette</span>();</span><br><span class="line">pal.<span class="built_in">setBrush</span>(QPalette::Background,m_BackgroundColor);</span><br><span class="line"><span class="built_in">setPalette</span>(pal);</span><br></pre></td></tr></table></figure>

<h2 id="Style-Sheets"><a href="#Style-Sheets" class="headerlink" title="Style Sheets"></a>Style Sheets</h2><h3 id="样式规则"><a href="#样式规则" class="headerlink" title="样式规则"></a>样式规则</h3><p>  样式表由一系列的样式规则组成。一条样式规则由一个<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E9%80%89%E6%8B%A9%E5%99%A8&spm=1001.2101.3001.7020">选择器</a>和一个声明语句组成，选择器指明了哪个（或者说是哪种）部件将会受规则影响，而声明语句则指明了哪些属性会设置到这个（这些）部件.</p>
<p>举个例子：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QPushButton &#123;<span class="attribute">color</span>: red&#125;</span><br></pre></td></tr></table></figure>

<p>  在上面的样式规则中，QPushBbutton就是选择器，而{ color： red}则是声明语句。该规则指明了QPushButton和它的子类（如：MyPushButton）应该使用红色作为它们的前景色。Qt样式表通常是不区分大小写的（比如：color, Color, COLOR, 和 cOloR 都是表示同一个属性）。当然也有区分大小写的，类名、对象名、Qt属性名（与color这些属性不是一回事，后面详细解释）这几个都是需要区分大小写的。</p>
<p>  几个选择器可以指定同样的声明语句，使用(,)来隔开不同的选择器，举个例子，如下规则：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QPushButton, QLineEdit, QComboBox &#123; <span class="attribute">color</span>: red &#125;</span><br></pre></td></tr></table></figure>

<p>  与下面三个规则是等价的：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QPushButton &#123; <span class="attribute">color</span>: red &#125;</span><br><span class="line">QLineEdit &#123; <span class="attribute">color</span>: red &#125;</span><br><span class="line">QComboBox &#123; <span class="attribute">color</span>: red &#125;</span><br></pre></td></tr></table></figure>

<p>  样式规则的声明语句部分是一个属性:值对列表，由({})包闭，由分号作为分割，举个例子：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QPushButton &#123; <span class="attribute">color</span>: red; <span class="attribute">background-color</span>: white &#125;<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>  查看更多由Qt widgets提供的<a target="_blank" rel="noopener" href="http://doc.qt.io/qt-4.8/stylesheet-reference.html#list-of-properties">属性列表</a></p>
<h3 id="选择器"><a href="#选择器" class="headerlink" title="选择器"></a>选择器</h3><p>Qt样式表支持所有的<a target="_blank" rel="noopener" href="http://www.w3.org/TR/REC-CSS2/selector.html#q1">CSS2定义的选择器</a>。下表总结了几种最常用的选择器类型。</p>
<table>
<thead>
<tr>
<th><span style="display:inline-block;width: 180px"> 选择器</span></th>
<th>实例</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>通用选择器</td>
<td>*</td>
<td>匹配所有的widget</td>
</tr>
<tr>
<td>类型选择器</td>
<td>QPushButton</td>
<td>匹配所有的QPushButton实例和继承于它的子类</td>
</tr>
<tr>
<td>属性选择器</td>
<td>QPushButton[flat=”false”]</td>
<td>匹配所有非flat的QPushButton(通常情况下，使用Q_PROPERTY宏来声明你的属性，比如此例中的flat),并且要注意，你的属性类型要受  QVariant::toString()支持(查看toString()方法的帮助文档以获取更详细的解释).  这个选择器类型也可以用来判断动态属性，要了解更多使用自定义动态属性的细节，请参考使用自定义动态属性 。  除了使用=，你还可以使用~=来判断一个QStringList中是否包含给定的QString。  警告：如果在设置了样式表后，相应的属性值发生了改变(如：flat变成了”true”)，则有必要重新加载样式表，一个有效的方法是，取消样式表，再重新设置一次,下面的代码是其中一种方式：  style()-&gt;unpolish(this); style()-&gt;polish(this);// force a stylesheet  recomputation</td>
</tr>
<tr>
<td>类选择器</td>
<td>.QPushButton</td>
<td>匹配所有的QPushButton实例，但不包括它的子类，与*[class~=”QPushButton”]是等价的。</td>
</tr>
<tr>
<td>ID选择器</td>
<td>QPushButton#okButton</td>
<td><a target="_blank" rel="noopener" href="http://doc.qt.io/qt-4.8/qobject.html#objectName-prop">匹配所有object name为”okButton”的QPushButton实例。</a></td>
</tr>
<tr>
<td>后裔选择器</td>
<td>QDialog QPushButton</td>
<td>匹配所有继承于QDialog(包括其所有子孙)的QPushButton实例。</td>
</tr>
<tr>
<td>子选择器</td>
<td>QDialog &gt; QPushButton</td>
<td>匹配所有直接继承与QDialog的QPushButton实例。</td>
</tr>
</tbody></table>
<h4 id="1-类型选择器"><a href="#1-类型选择器" class="headerlink" title="1 类型选择器"></a><strong>1 类型选择器</strong></h4><p>使用控件类名作为选择器</p>
<p>例如：</p>
<p>QPushButton{background-color:white;}</p>
<p>设置QPushButton及其子类的背景颜色为白色。</p>
<p>在ui中拖入一个QFrame，再拖入一个QLabel和一个QComboBox到QFrame中</p>
<p><img src="/2021/06/27/Qt/v2-68b18549ccce7d0e12ab4d5b00f4fd7d_720w.webp" alt="img"></p>
<p>选中QFrame，右键“改变样式表”，输入如下内容</p>
<p><img src="/2021/06/27/Qt/v2-dbce326bc04652cfc01004db1643cd72_720w.webp" alt="img"></p>
<p>点击ok</p>
<p><img src="/2021/06/27/Qt/v2-047c19165a139cad01c622a35f06eff8_720w.webp" alt="img"></p>
<p>因为只设置了QFrame的背景颜色，所以QFrame的背景颜色被改变，QLabel是控件树中QFrame的儿子，背景颜色也改变。</p>
<h4 id="2-通用选择器"><a href="#2-通用选择器" class="headerlink" title="2 通用选择器"></a><strong>2 通用选择器</strong></h4><p>通用选择器使用“*”，匹配所有控件。</p>
<p>*{color:blue;}</p>
<p>将刚才的样式表内容改成如下内容：</p>
<p><img src="/2021/06/27/Qt/v2-d8066825bdfd34d6715c612e491d478b_720w.webp" alt="img"></p>
<p>点击ok</p>
<p><img src="/2021/06/27/Qt/v2-d63e7a9ddf07cd58169e6dcc73507577_720w.webp" alt="img"></p>
<p>所有的控件样式都改变了。</p>
<h4 id="3-组选择器"><a href="#3-组选择器" class="headerlink" title="3 组选择器"></a><strong>3 组选择器</strong></h4><p>如果想要为多种类型的控件设置同样的样式，则可以使用组选择器，类型之间使用逗号隔开</p>
<p><img src="/2021/06/27/Qt/v2-602afbf031e44f9d75d4042b546d4258_720w.webp" alt="img"></p>
<p>点击ok</p>
<p><img src="/2021/06/27/Qt/v2-98b2e6ef4c965cd879f576044b8704c8_720w.webp" alt="img"></p>
<p>为QLabel和QComboBox设置了样式</p>
<h4 id="4-后代选择器"><a href="#4-后代选择器" class="headerlink" title="4 后代选择器"></a><strong>4 后代选择器</strong></h4><p>有时，用户希望选择器匹配控件树中另一个控件的后代(例如，“匹配由QFrame包含的QComboBox”)。祖先与后代之间用空格隔开。</p>
<p>QGroupBox QComboBox{background-color:red;}</p>
<p>QGroupBox是祖先，QComboBox是后代，QComboBox包含在QGroupBox控件中。</p>
<p>清空ui，在UI中入一个QComboBox和一个QGroupBox，再拖入一个QComboBox到QGroupBox中。</p>
<p><img src="/2021/06/27/Qt/v2-5d4ab303c8e9e30a2d623071160d936c_720w.webp" alt="img"></p>
<p>选择最外层的QWidget，改变样式表</p>
<p><img src="/2021/06/27/Qt/v2-0f8162732df1cbb6ab9b807d0b0ad9a4_720w.webp" alt="img"></p>
<p>点击ok，运行程序</p>
<p><img src="/2021/06/27/Qt/v2-79acf48f06088f845a180b70718984e5_720w.webp" alt="img"></p>
<p>设置一般的QComboBox的背景颜色为蓝色，但是被QGroupBox包含的QComboBox背景颜色设置成了橘色。因为QComboBox是QGroupBox的后代。</p>
<p>注意 后代选择器用空格隔开，组选择器是用逗号隔开。</p>
<h4 id="5-子选择器"><a href="#5-子选择器" class="headerlink" title="5 子选择器"></a><strong>5 子选择器</strong></h4><p>如果只想设置某个控件的儿子的样式，而不是其所有子孙后代，则可以使用子选择器。父亲与儿子之间用大于号“&gt;”隔开。</p>
<p>按下图拖入控件，这里的控件树排列顺序为QGroupBox是父亲，QTabWidget和QComboBox1是儿子 QComboBox2是孙子</p>
<p><img src="/2021/06/27/Qt/v2-7849ed5b2b2aed8a113789a7f5c8d896_720w.webp" alt="img"></p>
<p>选择最外层的QWidget，改变样式表为</p>
<p><img src="/2021/06/27/Qt/v2-49e8ff300f9f34d29d63c0292305ee26_720w.webp" alt="img"></p>
<p>点击ok</p>
<p><img src="/2021/06/27/Qt/v2-bfd1c49bbc666e3444bbd46f93767623_720w.webp" alt="img"></p>
<p>因为QComboBox1是QGroupBox的儿子，所以样式被改变。QComboBox2是QGroupBox的孙子，所以样式不会被改变。</p>
<p>如果去掉子选择器（&gt;）则变成了后代选择器，两个QComboBox样式都被改变，因为它们都是QGroupBox的后代。</p>
<p><img src="/2021/06/27/Qt/v2-7f0cfab1c46cb1f790616514be1a7158_720w.webp" alt="img"></p>
<p><img src="/2021/06/27/Qt/v2-06ba1bbcf47c8b56bdbb7ece814cdf8c_720w.webp" alt="img"></p>
<p>后代选择器和子选择器的区别相信大家弄清楚了吧。</p>
<h4 id="6-属性选择器"><a href="#6-属性选择器" class="headerlink" title="6 属性选择器"></a><strong>6 属性选择器</strong></h4><p>属性选择符有四种匹配方式，属性值必须是标识符或字符串:</p>
<p>属性匹配[att]</p>
<p>当控件设置“att”属性时匹配，无论该属性的值是多少。</p>
<p>完全匹配[att = val]</p>
<p>当控件的“att”属性值完全为“val”时匹配。</p>
<p>部分值匹配[att ~ = val]</p>
<p>当控件的“att”属性值是空格分隔的“单词”列表时，其中一个就是“val”时就可匹配。如果使用此选择器，则该值中的单词必须不包含空格(因为它们是由空格分隔的)。</p>
<p>[att | = val]</p>
<p>当控件的“att”属性值是一个连字符(“-”)分隔的“单词”列表时，以“val”开头。匹配总是从属性值的开始处开始。</p>
<p>清空ui，拖入如下控件，其中第二行的QPushButton的flat属性设置为true（使用属性编辑器设置）</p>
<p><img src="/2021/06/27/Qt/v2-76f1138abb4ae89e8d71a3bf22b2cd21_720w.webp" alt="img"></p>
<p>选择最外层的QWidget，右键改变样式表</p>
<p><img src="/2021/06/27/Qt/v2-4c1e08e52345bb192d2ae50fa25ce71d_720w.webp" alt="img"></p>
<p>点击ok</p>
<p><img src="/2021/06/27/Qt/v2-74f1d7d1e4d15da1d362dc27ddb40e2c_720w.webp" alt="img"></p>
<p>重点解释第三行控件，因为</p>
<p>第一个QLineEdit的属性值为hello，刚好和qss中的属性值相等，所以匹配。</p>
<p>第二个QLineEdit的属性值为helloworld，hello并不是单词（两边没有空格），与qss中的不相等，所以不匹配。</p>
<p>第三个QLineEdit的属性值为my hello kity，hello是一个单词（两边有空格），所以匹配。</p>
<p>再解释下第四行，凡是等于“my”或以“my-”开头的都会匹配。</p>
<h4 id="7-动态属性选择器"><a href="#7-动态属性选择器" class="headerlink" title="7 动态属性选择器"></a><strong>7 动态属性选择器</strong></h4><p>Qt中的动态属性也可以作为选择器。</p>
<p>例如，当填写一个表单时，为了向用户表明该字段是强制性的，一个有效的解决方案是使用黄色作为这些字段的背景颜色。</p>
<p>清空ui，拖入如下控件，QLineEdit分别命名为lineEdit_user, lineEdit_passwd, lineEdit_describe</p>
<p><img src="/2021/06/27/Qt/v2-e602e945409cdc408d3835173a51ac79_720w.webp" alt="img"></p>
<p>在QssSelector的构造函数中输入如下代码</p>
<p><img src="/2021/06/27/Qt/v2-066f60d101323f3478c49d3c91f1d54a_720w.webp" alt="img"></p>
<p>编译运行程序</p>
<p><img src="/2021/06/27/Qt/v2-de419743bab608bb2437421efc2eea5f_720w.webp" alt="img"></p>
<p>需要用户必须填写的内容就被设置成了黄色背景。</p>
<h4 id="8-点号类型选择器"><a href="#8-点号类型选择器" class="headerlink" title="8 点号类型选择器"></a><strong>8 点号类型选择器</strong></h4><p>点号选择器类似于属性选择器的“[att~=val]”，例如</p>
<p>.QPushButton等同于*[class~=”QPushButton”]</p>
<h4 id="9-id选择器"><a href="#9-id选择器" class="headerlink" title="9 id选择器"></a><strong>9 id选择器</strong></h4><p>如果只想为某个单一的控件设置样式，则可以使用id选择器，“#”号后面跟上这个控件的ObjectName即可。</p>
<p>QPushButton#okButton</p>
<p>再在之前的ui中拖入两个QPushButton，并修改objectName为okButton和cancelButton</p>
<p><img src="/2021/06/27/Qt/v2-976d192d9c635c17593c1be145cb24ee_720w.webp" alt="img"></p>
<p>再在构造函数中，输入如下代码：</p>
<p><img src="/2021/06/27/Qt/v2-dec10d900ba1214f94036908daeb9531_720w.webp" alt="img"></p>
<p>运行程序，指定的ok按钮变成了浅蓝色</p>
<p><img src="/2021/06/27/Qt/v2-dd487266e75cbeab86bfff2c362bcab4_720w.webp" alt="img"></p>
<h3 id="Sub-Controls"><a href="#Sub-Controls" class="headerlink" title="Sub-Controls"></a>Sub-Controls</h3><p>  为了样式化你的复杂widget，很有必要使用widget的subcontrol，比如QComboBox的drop-down 部分或者是QSpinBox的上和下箭头。选择器也许会包含subcontrols用于限制widget的subcontrols，举个例子：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QComboBox::drop-down &#123; image: <span class="built_in">url</span>(<span class="string">dropdown.png</span>) &#125;</span><br></pre></td></tr></table></figure>

<p>  上述规则样式化所有QComboBox的drop-down部分，虽然双冒号(::)让人联想到CSS3的伪元素语法，但是Qt的 Sub-Controls 跟它是不一样的。</p>
<p>  Sub-Controls始终相对于另一个元素来定位–一个参考元素。这个参考元素可以是一个Widget又或者是另一个Sub-Control。举个例子，QComboBox的<a target="_blank" rel="noopener" href="http://doc.qt.io/qt-4.8/stylesheet-reference.html#drop-down-sub">::drop-down</a>默认被放置于QComboBox的Padding rectangle(<a target="_blank" rel="noopener" href="http://doc.qt.io/qt-4.8/stylesheet-customizing.html#the-box-model">盒子模型</a>)的右上角。::drop-down默认会被放置于另一个::drop-down Sub-Control的中心。查看<a target="_blank" rel="noopener" href="http://doc.qt.io/qt-4.8/stylesheet-reference.html#list-of-stylable-widgets">可样式化的Widget列表</a>以了解更多使用Sub-Control来样式化Widget和初始化其位置的内容。</p>
<p>  源rectangle可以使用<a target="_blank" rel="noopener" href="http://doc.qt.io/qt-4.8/stylesheet-reference.html#subcontrol-origin-prop">subcontrol-origin</a>来改变。举个例子，如果我们想要把drop-down放置于QComboBox的margin rectangle而不是默认的Padding rectangle，我们可以像下面这样指定：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">QComboBox &#123;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line">QComboBox::drop-down &#123;</span><br><span class="line">    subcontrol-origin: margin;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  drop-down在Margin rectangle内的排列方式可以由<a target="_blank" rel="noopener" href="http://doc.qt.io/qt-4.8/stylesheet-reference.html#subcontrol-position-prop">subcontrol-position</a>来改变.<br>  <a target="_blank" rel="noopener" href="http://doc.qt.io/qt-4.8/stylesheet-reference.html#width-prop">width</a>和<a target="_blank" rel="noopener" href="http://doc.qt.io/qt-4.8/stylesheet-reference.html#height-prop">height</a>属性可以用来控制Sub-control的size.需要注意的是，设置了<a target="_blank" rel="noopener" href="http://doc.qt.io/qt-4.8/stylesheet-reference.html#image-prop">image</a>就隐式的设置了Sub-control的size了。</p>
<p>  相对定位方案（position:relative）,允许Sub-Control的位置从它的初始化位置作出偏移。举个例子，当QComboBox的drop-down按钮被pressed时，我们也许想要那个箭头作出位移以显示一种“pressed”的效果，为了达到目标，我们可以像下面那样指定：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">QComboBox::down-arrow &#123;</span><br><span class="line">    image: <span class="built_in">url</span>(<span class="string">down_arrow.png</span>);</span><br><span class="line">&#125;</span><br><span class="line">QComboBox::down-arrow:pressed &#123;</span><br><span class="line">    position: relative;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">1px</span>; <span class="attribute">left</span>: <span class="number">1px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  绝对定位方案(position : absolute)，使得Sub-control的position和size基于其参考元素而改变。</p>
<p>  一旦定位，它们将会与widget同等对待并且可以使用<a target="_blank" rel="noopener" href="http://doc.qt.io/qt-4.8/stylesheet-customizing.html#box-model">盒子模型</a>来样式化。</p>
<p>  查看<a target="_blank" rel="noopener" href="http://doc.qt.io/qt-4.8/stylesheet-reference.html#list-of-sub-controls">Sub-Control列表</a>以了解那些sub-control是被支持的，并且可以查看<a target="_blank" rel="noopener" href="http://doc.qt.io/qt-4.8/stylesheet-examples.html#customizing-the-qpushbutton-s-menu-indicator-sub-control">自定义QPushButton的菜单指示器Sub-Control</a>来了解一个实际的使用例子。</p>
<p>  注意：像QComboBox和QScrollBar这样的复杂部件，如果sub-control的一项属性是自定义的，那么其他所有的属性跟sub-control也都应该自定义。</p>
<h4 id="附-子控件列表"><a href="#附-子控件列表" class="headerlink" title="附  子控件列表"></a>附  子控件列表</h4><p>子控件是双冒号”::”<code> 对于一些复杂的部件修改样式，可能需要访问它们的子部件，如[QComboBox](https://so.csdn.net/so/search?q=QComboBox&amp;spm=1001.2101.3001.7020)的下拉按钮，QSpinBox的向上、向下箭头灯。 如：下拉按钮设置图片属性：</code>QComboBox::drop-down{image:url(dropdown.png)}</p>
<table>
<thead>
<tr>
<th>子控件</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>::add-line</td>
<td>在QScrollBar中跳转下一行的按钮</td>
</tr>
<tr>
<td>::add-page</td>
<td>在QScrollBar中滑动条和add-line之间的区域</td>
</tr>
<tr>
<td>::branch</td>
<td>在QTreeView中的分支指示器</td>
</tr>
<tr>
<td>::chunk</td>
<td>在QProgressBar中的进度块</td>
</tr>
<tr>
<td>::close-button</td>
<td>在QDockWidget或QTabBar选项卡的关闭按钮</td>
</tr>
<tr>
<td>::corner</td>
<td>在QAbstractScrollArea中两个滚动条之间的角落</td>
</tr>
<tr>
<td>::down-arrow</td>
<td>在QComboBox、QHeaderView(排序指示器)、QScrollBar或QSpinBox的向下箭头</td>
</tr>
<tr>
<td>::down-button</td>
<td>在QScrollBar或QSpinBox中的向下按钮</td>
</tr>
<tr>
<td>::drop-down</td>
<td>在QComboBox中的下拉框</td>
</tr>
<tr>
<td>::float-button</td>
<td>在QDockWidget中的浮动按钮</td>
</tr>
<tr>
<td>::groove</td>
<td>在QSlider中的滑动槽</td>
</tr>
<tr>
<td>::indicator</td>
<td>在QAbstractItemVIew、QCheckBox、QRadioButton、可选中的菜单项或可选中的QGroupBox中的指示器</td>
</tr>
<tr>
<td>::handle</td>
<td>在QScrollBar、QSplitter和QSlider中的操作条(滑动条)</td>
</tr>
<tr>
<td>::icon</td>
<td>在QAbstractItemVIew或QMenu中的图标</td>
</tr>
<tr>
<td>::item</td>
<td>在QAbstractItemVIew、QMenuBar、QMenu或QStatuBar中的一项</td>
</tr>
<tr>
<td>::left-arrow</td>
<td>在QScrollBar中的向左箭头</td>
</tr>
<tr>
<td>::left-corner</td>
<td>在QTabWidget中的左上角</td>
</tr>
<tr>
<td>::menu-arrow</td>
<td>带有菜单的QToolButton中的箭头</td>
</tr>
<tr>
<td>::menu-button</td>
<td>在QToolButton中的菜单按钮</td>
</tr>
<tr>
<td>::menu-indicator</td>
<td>在QPushButton中的菜单指示器</td>
</tr>
<tr>
<td>::right-arrow</td>
<td>在QMenu或QScrollBar中的向右箭头</td>
</tr>
<tr>
<td>::pane</td>
<td>在QTabWidget中的边或框</td>
</tr>
<tr>
<td>::right-corner</td>
<td>在QTabWidget中的右上角</td>
</tr>
<tr>
<td>::scroller</td>
<td>在QMenu或QTabBar中的滚动条</td>
</tr>
<tr>
<td>::section</td>
<td>在QHeaderView中的区块</td>
</tr>
<tr>
<td>::separator</td>
<td>在QMenu或QMainWIndow中分隔条</td>
</tr>
<tr>
<td>::sub-line</td>
<td>在QScrollBar中跳转上一行的按钮</td>
</tr>
<tr>
<td>::sub-page</td>
<td>在QScrollBar中滑动条和sub-line之间的区域</td>
</tr>
<tr>
<td>::tab</td>
<td>在QTabBar或QToolBox中选项卡</td>
</tr>
<tr>
<td>::tab-bar</td>
<td>在QTabWidget中的选项卡栏</td>
</tr>
<tr>
<td>::tear</td>
<td>在QTabBar中的tear指示器</td>
</tr>
<tr>
<td>::tearoff</td>
<td>在QMenu中的tear-off指示器</td>
</tr>
<tr>
<td>::text</td>
<td>在QAbstractItemView中的文本</td>
</tr>
<tr>
<td>::title</td>
<td>在QGroupBox或QDockWidget中的标题栏</td>
</tr>
<tr>
<td>::up-arrow</td>
<td>在QComboBox、QHeaderView(排序指示器)、QScrollBar或QSpinBox的向上箭头</td>
</tr>
<tr>
<td>::up-button</td>
<td>在QScrollBar或QSpinBox中的向上按钮</td>
</tr>
</tbody></table>
<h3 id="伪状态"><a href="#伪状态" class="headerlink" title="伪状态"></a>伪状态</h3><p>  选择器也许会包含基于widget的state的程序限制规则的伪状态。伪状态以冒号(:)作为分隔紧跟着选择器。举个例子，下面的规则在鼠标悬浮在QPushButton的上方时生效：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QPushButton<span class="selector-pseudo">:hover</span> &#123; <span class="attribute">color</span>: white &#125;<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>  伪状态可以使用感叹号进行取反，下面一条规则在鼠标没有悬浮在QRadioButton上方时生效：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QRadioButton:!hover &#123; color: red &#125;<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>  伪状态可以链接，在这样的情况下，隐式地包含了逻辑与。举个例子，下面一条规则在鼠标悬浮到一个已check的QCheckBox上时生效：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QCheckBox<span class="selector-pseudo">:hover</span><span class="selector-pseudo">:checked</span> &#123; <span class="attribute">color</span>: white &#125;<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>  伪状态的取反也可以出现在伪状态链中，举个例子，下面的规则在鼠标悬浮到一个没有被press的QPushButton上时生效：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QPushButton<span class="selector-pseudo">:hover</span>:!pressed &#123; color: blue; &#125;<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>  如果有需要，可以使用逗号来表示逻辑或:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QCheckBox<span class="selector-pseudo">:hover</span>, QCheckBox<span class="selector-pseudo">:checked</span> &#123; <span class="attribute">color</span>: white &#125;<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>  伪状态可以与subcontrol组合使用，举个例子：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QComboBox::drop-down:hover &#123; image: <span class="built_in">url</span>(<span class="string">dropdown_bright.png</span>) &#125;<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>查看由Qt widgets提供的<a target="_blank" rel="noopener" href="http://doc.qt.io/qt-4.8/stylesheet-reference.html#list-of-pseudo-states">伪状态列表</a>章节</p>
<h4 id="附-伪状态列表"><a href="#附-伪状态列表" class="headerlink" title="附 伪状态列表"></a>附 伪状态列表</h4><p>伪状态使用单冒号”:”</p>
<ol>
<li><p>选择器可以使用状态来限制在部件的指定状态上的应用。伪状态在选择器之后，用冒号隔离。如：</p>
<p>鼠标悬停在按钮上时其按钮的颜色为白色：QPushButton:hover{color:white}</p>
<p>鼠标不悬停在按钮上时其按钮的颜色为l蓝色(!表否定)：QPushButton:!hover{color:blue}</p>
</li>
<li><p>伪状态可多个连用，达到逻辑与效果。如：鼠标悬停在一个被选中的QCheckBox部件上时才应用规则：QCheckBox:hover:checked{color:white}</p>
</li>
<li><p>伪状态可通过逗号达到逻辑或效果。如：QCheckBox:hover,checked{color:white}</p>
</li>
<li><p>伪状态和子部件联合使用。如：QComboBox::drop-down:hover{image:url(dropdown_bright.png)}</p>
</li>
</ol>
<table>
<thead>
<tr>
<th>伪状态</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>:active</td>
<td>此状态在小部件驻留在活动窗口时设置</td>
</tr>
<tr>
<td>:adjoins-item</td>
<td>此状态在QTreeView的::branch与一个item相邻时设置</td>
</tr>
<tr>
<td>:alternate</td>
<td>当QAbstractItemView::alternatingRowColors()设置为真时，在绘制QAbstractItemView的行时，为每个交替行设置此状态</td>
</tr>
<tr>
<td>:bottom</td>
<td>此item位于底部。例如，QTabBar有位于底部的选项卡</td>
</tr>
<tr>
<td>:checked</td>
<td>此item被选中。例如，QAbstractButton的checked状态</td>
</tr>
<tr>
<td>:closable</td>
<td>此item可以被关闭。例如，QDockWidget的QDockWidget::DockWidgetClosable特性开启时</td>
</tr>
<tr>
<td>:closed</td>
<td>此item处于关闭状态。例如，QTreeView中未展开的item</td>
</tr>
<tr>
<td>:default</td>
<td>此item的默认状态。例如，一个default的QPushButton或QMenu中的一个默认动作</td>
</tr>
<tr>
<td>:disabled</td>
<td>此item被禁用时的状态</td>
</tr>
<tr>
<td>:editable</td>
<td>如QComboBox是可编辑的</td>
</tr>
<tr>
<td>:edit-focus</td>
<td>此item具有编辑焦点(参考QStyle::State_HasEditFocus)。此状态仅对Qt扩展应用程序可用</td>
</tr>
<tr>
<td>:enabled</td>
<td>此item已启用</td>
</tr>
<tr>
<td>:exclusive</td>
<td>此item是一个独占项组的一部分。例如，独占QActionGroup中的菜单项</td>
</tr>
<tr>
<td>:first</td>
<td>此item是列表中的第一项。例如，QTabBar中的第一个选项卡</td>
</tr>
<tr>
<td>:flat</td>
<td>此item是平的。例如，一个扁平的QPushButton</td>
</tr>
<tr>
<td>:floatable</td>
<td>此item可以浮动。例如，QDockWidget的QDockWidget::DockWidgetFloatable的特性开启时</td>
</tr>
<tr>
<td>:focus</td>
<td>此item具有输入焦点</td>
</tr>
<tr>
<td>:has-children</td>
<td>此item具有子对象。例如，QTreeView中具有子项的项</td>
</tr>
<tr>
<td>:has-sibling</td>
<td>此item具有兄弟对象。例如，QTreeView中与之相邻的项</td>
</tr>
<tr>
<td>:horizontal</td>
<td>此item处于水平方向</td>
</tr>
<tr>
<td>:hover</td>
<td>鼠标悬浮在此item上</td>
</tr>
<tr>
<td>:indeterminate</td>
<td>此item处于不确定状态。例如，QCheckBox或QRadioButton被部分选中</td>
</tr>
<tr>
<td>:last</td>
<td>此item是列表中的最后一项。例如，QTabBar中的最后一个选项卡</td>
</tr>
<tr>
<td>:left</td>
<td>此item位于左侧。例如，QTabBar有位于左侧的选项卡</td>
</tr>
<tr>
<td>:maximized</td>
<td>此item处于最大化状态。例如，一个最大化的QMdiSubWindow</td>
</tr>
<tr>
<td>:middle</td>
<td>此item是列表中的中间一项。例如，一个不在QTabBar中的开头或结尾的选项卡</td>
</tr>
<tr>
<td>:minimized</td>
<td>此item处于最小化状态。例如，一个最小化的QMdiSubWindow</td>
</tr>
<tr>
<td>:movable</td>
<td>此item可以被移动。例如， QDockWidget的QDockWidget::DockWidgetMovable特性开启时</td>
</tr>
<tr>
<td>:no-frame</td>
<td>此item没有边框。例如，没有边框的QSpinBox或QLineEdit</td>
</tr>
<tr>
<td>:non-exclusive</td>
<td>此item是一个非独占项组的一部分。例如，非独占QActionGroup中的菜单项</td>
</tr>
<tr>
<td>:off</td>
<td>对可以切换的items，这适用于处于off状态的item</td>
</tr>
<tr>
<td>:on</td>
<td>对可以切换的items，这适用于处于on状态的widget</td>
</tr>
<tr>
<td>:only-one</td>
<td>此item是列表中的唯一的一项。例如，一个在QTabBar中单独的选项卡</td>
</tr>
<tr>
<td>:open</td>
<td>此item处于打开状态。例如，QTreeView中的展开项，或带有菜单的QComboBox或QPushButton</td>
</tr>
<tr>
<td>:next-selected</td>
<td>此item是列表中的下一个被选中的项。例如，在QTabBar中当前选项卡的下一个要选中的选项卡</td>
</tr>
<tr>
<td>:pressed</td>
<td>鼠标正在按压在此item上</td>
</tr>
<tr>
<td>:previous-selected</td>
<td>此item是列表中的上一个被选中的项。例如，在QTabBar中当前选项卡的上一个要选中的选项卡</td>
</tr>
<tr>
<td>:read-only</td>
<td>此item处于只读或不可编辑状态。例如，一个只读QLineEdit或不可编辑的QComboBox</td>
</tr>
<tr>
<td>:right</td>
<td>此item位于右侧。例如，QTabBar有位于右侧的选项卡</td>
</tr>
<tr>
<td>:selected</td>
<td>此item处于选中状态。例如，一个在QTabBar中被选中的选项卡或一个在菜单中被选中的菜单项</td>
</tr>
<tr>
<td>:top</td>
<td>此item位于顶部。例如，QTabBar有位于顶部的选项卡</td>
</tr>
<tr>
<td>:unchecked</td>
<td>此item处于未被选中状态</td>
</tr>
<tr>
<td>:vertical</td>
<td>此item处于垂直方向</td>
</tr>
<tr>
<td>:window</td>
<td>小部件是一个窗口(例如，一个顶层小部件)</td>
</tr>
</tbody></table>
<h3 id="属性列表"><a href="#属性列表" class="headerlink" title="属性列表"></a>属性列表</h3><p><a target="_blank" rel="noopener" href="https://doc.qt.io/qt-6/stylesheet-reference.html">QSS官方参考</a><br>对于不理解的地方可以参考CSS：<a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/pr_background-clip.asp">CSS参考手册（里面有测试，可以很直观的看到不同属性值的区别）</a></p>
<hr>
<table>
<thead>
<tr>
<th>attribute属性</th>
<th>类型</th>
<th>描述</th>
<th><span style="display:inline-block;width: 380px"> 示例</span></th>
</tr>
</thead>
<tbody><tr>
<td>alternate-background-color</td>
<td>Brush</td>
<td>交替背景色。</td>
<td><img src="/2021/06/27/Qt/03f311a21fe8477a99b7956ec88e6903.png" alt="img"></td>
</tr>
<tr>
<td>background</td>
<td>Background</td>
<td>背景，相当于指定background-color、background-image、background-repeat和background-position。</td>
<td><img src="/2021/06/27/Qt/096b07252b1a43408eb437110ae7778f.png" alt="img"></td>
</tr>
<tr>
<td>background-color</td>
<td>Brush</td>
<td>背景颜色，例如：</td>
<td><img src="/2021/06/27/Qt/2e24da43d7e64dff9f7ce6fa26fed5a6.png" alt="img"></td>
</tr>
<tr>
<td>background-image</td>
<td>Url</td>
<td>背景图像（图像的半透明部分会被背景颜色穿透）。</td>
<td><img src="/2021/06/27/Qt/9045714dab1d4231aa5a5162fd06d8c4.png" alt="img"></td>
</tr>
<tr>
<td>background-repeat</td>
<td>Repeat</td>
<td>背景图像如何充满背景矩形，如果未指定此属性，背景图像将在两个方向上重复(repeat)。</td>
<td><img src="/2021/06/27/Qt/cfbfd8a063e44ac2b8c80582c64e944d.png" alt="img"></td>
</tr>
<tr>
<td>background-position</td>
<td>Alignment</td>
<td>背景图像在背景原点矩形内的对齐。如果未指定此属性，则对齐方式为左上角。</td>
<td><img src="/2021/06/27/Qt/51486f7927ac4ec78a07a23caac11b9a.png" alt="img"></td>
</tr>
<tr>
<td>background-attachment</td>
<td>Attachment</td>
<td>背景图像是否相对于视口进行滚动或固定。默认情况下，背景图像随视口滚动。</td>
<td><img src="/2021/06/27/Qt/0a9b91d36fd444beb1ab231273fd22a4.png" alt="img"></td>
</tr>
<tr>
<td>background-clip</td>
<td>Origin</td>
<td>规定背景的绘制区域。如果未指定此属性，则默认为border。     border：背景被裁剪到边框盒     padding：背景被裁剪到内边距框     content：背景被裁剪到内容框</td>
<td><img src="/2021/06/27/Qt/f7ba5af0f8eb444885208663f19773c8.png" alt="img"></td>
</tr>
<tr>
<td>background-origin</td>
<td>Origin</td>
<td>背景图像相对于什么来定位。如果未指定此属性，则默认为  padding 填充。     padding：背景图像相对于内边距框来定位     border：背景图像相对于边框盒来定位     content：背景图像相对于内容框来定位</td>
<td><img src="/2021/06/27/Qt/d1d489c0fc7b43f0a32b2d3c94088fcd.png" alt="img"></td>
</tr>
<tr>
<td>border</td>
<td>Border</td>
<td>设置 4  个边框的样式，按照一下顺序进行设置：border-width，border-style，border-color。</td>
<td><img src="/2021/06/27/Qt/6360de287f4f47ea965eecb5164c48f5.png" alt="img"></td>
</tr>
<tr>
<td>border-top</td>
<td>Border</td>
<td>顶部边框</td>
<td></td>
</tr>
<tr>
<td>border-bottom</td>
<td>Border</td>
<td>底部边框</td>
<td></td>
</tr>
<tr>
<td>border-right</td>
<td>Border</td>
<td>右边边框</td>
<td></td>
</tr>
<tr>
<td>border-left</td>
<td>Border</td>
<td>左边边框</td>
<td></td>
</tr>
<tr>
<td>border-color</td>
<td>Box Colors</td>
<td>边框的颜色。</td>
<td><img src="/2021/06/27/Qt/e0886f3796e5443e9db45e552bd6f604.png" alt="img"></td>
</tr>
<tr>
<td>border-top-color</td>
<td>Brush</td>
<td>边框上边缘颜色</td>
<td></td>
</tr>
<tr>
<td>border-bottom-color</td>
<td>Brush</td>
<td>边框下边缘颜色</td>
<td></td>
</tr>
<tr>
<td>border-right-color</td>
<td>Brush</td>
<td>边框右边缘颜色</td>
<td></td>
</tr>
<tr>
<td>border-left-color</td>
<td>Brush</td>
<td>边框左边缘颜色</td>
<td></td>
</tr>
<tr>
<td>border-image</td>
<td>Border Image</td>
<td>填充边框的图像</td>
<td></td>
</tr>
<tr>
<td>border-radius</td>
<td>Radius</td>
<td>边角的半径，即边角圆弧。</td>
<td><img src="/2021/06/27/Qt/e9ce19b985ab410b854f0f2a55fc838b.png" alt="img"></td>
</tr>
<tr>
<td>border-top-left-radius</td>
<td>Radius</td>
<td>左上角圆弧</td>
<td></td>
</tr>
<tr>
<td>border-top-right-radius</td>
<td>Radius</td>
<td>右上角圆弧</td>
<td></td>
</tr>
<tr>
<td>border-bottom-right-radius</td>
<td>Radius</td>
<td>右下角圆弧</td>
<td></td>
</tr>
<tr>
<td>border-bottom-left-radius</td>
<td>Radius</td>
<td>左下角圆弧</td>
<td></td>
</tr>
<tr>
<td>border-style</td>
<td>Border Style</td>
<td>边框边缘的样式，若未指定默认为none。</td>
<td><img src="/2021/06/27/Qt/083f128113d944d6803729f822feb9af.png" alt="img"></td>
</tr>
<tr>
<td>border-top-style</td>
<td>Border Style</td>
<td>边框上边缘的样式</td>
<td></td>
</tr>
<tr>
<td>border-bottom-style</td>
<td>Border Style</td>
<td>边框下边缘的样式</td>
<td></td>
</tr>
<tr>
<td>border-right-style</td>
<td>BorderStyle</td>
<td>边框右边缘的样式</td>
<td></td>
</tr>
<tr>
<td>border-left-style</td>
<td>BorderStyle</td>
<td>边框左边缘的样式</td>
<td></td>
</tr>
<tr>
<td>border-width</td>
<td>Box Lengths</td>
<td>边框的宽度。</td>
<td><img src="/2021/06/27/Qt/d5767b0b8404460a91d78bab1faf3341.png" alt="img"></td>
</tr>
<tr>
<td>border-top-width</td>
<td>Box Lengths</td>
<td>上边框的宽度</td>
<td></td>
</tr>
<tr>
<td>border-bottom-width</td>
<td>Box Lengths</td>
<td>下边框的宽度</td>
<td></td>
</tr>
<tr>
<td>border-right-width</td>
<td>Box Lengths</td>
<td>右边框的宽度</td>
<td></td>
</tr>
<tr>
<td>border-left-width</td>
<td>Box Lengths</td>
<td>左边框的宽度</td>
<td></td>
</tr>
<tr>
<td>bottom</td>
<td>Length</td>
<td>在部件边底部其子控件向上的偏移量，即元素与底部边缘的距离。</td>
<td><img src="/2021/06/27/Qt/c7a3d92399f242f9a9f033b71bc0319e.png" alt="img"></td>
</tr>
<tr>
<td>top</td>
<td>Length</td>
<td>在部件边顶部其子控件向下的偏移量，即元素与顶部边缘的距离。</td>
<td><img src="/2021/06/27/Qt/d84d5be4b7fd4a978f199565fd59faf2.png" alt="img"></td>
</tr>
<tr>
<td>right</td>
<td>Length</td>
<td>在部件右边其子控件向左的偏移量，即元素与右边缘的距离。</td>
<td><img src="/2021/06/27/Qt/011f6a4b5ef44988bd5117b81c65852a.png" alt="img"></td>
</tr>
<tr>
<td>left</td>
<td>Length</td>
<td>在部件左边其子控件向右的偏移量，即元素与左边缘的距离。</td>
<td><img src="/2021/06/27/Qt/1deebdc383fb4b28b89c1a6f9597e4e2.png" alt="img"></td>
</tr>
<tr>
<td>button-layout</td>
<td>Number</td>
<td>QDialogButtonBox或QMessageBox中的按钮布局。取值为0  (WinLayout)、1 (MacLayout)、2 (KdeLayout)、3 (GnomeLayout)和5  (AndroidLayout)。如果未指定此属性，它默认为SH_DialogButtonLayout样式提示的当前样式所指定的值。</td>
<td><img src="/2021/06/27/Qt/7a67fc38ed28480ebf4f5a9fbdea19d1.png" alt="img"></td>
</tr>
<tr>
<td>color</td>
<td>Brush</td>
<td>渲染文本的颜色，默认值为黑色。</td>
<td><img src="/2021/06/27/Qt/13e549987d2c41498d0ae9e38f707aba.png" alt="img"></td>
</tr>
<tr>
<td>dialogbuttonbox-buttons-have-icons</td>
<td>Boolean</td>
<td>QDialogButtonBox中的按钮是否显示图标如果这个属性被设置为1,QDialogButtonBox的按钮显示图标;如果设置为0，则不显示图标。</td>
<td><img src="/2021/06/27/Qt/9ef25d60e08d429c87d6a90b813391bd.png" alt="img"></td>
</tr>
<tr>
<td>font</td>
<td>Font</td>
<td>设置字体。相当于指定font-family、font-size、font-style和/或font-weight。</td>
<td><img src="/2021/06/27/Qt/11887dfa824e4e268463c31c40e97d03.png" alt="img"></td>
</tr>
<tr>
<td>font-family</td>
<td>String</td>
<td>字体类型。</td>
<td><img src="/2021/06/27/Qt/9223c9cdc2a64b69b83866c90288da9c.png" alt="img"></td>
</tr>
<tr>
<td>font-size</td>
<td>Font Size</td>
<td>字体大小。</td>
<td><img src="/2021/06/27/Qt/59168e074ee74fe2bf9569c39f75198d.png" alt="img"></td>
</tr>
<tr>
<td>font-style</td>
<td>Font Style</td>
<td>字体风格(倾斜）。</td>
<td><img src="/2021/06/27/Qt/9ddcd53eb7bc4b24ab6bb0ffad55ace4.png" alt="img"></td>
</tr>
<tr>
<td>font-weight</td>
<td>Font Weight</td>
<td>字体的粗细。</td>
<td></td>
</tr>
<tr>
<td>gridline-color*</td>
<td>Color</td>
<td>QTableView中网格线的颜色。如果没有指定此属性，它默认为SH_Table_GridLineColor样式提示的当前样式所指定的值。</td>
<td><img src="/2021/06/27/Qt/094978b3a49e438c81482018a388c14c.png" alt="img"></td>
</tr>
<tr>
<td>height</td>
<td>Length</td>
<td>子部件的高度。如果希望小部件具有固定的高度，请将min-height和max-height设置为相同的值。</td>
<td><img src="/2021/06/27/Qt/b571f9c0bf754f0698bae54027f898e3.png" alt="img"></td>
</tr>
<tr>
<td>width</td>
<td>Length</td>
<td>子控件(在某些情况下是小部件)的宽度。</td>
<td><img src="/2021/06/27/Qt/4ee58bf5b2784586883df59f6c3beb35.png" alt="img"></td>
</tr>
<tr>
<td>icon</td>
<td>Url+</td>
<td>所使用的图标，用于具有图标的小部件。目前唯一支持此属性的小部件是QPushButton。</td>
<td></td>
</tr>
<tr>
<td>icon-size</td>
<td>Length</td>
<td>小部件中图标的宽度和高度。可以使用此属性设置以下小部件的图标大小：QCheckBox、QListView、QPushButton、QRadioButton、QTabBar、QToolBar、QToolBox、QTreeView。</td>
<td></td>
</tr>
<tr>
<td>image*</td>
<td>Url+</td>
<td>在子控件的内容矩形中绘制图像。image属性接受一个url列表或者一个svg。绘制的实际图像使用与QIcon相同的算法。图像从不放大，但在必要时总是缩小。如果指定了svg，则图像会被缩放为内容矩形的大小。警告：渲染SVG图像需要QIcon  SVG插件。     隐式设置down-button的大小为spindown.png的大小</td>
<td><img src="/2021/06/27/Qt/c2b7e04e093a4278a315fd9c3f0819e4.png" alt="img"></td>
</tr>
<tr>
<td>image-position</td>
<td>Alignment</td>
<td>图像位置的对齐方式</td>
<td></td>
</tr>
<tr>
<td>lineedit-password-character*</td>
<td>Number</td>
<td>QLineEdit密码字符作为Unicode数字。如果没有指定此属性，它默认为SH_LineEdit_PasswordCharacter样式提示的当前样式所指定的值。</td>
<td><img src="/2021/06/27/Qt/cf40fa384aaf44998d5bf153ee449ea4.png" alt="img"></td>
</tr>
<tr>
<td>lineedit-password-mask-delay*</td>
<td>Number</td>
<td>在lineedit-password-character应用到可见字符之前，QLineEdit密码掩码延迟毫秒。如果未指定此属性，它默认为SH_LineEdit_PasswordMaskDelay样式提示的当前样式所指定的值。</td>
<td><img src="/2021/06/27/Qt/c11d096366f34120b53b35873cfb7046.png" alt="img"></td>
</tr>
<tr>
<td>margin</td>
<td>Box Lengths</td>
<td>设置元素的4个外边距。相当于指定margin-top、margin-right、margin-bottom和margin-left。</td>
<td><img src="/2021/06/27/Qt/f97d2770f76c43e1b26f9afdc61a6b9a.png" alt="img"></td>
</tr>
<tr>
<td>margin-top</td>
<td>Length</td>
<td>上边距</td>
<td></td>
</tr>
<tr>
<td>margin-right</td>
<td>Length</td>
<td>右边距</td>
<td></td>
</tr>
<tr>
<td>margin-bottom</td>
<td>Length</td>
<td>下边距</td>
<td></td>
</tr>
<tr>
<td>margin-left</td>
<td>Length</td>
<td>左边距</td>
<td></td>
</tr>
<tr>
<td>max-height</td>
<td>Length</td>
<td>小部件或子控件（例如Item）的最大高度。</td>
<td><img src="/2021/06/27/Qt/ea35e6d95cbf4b869fcb892cd18dfba4.png" alt="img"></td>
</tr>
<tr>
<td>max-width</td>
<td>Length</td>
<td>小部件或子控件（例如Item）的最大宽度。</td>
<td><img src="/2021/06/27/Qt/5843ad0a54ca44848eab14114fce609d.png" alt="img"></td>
</tr>
<tr>
<td>min-height</td>
<td>Length</td>
<td>小部件或子控件（例如Item）的最小高度。</td>
<td><img src="/2021/06/27/Qt/11bcb912897848f3bf23d8ad719cf748.png" alt="img"></td>
</tr>
<tr>
<td>min-width</td>
<td>Length</td>
<td>小部件或子控件（例如Item）的最小宽度。</td>
<td><img src="/2021/06/27/Qt/c2449d720d2e440084a2301040e2a3aa.png" alt="img"></td>
</tr>
<tr>
<td>messagebox-text-interaction-flags*</td>
<td>Number</td>
<td>消息框中文本的交互行为。可能的值基于Qt::TextInteractionFlags。如果未指定此属性，则默认为SH_MessageBox_TextInteractionFlags样式提示的当前样式所指定的值。</td>
<td><img src="/2021/06/27/Qt/f82f76ff6934444c8737e4cf4af0f148.png" alt="img"></td>
</tr>
<tr>
<td>opacity*</td>
<td>Number</td>
<td>小部件的不透明度。取值范围为0(透明)~  255(不透明)。目前，这只支持tooltips。如果未指定此属性，它默认为SH_ToolTipLabel_Opacity样式提示的当前样式指定的值。</td>
<td><img src="/2021/06/27/Qt/fa06400764224b288f3b936828a0ece1.png" alt="img"></td>
</tr>
<tr>
<td>outline</td>
<td></td>
<td>边框的轮廓</td>
<td></td>
</tr>
<tr>
<td>outline-color</td>
<td>Color</td>
<td>轮廓的颜色</td>
<td></td>
</tr>
<tr>
<td>outline-offset</td>
<td>Length</td>
<td>轮廓与小部件边界的偏移量</td>
<td></td>
</tr>
<tr>
<td>outline-style</td>
<td></td>
<td>指定用于绘制轮廓的模式</td>
<td></td>
</tr>
<tr>
<td>outline-radius</td>
<td></td>
<td>在轮廓中添加圆角</td>
<td></td>
</tr>
<tr>
<td>outline-bottom-left-radius</td>
<td>Radius</td>
<td>轮廓左下角的圆角</td>
<td></td>
</tr>
<tr>
<td>outline-bottom-right-radius</td>
<td>Radius</td>
<td>轮廓右下角的圆角</td>
<td></td>
</tr>
<tr>
<td>outline-top-right-radius</td>
<td>Radius</td>
<td>轮廓右上角的圆角</td>
<td></td>
</tr>
<tr>
<td>outline-top-left-radius</td>
<td>Radius</td>
<td>轮廓左上角的圆角</td>
<td></td>
</tr>
<tr>
<td>padding</td>
<td>Box Lengths</td>
<td>小部件的填充。相当于指定填充顶部、填充右侧、填充底部和填充左侧。如果未指定此属性，则默认为0。</td>
<td><img src="/2021/06/27/Qt/4601979f48274f0695d2d769ebbf6a85.png" alt="img"></td>
</tr>
<tr>
<td>padding-top</td>
<td>Length</td>
<td>顶部填充</td>
<td></td>
</tr>
<tr>
<td>padding-right</td>
<td>Length</td>
<td>右侧填充</td>
<td></td>
</tr>
<tr>
<td>padding-bottom</td>
<td>Length</td>
<td>底部填充</td>
<td></td>
</tr>
<tr>
<td>padding-left</td>
<td>Length</td>
<td>左侧填充</td>
<td></td>
</tr>
<tr>
<td>paint-alternating-row-colors-for-empty-area</td>
<td>bool</td>
<td>QTreeView是否为空区域(即没有项目的区域)绘制交替的行色</td>
<td></td>
</tr>
<tr>
<td>posotion</td>
<td>relative | absolute</td>
<td>使用左、右、上和下指定的偏移量是相对坐标还是绝对坐标。如果未指定此属性，则默认为relative。</td>
<td></td>
</tr>
<tr>
<td>selection-background-color*</td>
<td>Brush</td>
<td>所选文本或项的背景。如果未设置此属性，则默认值是为调色板palette的Highlight角色设置的值。</td>
<td><img src="/2021/06/27/Qt/c9c6a94511df4e538cf4220600a6e054.png" alt="img"></td>
</tr>
<tr>
<td>selection-color*</td>
<td>Brush</td>
<td>所选文本或项的前景。如果未设置此属性，则默认值是为调色板palette的HighlightedText角色设置的值。</td>
<td><img src="/2021/06/27/Qt/59dd298befa744d5a28a141db8011fca.png" alt="img"></td>
</tr>
<tr>
<td>show-decoration-selected*</td>
<td>Boolean</td>
<td>控制QListView中的选择是覆盖整行还是仅覆盖文本的范围。如果未指定此属性，它默认为SH_ItemView_ShowDecorationSelected样式提示的当前样式指定的值。</td>
<td><img src="/2021/06/27/Qt/475c2d85a46040a8b7d3a8449d005ba6.png" alt="img"></td>
</tr>
<tr>
<td>spacing*</td>
<td>Length</td>
<td>小部件中的内部间距。</td>
<td><img src="/2021/06/27/Qt/f68656ffae1349179969dfdf244659be.png" alt="img"></td>
</tr>
<tr>
<td>subcontrol-origin*</td>
<td>Origin</td>
<td>父元素中子控件的起始矩形。如果未指定此属性，则默认为填充。</td>
<td><img src="/2021/06/27/Qt/212b8c238f894bed8a0eaf9e7c755f21.png" alt="img"></td>
</tr>
<tr>
<td>subcontrol-position*</td>
<td>Alignment</td>
<td>子控件在subcontrol-origin指定的原点矩形内的对齐。如果未指定此属性，则默认为依赖于子控件的值。</td>
<td><img src="/2021/06/27/Qt/50b011d99951456fb76966f492365c64.png" alt="img"></td>
</tr>
<tr>
<td>titlebar-show-tooltips-on-buttons</td>
<td>bool</td>
<td>工具提示是否显示在窗口标题栏按钮上。</td>
<td></td>
</tr>
<tr>
<td>widget-animation-duration*</td>
<td>Number</td>
<td>动画应该持续多长时间(以毫秒为单位)。值等于零意味着动画将被禁用。如果没有指定此属性，它默认为SH_Widget_Animation_Duration样式提示的当前样式指定的值。</td>
<td><img src="/2021/06/27/Qt/6da38939d5aa4787b43aeb2630beee36.png" alt="img"></td>
</tr>
<tr>
<td>text-align</td>
<td>Alignment</td>
<td>小部件内容中的文本和图标的对齐方式。</td>
<td><img src="/2021/06/27/Qt/3167e91bcde34de9bd82ae0b8eec9e43.png" alt="img"></td>
</tr>
<tr>
<td>text-decoration</td>
<td>none     underline     overline     line-through</td>
<td>附加文本效果</td>
<td></td>
</tr>
<tr>
<td>-qt-background-role</td>
<td>PaletteRole</td>
<td>基于所选角色的子控件或小部件的背景色。</td>
<td></td>
</tr>
<tr>
<td>-qt-style-features</td>
<td>list</td>
<td>要在其上应用特定于qt的样式的CSS属性列表。注意:列表只能包含非基于像素图的属性。</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="解决冲突"><a href="#解决冲突" class="headerlink" title="解决冲突"></a>解决冲突</h3><p>  当几个样式规则为同一个属性指定不同的值时，就产生了冲突。请考虑下面的样式表：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QPushButton<span class="selector-id">#okButton</span> &#123; <span class="attribute">color</span>: gray &#125;</span><br><span class="line">QPushButton &#123; <span class="attribute">color</span>: red &#125;</span><br></pre></td></tr></table></figure>

<p>  两条规则都匹配名为okButton的QPushButton实例并且冲突于颜色属性。为了解决冲突，我们必须考虑到选择器的特殊性。在上面的例子中，QPushButton#okButton被视为比QPushButton更特殊，因为它（通常）指向一个单一的对象而不是QPushButton的所有实例。</p>
<p>  相似的，指定了伪状态的选择器比没有指定伪状态的更特殊。从而，下面的样式表指明了当鼠标悬浮到QPushButton上方时其字体颜色应该为白色，而其余情况则为红色：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QPushButton<span class="selector-pseudo">:hover</span> &#123; <span class="attribute">color</span>: white &#125;</span><br><span class="line">QPushButton &#123; <span class="attribute">color</span>: red &#125;</span><br></pre></td></tr></table></figure>

<p>  接下来看一个很有意思的：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QPushButton<span class="selector-pseudo">:hover</span> &#123; <span class="attribute">color</span>: white &#125;</span><br><span class="line">QPushButton<span class="selector-pseudo">:enabled</span> &#123; <span class="attribute">color</span>: red &#125;</span><br></pre></td></tr></table></figure>

<p>  两个选择器都有相同的特殊性，所以当鼠标悬浮在一个enabled的按钮上时，第二条规则优先。如果在这种情况下我们想要文字变成白色，我们可以像下面那样重新排布一下样式规则：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QPushButton<span class="selector-pseudo">:enabled</span> &#123; <span class="attribute">color</span>: red &#125;</span><br><span class="line">QPushButton<span class="selector-pseudo">:hover</span> &#123; <span class="attribute">color</span>: white &#125;</span><br></pre></td></tr></table></figure>

<p>  另外，我们可以使第一条规则更特殊一些：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QPushButton<span class="selector-pseudo">:hover</span><span class="selector-pseudo">:enabled</span> &#123; <span class="attribute">color</span>: white &#125;</span><br><span class="line">QPushButton<span class="selector-pseudo">:enabled</span> &#123; <span class="attribute">color</span>: red &#125;</span><br></pre></td></tr></table></figure>

<p>  相似的问题出现在相互配合的类型选择器上。考虑以下情况：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QPushButton &#123; <span class="attribute">color</span>: red &#125;</span><br><span class="line">QAbstractButton &#123; <span class="attribute">color</span>: gray &#125;</span><br></pre></td></tr></table></figure>

<p>  两条规则都应用于QPushButton的实例（因为QPushButton继承于QAbstractButton）并且冲突于color属性。因为QPushButton继承于QAbstractButton，这让人不禁想到QPushButton比QAbstractButton更特殊。然而，对于样式表的运算，所有的类型选择器都具有同等的特殊性，并且出现在更后面的规则优先级更高。换句话说，QAbstractButton的color会被设置成灰色，包括QPushButton。如果我们确实想要QPushButton字体颜色设置为红色，我们总是可以使用重新排列样式表规则顺序的方式实现。</p>
<p>为确定规则的特殊性，Qt样式表跟随<a target="_blank" rel="noopener" href="http://www.w3.org/TR/REC-CSS2/cascade.html#specificity">CSS2规范</a></p>
<p>一个选择器的特殊性由下面的方式计算：<br>- 计算选择器中ID属性的数量[=a]<br>- 计算选择器中其他属性和伪类的数量[=b]<br>- 计算选择器中元素名字的数量[=c]<br>- 忽略伪原素[如:subcontrol]</p>
<p>串联这三个数字a-b-c（在一个大基数的数字系统）就得到了特殊性等级。</p>
<p>举个例子：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">*             &#123;&#125;  <span class="comment">/* a=0 b=0 c=0 -&gt; specificity =   0 */</span></span><br><span class="line"><span class="selector-tag">LI</span>            &#123;&#125;  <span class="comment">/* a=0 b=0 c=1 -&gt; specificity =   1 */</span></span><br><span class="line"><span class="selector-tag">UL</span> <span class="selector-tag">LI</span>         &#123;&#125;  <span class="comment">/* a=0 b=0 c=2 -&gt; specificity =   2 */</span></span><br><span class="line"><span class="selector-tag">UL</span> <span class="selector-tag">OL</span>+<span class="selector-tag">LI</span>      &#123;&#125;  <span class="comment">/* a=0 b=0 c=3 -&gt; specificity =   3 */</span></span><br><span class="line"><span class="selector-tag">H1</span> + *<span class="selector-attr">[REL=up]</span>&#123;&#125;  <span class="comment">/* a=0 b=1 c=1 -&gt; specificity =  11 */</span></span><br><span class="line"><span class="selector-tag">UL</span> <span class="selector-tag">OL</span> <span class="selector-tag">LI</span><span class="selector-class">.red</span>  &#123;&#125;  <span class="comment">/* a=0 b=1 c=3 -&gt; specificity =  13 */</span></span><br><span class="line"><span class="selector-tag">LI</span><span class="selector-class">.red</span><span class="selector-class">.level</span>  &#123;&#125;  <span class="comment">/* a=0 b=2 c=1 -&gt; specificity =  21 */</span></span><br><span class="line"><span class="selector-id">#x34y</span>         &#123;&#125;  <span class="comment">/* a=1 b=0 c=0 -&gt; specificity = 100 */</span></span><br></pre></td></tr></table></figure>

<h3 id="级联"><a href="#级联" class="headerlink" title="级联"></a>级联</h3><p>样式表可以设置到QApplication、父部件、子部件。任意部件应用的样式表通过合并设置到祖先部件（父亲、祖父等）的样式表获得，以及设置到QApplication上的任何样式表。</p>
<p>  当冲突产生时，部件本身的样式表总是优先于继承来的样式表，不论冲突规则计算的特殊性是多少。同样，父部件的样式表优先级要高于祖父部件的等等。</p>
<p>  这样做的一个后果是，部件上的一个样式规则自动获得高于其他由祖先部件或QApplication样式表指定的样式规则。考虑下面这个例子。首先，我们给QApplication设置样式表：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qApp-&gt;setStyleSheet(&quot;QPushButton &#123; <span class="attribute">color</span>: white &#125;&quot;);<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>  然后，我们给一个QPushButton对象设置样式表：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myPushButton-&gt;setStyleSheet(&quot;* &#123; <span class="attribute">color</span>: blue &#125;&quot;);<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>  设置到QPushButton上的样式表强制要求QPushButton（包括其任何子部件）的字体颜色为蓝色，尽管程序范围内的样式表给出了更详尽的样式规则。</p>
<p>  如果我们写成下面这样，效果还是一样的：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myPushButton-&gt;setStyleSheet(&quot;<span class="attribute">color</span>: blue<span class="string">&quot;);1</span></span><br></pre></td></tr></table></figure>

<p>  如果该QPushButton有孩子（这是不太可能的），这段样式表对它们无效。</p>
<p>  样式表级联是一个很复杂的话题。请参考<a target="_blank" rel="noopener" href="http://www.w3.org/TR/CSS2/cascade.html#cascade">CSS2规范</a>获取更多细节。请注意Qt目前没有实现的！很重要。</p>
<h3 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h3><p>  在典型的CSS中，如果一个项的字体和颜色没有显式设置，它会自动从其父亲获得。当使用Qt样式表时，一个部件不会从其父亲继承字体和颜色的设置（<strong>请注意，父亲和父类、孩子和子类都是不同的概念，不要搞混</strong>）。</p>
<p><img src="/2021/06/27/Qt/v2-8a8386c016bcd7162e6bbf26a588648c_720w.webp" alt="img"></p>
<p>举个例子，考虑一个QGroupBox内有一个QPushButton：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qApp-&gt;setStyleSheet(&quot;QGroupBox &#123; <span class="attribute">color</span>: red; &#125; &quot;);</span><br></pre></td></tr></table></figure>

<p>  QPushButton没有任何显式的color设置。因此，它会获得系统的颜色而不是从父亲继承color的值。如果我们要设置QGroupBox及其所有孩子的color，我们可以这样写：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qApp-&gt;setStyleSheet(&quot;QGroupBox, QGroupBox * &#123; <span class="attribute">color</span>: red; &#125;&quot;);<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>  与此相反，使用QWidget::setFont()可以设置字体包括孩子的字体，使用 QWidget::setPalette()可以设置调色板包括孩子的调色板。</p>
<h3 id="C-命名空间内的部件"><a href="#C-命名空间内的部件" class="headerlink" title="C++命名空间内的部件"></a>C++命名空间内的部件</h3><p>类型选择器可以用于样式化特定的类型，举个例子：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">class MyPushButton : public QPushButton &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br><span class="line">// ...</span><br><span class="line">qApp-&gt;setStyleSheet(&quot;MyPushButton &#123; <span class="attribute">background</span>: yellow; &#125;&quot;);</span><br></pre></td></tr></table></figure>

<p>  Qt样式表使用widget的QObject::className()来决定何时应用类型选择器。当自定义部件在命名空间之中，QObject::className()会返回::。这与subcontrol产生了冲突。为了解决这个问题，当为命名空间中widget使用类型选择器时，我们必须将”::”替换成”–”。举个例子：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">namespace ns &#123;</span><br><span class="line">    class MyPushButton : public QPushButton &#123;</span><br><span class="line">        // ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">// ...</span><br><span class="line">qApp-&gt;setStyleSheet(&quot;ns--MyPushButton &#123; <span class="attribute">background</span>: yellow; &#125;&quot;);</span><br></pre></td></tr></table></figure>

<h3 id="设置对象的属性"><a href="#设置对象的属性" class="headerlink" title="设置对象的属性"></a>设置对象的属性</h3><p>  从4.3以后，任何使用<a target="_blank" rel="noopener" href="http://doc.qt.io/qt-4.8/qobject.html#Q_PROPERTY">Q_PROPERTY</a>宏声明的属性都可以使用qproperty-<property name>语法。举个例子：</property></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MyLabel &#123; qproperty-pixmap: <span class="built_in">url</span>(<span class="string">pixmap.png</span>); &#125;MyGroupBox &#123; qproperty-titleColor: <span class="built_in">rgb</span>(<span class="number">100</span>, <span class="number">200</span>, <span class="number">100</span>); &#125;QPushButton &#123; qproperty-iconSize: <span class="number">20px</span> <span class="number">20px</span>; &#125;</span><br><span class="line">原文转载自:http://blog.csdn.net/matchyang/article/details/<span class="number">47703469</span></span><br></pre></td></tr></table></figure>

<h3 id="如何为全局添加QSS样式（全局加载QSS的方法）"><a href="#如何为全局添加QSS样式（全局加载QSS的方法）" class="headerlink" title="如何为全局添加QSS样式（全局加载QSS的方法）"></a>如何为全局添加QSS样式（全局加载QSS的方法）</h3><p>在Resource文件中添加qss文件，构造函数中直接调用</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MainWindow::loadStyleSheet</span><span class="params">(<span class="keyword">const</span> QString &amp;styleSheetFile)</span></span>&#123;  <span class="comment">//styleSheetFile是qss文件的Path</span></span><br><span class="line">	<span class="function">QFile <span class="title">file</span><span class="params">(styleSheetFile)</span></span>;</span><br><span class="line">	<span class="keyword">if</span>(file.<span class="built_in">open</span>(QFile::ReadOnly))&#123;</span><br><span class="line">		<span class="comment">//如果在MainWindow使用了setStyleSheet，对qss文件的内容进行追加</span></span><br><span class="line">		<span class="comment">//QString styleSheet = this-&gt;styleSheet();</span></span><br><span class="line">		<span class="comment">//styleSheet += QLatin1String(file.readAll());//读取样式表文件</span></span><br><span class="line">		QString styleSheet = <span class="built_in">QLatin1String</span>(file.<span class="built_in">readAll</span>());  <span class="comment">//QByteArray可直接转换为QString</span></span><br><span class="line">    	<span class="keyword">this</span>-&gt;<span class="built_in">setStyleSheet</span>(styleSheet);</span><br><span class="line">    	file.<span class="built_in">close</span>();</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		QMessageBox::<span class="built_in">information</span>(<span class="keyword">this</span>,<span class="string">&quot;tip&quot;</span>,<span class="string">&quot;Failed to open file&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><h3 id="QTabWidget、QTableView"><a href="#QTabWidget、QTableView" class="headerlink" title="QTabWidget、QTableView"></a>QTabWidget、QTableView</h3><p>设置背景色，发现选项卡右侧空白区域怎么设置都不行，并且右侧和下方有白条，需要按下面操作：</p>
<p><img src="/2021/06/27/Qt/image-20231206163957257.png" alt="image-20231206163957257"></p>
<p><img src="/2021/06/27/Qt/image-20231206164009725.png" alt="image-20231206164009725"></p>
<p>解决方法：</p>
<p>QTabWidget的documentMode属性复选框打钩即可。<img src="/2021/06/27/Qt/20200805205631582.png" alt="img"></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">QTabBar::tab &#123;</span><br><span class="line">    border: <span class="number">2px</span> solid <span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="attribute">border-top-left-radius</span>: <span class="number">4px</span>;</span><br><span class="line">    <span class="attribute">border-top-right-radius</span>: <span class="number">4px</span>;</span><br><span class="line">    <span class="attribute">min-width</span>: <span class="number">8ex</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">2px</span>;</span><br><span class="line">	<span class="attribute">background-color</span>:<span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">51</span>);</span><br><span class="line">	<span class="attribute">color</span>:<span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">1</span>);</span><br><span class="line">	<span class="attribute">font-size</span>:<span class="number">18px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QTabBar::tab:selected,QTabBar::tab:hover&#123;</span><br><span class="line">   background-color:<span class="built_in">rgba</span>(<span class="number">27</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">QHeaderView &#123;</span><br><span class="line">	<span class="attribute">background-color</span>:<span class="built_in">rgba</span>(<span class="number">27</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QHeaderView::section,QTableCornerButton::section &#123;</span><br><span class="line">	background:<span class="built_in">rgba</span>(<span class="number">27</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">1</span>);</span><br><span class="line">	<span class="attribute">font-size</span>:<span class="number">16px</span>;</span><br><span class="line">	<span class="attribute">color</span>:<span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QTableView</span><br><span class="line">&#123;</span><br><span class="line">	<span class="attribute">background-color</span>:<span class="built_in">rgba</span>(<span class="number">27</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">1</span>);</span><br><span class="line">	<span class="attribute">font-size</span>:<span class="number">16px</span>;</span><br><span class="line">	<span class="attribute">color</span>:<span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">1</span>);</span><br><span class="line">	selection-<span class="attribute">background-color</span>:<span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">50</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QPushButton</span><br><span class="line">&#123;</span><br><span class="line">	<span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">:/slices/矩形 46(9</span>).png);</span><br><span class="line">	<span class="attribute">border-radius</span>: <span class="number">4px</span>;  </span><br><span class="line">	<span class="attribute">border-width</span>:<span class="number">1px</span>;</span><br><span class="line">	<span class="attribute">border-color</span>:<span class="built_in">rgba</span>(<span class="number">22</span>, <span class="number">33</span>, <span class="number">55</span>, <span class="number">0.38</span>);</span><br><span class="line">	<span class="attribute">color</span>:<span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">1</span>);</span><br><span class="line">	<span class="attribute">font-size</span>:<span class="number">18px</span>;</span><br><span class="line">&#125;</span><br><span class="line">QPushButton::hover</span><br><span class="line">&#123;</span><br><span class="line">	background-color:<span class="built_in">rgba</span>(<span class="number">27</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">1</span>);</span><br><span class="line">	<span class="attribute">border-radius</span>: <span class="number">4px</span>;  </span><br><span class="line">	<span class="attribute">border-width</span>:<span class="number">1px</span>;</span><br><span class="line">	<span class="attribute">border</span>: <span class="number">2px</span> solid <span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">QScrollBar </span><br><span class="line">&#123;</span><br><span class="line">    <span class="attribute">background-color</span>:<span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">50</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QScrollBar::handle:horizontal </span><br><span class="line">&#123;</span><br><span class="line">    background-color: <span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">125</span>);</span><br><span class="line">    <span class="attribute">min-width</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QScrollBar::handle:vertical</span><br><span class="line">&#123;</span><br><span class="line">    background-color: <span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">125</span>);</span><br><span class="line">    <span class="attribute">min-height</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QScrollBar::add-page</span><br><span class="line">&#123;</span><br><span class="line">    background-color: transparent;</span><br><span class="line">&#125;</span><br><span class="line">QScrollBar::sub-page</span><br><span class="line">&#123;</span><br><span class="line">    background-color: transparent;</span><br><span class="line">&#125;</span><br><span class="line">QScrollBar::add-line</span><br><span class="line">&#123;</span><br><span class="line">    background-color: transparent;</span><br><span class="line">&#125;</span><br><span class="line">QScrollBar::sub-line</span><br><span class="line">&#123;</span><br><span class="line">    background-color: transparent;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>这个控件比较复杂，里面包含了滑动条、表头（又细分为内容区/空白区）、表格、整体、左上角按钮等多种不同的元素，他们之间有复杂的叠层关系。需要通过各种“选择器”来指定样式的作用范围。</p>
<p>本文由【暴躁的野生猿】发表于CSDN，如果有非法转载，请帮忙举报，谢谢。百度搜索暴躁的野生猿《QT各种控件常用样式表qss示例》可找到本文的原文。</p>
<p>下面通过示例来一步步观察他的叠层关系。首先使能表格的交替行：alternatingRowColors=true。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QTableView </span><br><span class="line">&#123;<span class="comment">/*整个表格区域最底层*/</span></span><br><span class="line">    <span class="attribute">background</span>: green;</span><br><span class="line">   <span class="attribute">color</span>:white;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>效果如下：</p>
<p><img src="/2021/06/27/Qt/3161ab3bc3c24e7c926e4b8586c53c65.png" alt="img"></p>
<p>发现这个绿色背景并没有作用于整体，表头部分仍然为白色，那是因为表头在顶层，遮住了<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=QTableView&spm=1001.2101.3001.7020">QTableView</a>的绿色背景。</p>
<p>下面设置表头背景色，黑色，半透明，透明度为50。按照预期，黑色半透明和QTableView的绿色叠加后，会形成深绿色。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">QTableView </span><br><span class="line">&#123;<span class="comment">/*整个表格区域最底层*/</span></span><br><span class="line">    <span class="attribute">background</span>: green;</span><br><span class="line">   <span class="attribute">color</span>:white;</span><br><span class="line">&#125;</span><br><span class="line">QHeaderView</span><br><span class="line">&#123;<span class="comment">/*表头整体样式，包括水平表头的右侧空白区域，垂直表头的下方空白区域*/</span></span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">50</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/06/27/Qt/0e62201080b341898574c2365c9f8c10.png" alt="img"></p>
<p>发现表头区域并没有全部变成深绿色，只有表头的非文字区域（空白区域）变成了深绿色。这是因为表头的文字区域，比空白区域的叠层更靠前，白色背景把深绿色给遮住了。下面继续设置表头的文字区域，设置为黑色半透明，透明度50。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">QTableView </span><br><span class="line">&#123;<span class="comment">/*整个表格区域最底层*/</span></span><br><span class="line">    <span class="attribute">background</span>: green;</span><br><span class="line">   <span class="attribute">color</span>:white;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QHeaderView</span><br><span class="line">&#123;<span class="comment">/*表头整体样式，包括水平表头的右侧空白区域，垂直表头的下方空白区域*/</span></span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">50</span>);</span><br><span class="line">&#125;</span><br><span class="line">QHeaderView::section </span><br><span class="line">&#123;/*表头有文字内容的区域*/</span><br><span class="line">     background-color: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">50</span>);</span><br><span class="line">     <span class="attribute">color</span>: white;</span><br><span class="line">	<span class="attribute">border</span>:none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/06/27/Qt/cf18f448756d4e3a83bb74e47ecad035.png" alt="img"></p>
<p>如上图所示，表头的文字区域，变成了颜色更深的深绿色，这是因为这个区域的颜色，实际上是3层颜色的叠加：QTableView整体的绿色+QHeadView表头整体的黑色半透明+section表头文字区域黑色半透明。</p>
<p>上图左上角的按钮还是白色，下面把他设置为黑色半透明：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">QTableView </span><br><span class="line">&#123;<span class="comment">/*整个表格区域最底层*/</span></span><br><span class="line">    <span class="attribute">background</span>: green;</span><br><span class="line">   <span class="attribute">color</span>:white;</span><br><span class="line">&#125;</span><br><span class="line">QHeaderView</span><br><span class="line">&#123;<span class="comment">/*表头整体样式，包括水平表头的右侧空白区域，垂直表头的下方空白区域*/</span></span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">50</span>);</span><br><span class="line">&#125;</span><br><span class="line">QHeaderView::section </span><br><span class="line">&#123;/*表头有文字内容的区域*/</span><br><span class="line">     background-color: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">50</span>);</span><br><span class="line">     <span class="attribute">color</span>: white;</span><br><span class="line">	<span class="attribute">border</span>:none;</span><br><span class="line">&#125;</span><br><span class="line">QTableView QTableCornerButton::section </span><br><span class="line">&#123;/*表格左上角按钮*/</span><br><span class="line">    border:none;</span><br><span class="line">    <span class="attribute">background-color</span>:  <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">50</span>);;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/06/27/Qt/21845cf3debe40ebb5ad9e7a710dbd1f.png" alt="img"></p>
<p>发现他呈现为较深的绿色，说明他位于QTableView整体绿色的上方，层次和QHeadView表头整体是同一层。</p>
<p>下面通过设置各个元素的边框，来更直观的看一下他们的包含与层次关系：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">QTableView </span><br><span class="line">&#123;<span class="comment">/*整个表格区域最底层*/</span></span><br><span class="line">    <span class="attribute">background</span>: green;</span><br><span class="line">   <span class="attribute">color</span>:white;</span><br><span class="line">	<span class="attribute">border</span>: <span class="number">5px</span> solid red;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">QHeaderView</span><br><span class="line">&#123;<span class="comment">/*表头整体样式，包括水平表头的右侧空白区域，垂直表头的下方空白区域*/</span></span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">50</span>);</span><br><span class="line">	<span class="attribute">border</span>: <span class="number">5px</span> solid blue;</span><br><span class="line">&#125;</span><br><span class="line">QHeaderView::section </span><br><span class="line">&#123;/*表头有文字内容的区域*/</span><br><span class="line">     background-color: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">50</span>);</span><br><span class="line">     <span class="attribute">color</span>: white;</span><br><span class="line">	<span class="attribute">border</span>: <span class="number">5px</span> solid yellow;</span><br><span class="line">&#125;</span><br><span class="line">QTableView QTableCornerButton::section </span><br><span class="line">&#123;/*表格左上角按钮*/</span><br><span class="line">    border:none;</span><br><span class="line">    <span class="attribute">background-color</span>:  <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">50</span>);</span><br><span class="line">	<span class="attribute">border</span>: <span class="number">5px</span> solid white;</span><br><span class="line">&#125;</span><br><span class="line">QTableView::item </span><br><span class="line">&#123;/*每个单元格*/</span><br><span class="line">    background: gray;</span><br><span class="line">	<span class="attribute">border</span>: <span class="number">5px</span> solid purple;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/06/27/Qt/5a562abc5212493fa74ab89ccbf1ef90.png" alt="img"></p>
<p> 表头部分，还支持选中不同的区域，如第一个、最后一个、中间部分、下一个等<img src="/2021/06/27/Qt/23d1fbdfee144a02b97c7fb08c804d7a.png" alt="img"></p>
<p>例如：垂直表头的第1格，，水平表头中间的所有格，设置为红色边框：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">QHeaderView::section:first:vertical</span><br><span class="line">&#123;/*垂直表头第一格文字区域*/</span><br><span class="line">	background-color: <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">50</span>);</span><br><span class="line">	<span class="attribute">border</span>: <span class="number">5px</span> solid red;</span><br><span class="line">&#125;</span><br><span class="line">QHeaderView::section:middle:horizontal</span><br><span class="line">&#123;/*水平表头所有的中间格文字区域*/</span><br><span class="line">	background-color: <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">50</span>);</span><br><span class="line">	<span class="attribute">border</span>: <span class="number">5px</span> solid red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>效果如下：</p>
<p><img src="/2021/06/27/Qt/eabf9b7203d34c5286a9d117598531f4.png" alt="img"></p>
<h4 id="mysue"><a href="#mysue" class="headerlink" title="mysue"></a>mysue</h4><p><img src="/2021/06/27/Qt/image-20231212141216118.png" alt="image-20231212141216118"></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">QTabBar::tab &#123;</span><br><span class="line">    border: <span class="number">2px</span> solid <span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="attribute">border-top-left-radius</span>: <span class="number">4px</span>;</span><br><span class="line">    <span class="attribute">border-top-right-radius</span>: <span class="number">4px</span>;</span><br><span class="line">	<span class="comment">/*下面这几行约束了tab的长宽*/</span></span><br><span class="line">	<span class="attribute">padding-left</span>:-<span class="number">9px</span>;</span><br><span class="line">	<span class="attribute">padding-right</span>:-<span class="number">9px</span>;</span><br><span class="line">	<span class="attribute">width</span>:<span class="number">100px</span>;</span><br><span class="line">	<span class="attribute">height</span>:<span class="number">30px</span>;</span><br><span class="line">	<span class="attribute">margin-left</span>:<span class="number">0px</span>;</span><br><span class="line">	<span class="attribute">margin-right</span>:<span class="number">0px</span>;</span><br><span class="line"></span><br><span class="line">	<span class="attribute">background-color</span>:<span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">51</span>);</span><br><span class="line">	<span class="attribute">color</span>:<span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">1</span>);</span><br><span class="line">	<span class="attribute">font-size</span>:<span class="number">18px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QTabBar::tab:selected,QTabBar::tab:hover&#123;</span><br><span class="line">   background-color:<span class="built_in">rgba</span>(<span class="number">27</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">QHeaderView &#123;</span><br><span class="line">	<span class="attribute">background-color</span>:<span class="built_in">rgba</span>(<span class="number">27</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QHeaderView::section,QTableCornerButton::section &#123;</span><br><span class="line">	background:<span class="built_in">rgba</span>(<span class="number">27</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">1</span>);</span><br><span class="line">	<span class="attribute">font-size</span>:<span class="number">16px</span>;</span><br><span class="line">	<span class="attribute">color</span>:<span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QTableView</span><br><span class="line">&#123;</span><br><span class="line">	<span class="attribute">background-color</span>:<span class="built_in">rgba</span>(<span class="number">27</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">1</span>);</span><br><span class="line">	<span class="attribute">font-size</span>:<span class="number">16px</span>;</span><br><span class="line">	<span class="attribute">color</span>:<span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">1</span>);</span><br><span class="line">	selection-<span class="attribute">background-color</span>:<span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">50</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QPushButton</span><br><span class="line">&#123;</span><br><span class="line">	<span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">:/slices/矩形 46(9</span>).png);</span><br><span class="line">	<span class="attribute">border-radius</span>: <span class="number">4px</span>;  </span><br><span class="line">	<span class="attribute">border-width</span>:<span class="number">1px</span>;</span><br><span class="line">	<span class="attribute">border-color</span>:<span class="built_in">rgba</span>(<span class="number">22</span>, <span class="number">33</span>, <span class="number">55</span>, <span class="number">0.38</span>);</span><br><span class="line">	<span class="attribute">color</span>:<span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">1</span>);</span><br><span class="line">	<span class="attribute">font-size</span>:<span class="number">18px</span>;</span><br><span class="line">&#125;</span><br><span class="line">QPushButton::hover</span><br><span class="line">&#123;</span><br><span class="line">	background-color:<span class="built_in">rgba</span>(<span class="number">27</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">1</span>);</span><br><span class="line">	<span class="attribute">border-radius</span>: <span class="number">4px</span>;  </span><br><span class="line">	<span class="attribute">border-width</span>:<span class="number">1px</span>;</span><br><span class="line">	<span class="attribute">border</span>: <span class="number">2px</span> solid <span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">QScrollBar </span><br><span class="line">&#123;</span><br><span class="line">    <span class="attribute">background-color</span>:<span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">50</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*下面这两个是约束了滚动条默认的宽、高*/</span></span><br><span class="line">QScrollBar:vertical</span><br><span class="line">&#123;</span><br><span class="line">	width:<span class="number">18px</span>;</span><br><span class="line">&#125;</span><br><span class="line">QScrollBar:horizontal</span><br><span class="line">&#123;</span><br><span class="line">	height:<span class="number">18px</span>;</span><br><span class="line">&#125;</span><br><span class="line">QScrollBar::handle:horizontal </span><br><span class="line">&#123;</span><br><span class="line">    background-color: <span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">125</span>);</span><br><span class="line">    <span class="attribute">min-height</span>: <span class="number">20px</span>;</span><br><span class="line">	<span class="attribute">max-height</span>:<span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QScrollBar::handle:vertical</span><br><span class="line">&#123;</span><br><span class="line">    background-color: <span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">125</span>);</span><br><span class="line">    <span class="attribute">min-width</span>: <span class="number">20px</span>;</span><br><span class="line">	<span class="attribute">max-width</span>:<span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QScrollBar::add-page</span><br><span class="line">&#123;</span><br><span class="line">    background-color: transparent;</span><br><span class="line">&#125;</span><br><span class="line">QScrollBar::sub-page</span><br><span class="line">&#123;</span><br><span class="line">    background-color: transparent;</span><br><span class="line">&#125;</span><br><span class="line">QScrollBar::add-line</span><br><span class="line">&#123;</span><br><span class="line">    background-color: transparent;</span><br><span class="line">&#125;</span><br><span class="line">QScrollBar::sub-line</span><br><span class="line">&#123;</span><br><span class="line">    background-color: transparent;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="滚动条QScrollBar"><a href="#滚动条QScrollBar" class="headerlink" title="滚动条QScrollBar"></a><a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E6%BB%9A%E5%8A%A8%E6%9D%A1&spm=1001.2101.3001.7020">滚动条</a>QScrollBar</h3><p><img src="/2021/06/27/Qt/v2-987fe00992f1df1ef9e40771bfa7cb2b_720w.webp" alt="img"></p>
<h4 id="example-1"><a href="#example-1" class="headerlink" title="example 1"></a>example 1</h4><p>我们现在给QScrollBar设置StyleSheet：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setStyleSheet</span>(<span class="string">&quot;QScrollBar&#123;&quot;</span></span><br><span class="line">              <span class="string">&quot;background-color:#3e3e3e;&quot;</span></span><br><span class="line">              <span class="string">&quot;border-radius:4px;&#125;&quot;</span></span><br><span class="line">              <span class="string">&quot;QScrollBar::handle:horizontal&#123; background: #909090;border-radius:4px;&#125;&quot;</span></span><br><span class="line">              <span class="string">&quot;QScrollBar::add-page:horizontal&#123;background-color:transparent;&#125;&quot;</span></span><br><span class="line">              <span class="string">&quot;QScrollBar::sub-page:horizontal&#123;background-color:transparent;&#125;&quot;</span></span><br><span class="line">              <span class="string">&quot;QScrollBar::sub-line:horizontal&#123;background-color:transparent;&#125;&quot;</span></span><br><span class="line">              <span class="string">&quot;QScrollBar::add-line:horizontal&#123;background-color:transparent;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>其中，设置<strong>QScrollBar的border-radius</strong>，来设置其滑动条背景的一个倒圆角数值。</p>
<p>设置<strong>QScrollBar</strong>中<strong>handle</strong>的<strong>border-radius</strong>，来设置其滑动条中滑块背景的一个倒圆角数值。</p>
<p>而<strong>add-page</strong>*<em>sub-page、add-line</em>***sub-line**是将滑块两端的背景颜色以及边缘两端的两个按钮设置为透明，这样就可以只看到滑块以及背景的颜色。</p>
<p>*<em><strong><strong>如果border-radius等于滑动条的高度的一半，则边缘会是一个半圆。</strong></strong></em></p>
<p>如果我们不将add-page\sub-page、add-line\sub-line的背景颜色设置为透明，滑动条的圆角效果就会变成比较糟糕。</p>
<p>如果我们把QSS改成这样，add-page\sub-page具备背景色。</p>
<p>（ScrollBar的高度是20px,现在border-radius设置为10px，即半圆效果）</p>
<p><img src="/2021/06/27/Qt/v2-880a3638e5cea698aeda64ba64d61fe0_720w.webp" alt="img"></p>
<p><img src="/2021/06/27/Qt/v2-6e82b59c44a19f5c7add2542363875d0_720w.webp" alt="img"></p>
<p><img src="/2021/06/27/Qt/v2-453dbe562ba0624703bf731911b25a81_720w.webp" alt="img"></p>
<p>我们发现如果sub-page设置了颜色，没有设置border-radius,那左侧滑动条边缘还是一个直角。如上图的1号区域。</p>
<p>如果add-page设置了颜色，并且设置了border-radius,那么这个add-page的区域都会变成一个圆角矩形。</p>
<p>这时候和原本的handle的圆角就冲突了，所以要实现比较好的圆角滑动条效果，则需要把add-page/sub-page的背景色设置为透明。</p>
<p>如果我们把QSS改成这样，add-line\sub-line具备背景色。</p>
<p><img src="/2021/06/27/Qt/v2-c5e9ad226f1df9a32f8e94c668af745d_720w.webp" alt="img"></p>
<p><img src="/2021/06/27/Qt/v2-d39b5f77dddcaf15b16edec2d64a1759_720w.webp" alt="img"></p>
<p><img src="/2021/06/27/Qt/v2-8b0758dbf7b07b90be7c7a7a275bddac_720w.webp" alt="img"></p>
<p>我们发现add-line\sub-line具备颜色之后，将会使得滑动条两端变成直角矩形，所以这两端的控制器的背景色也需要设置成透明。</p>
<p><strong><em>*</em>*注意：但是有一个情况，在我写这个文章的时候发现，如果你系统支持的透明色是黑色，那以上通过设置add-line\sub-line的样式表的方法，也没办法很好的支持圆角边框的效果。</strong></p>
<p><img src="/2021/06/27/Qt/v2-a4747b15c6d3cf89cf26960807bb9a53_720w.webp" alt="img"></p>
<p>我们发现<strong>add-line\sub-line</strong>的区域被设置成透明色之后，呈现了黑色，使得界面效果是那种会被UX设计师捶的效果。</p>
<p>这个问题在QScrollBar上面我还没有比较好的解决方案。</p>
<p>所以现在我们尝试使用Qt的QSlider控件来实现。</p>
<p><img src="/2021/06/27/Qt/v2-c667b1ff0deea7bc82448fffd299ed5c_720w.webp" alt="img"></p>
<p><img src="/2021/06/27/Qt/v2-5a777cd0342432ab31ef8bede94d34ed_720w-170237585294639.webp" alt="img"></p>
<p>QSlider的QSS选择器部件</p>
<p>我们现在给QSlider设置StyleSheet：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">setStyleSheet(&quot;QSlider::groove&#123;<span class="string">&quot;</span></span><br><span class="line"><span class="string">              &quot;</span>background-color:<span class="number">#3e3e3e</span>;&quot;</span><br><span class="line">              &quot;<span class="attribute">border-radius</span>:<span class="number">10px</span>;&#125;&quot;</span><br><span class="line">              &quot;QSlider::handle:horizontal&#123;<span class="string">&quot;</span></span><br><span class="line"><span class="string">              &quot;</span>background-color: <span class="number">#909090</span>;&quot;</span><br><span class="line">              &quot;<span class="attribute">border-radius</span>:<span class="number">10px</span>;&quot;</span><br><span class="line">　　　　　　　&quot;<span class="attribute">width</span>:<span class="number">60px</span>;&#125;&quot;</span><br><span class="line">              &quot;QSlider::add-page&#123;background-color:transparent;&#125;&quot;</span><br><span class="line">              &quot;QSlider::sub-page&#123;background-color:transparent;&#125;&quot;)</span><br></pre></td></tr></table></figure>

<p>其中，QSlider不需要设置background-color，因为会被<strong>groove</strong>的背景色覆盖。</p>
<p>并且可以通过设置<strong>QSlider::handle:horizontal</strong>来设置滑块的大小，实现和QScrollBar通过设置singleStep来控制滑块大小的效果一样，并且更加灵活。</p>
<p>其他的QSS设置和QScrollBar的思路是类似的。</p>
<p>QSS设置完之后的效果如下，看起来很设计图相差不会太大。</p>
<p><img src="/2021/06/27/Qt/v2-9e9d48c5617f443984a164a948bb404a_720w.webp" alt="img"></p>
<p>QScrollBar的基类和QSlider的基类是一样的，都是QAbstractSlider,所以基本上滑动控件的基本操作，QScrollBar有的，都可以在QSlider里面实现。</p>
<p>所以使用QSlider来实现一个圆角的滑动条会更加灵活方便一些。</p>
<h4 id="example-2"><a href="#example-2" class="headerlink" title="example 2"></a>example 2</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">  QScrollBar:horizontal &#123;</span><br><span class="line">/*整个滑动区域*/</span><br><span class="line">    border:<span class="number">5px</span> solid green;</span><br><span class="line">      <span class="attribute">background</span>: cyan;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">35px</span>;</span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">0px</span> <span class="number">60px</span> <span class="number">0</span> <span class="number">60px</span>;<span class="comment">/*左右留边，给左右箭头按钮留出空间*/</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  QScrollBar::handle:horizontal &#123;</span><br><span class="line">/*滑块*/</span><br><span class="line">border:<span class="number">3px</span> solid white;</span><br><span class="line">      <span class="attribute">background</span>: gray;</span><br><span class="line">      <span class="attribute">min-width</span>: <span class="number">5px</span>;</span><br><span class="line"> </span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">  QScrollBar::add-line:horizontal &#123;</span><br><span class="line">/*水平+按钮，也即右按钮*/</span><br><span class="line">      background: blue;</span><br><span class="line">      subcontrol-<span class="attribute">position</span>: right;</span><br><span class="line">      subcontrol-origin: margin;</span><br><span class="line">      <span class="attribute">border</span>: <span class="number">2px</span> solid black;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">26px</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">	<span class="attribute">right</span>:<span class="number">0px</span>;<span class="comment">/*右按钮的右边紧贴控件的边沿*/</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  QScrollBar::sub-line:horizontal &#123;</span><br><span class="line">/*水平-按钮，也即左按钮，点击一下滚动一行*/</span><br><span class="line">      background: magenta;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">26px</span>;</span><br><span class="line">      subcontrol-<span class="attribute">position</span>: top left;</span><br><span class="line">      subcontrol-origin: margin;</span><br><span class="line">      <span class="attribute">border</span>: <span class="number">2px</span> solid black;</span><br><span class="line">      <span class="attribute">left</span>:<span class="number">10px</span>;<span class="comment">/*左按钮的左边不靠边*/</span></span><br><span class="line"> </span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  QScrollBar<span class="selector-pseudo">:left</span>-arrow:horizontal, QScrollBar::right-arrow:horizontal &#123;</span><br><span class="line">   /*左右按钮里面的箭头符号*/   </span><br><span class="line">width: <span class="number">8px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">8px</span>;</span><br><span class="line">      <span class="attribute">background</span>: white;</span><br><span class="line">	</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  QScrollBar::add-page:horizontal, QScrollBar::sub-page:horizontal &#123;</span><br><span class="line">/*滑块左右两侧的空白区域，点击一下滚动一页*/</span><br><span class="line">      border: <span class="number">3px</span> solid red;</span><br><span class="line"><span class="attribute">background</span>: transparent;</span><br><span class="line"> </span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2021/06/27/Qt/54226e54c33740679896fbbc4251f9e3.png" alt="img"></p>
<h4 id="myuse"><a href="#myuse" class="headerlink" title="myuse"></a>myuse</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">QScrollBar </span><br><span class="line">&#123;</span><br><span class="line">    <span class="attribute">background-color</span>:<span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">50</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QScrollBar::handle:horizontal </span><br><span class="line">&#123;</span><br><span class="line">    background-color: <span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">125</span>);</span><br><span class="line">    <span class="attribute">min-width</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QScrollBar::handle:vertical</span><br><span class="line">&#123;</span><br><span class="line">    background-color: <span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">125</span>);</span><br><span class="line">    <span class="attribute">min-height</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QScrollBar::add-page</span><br><span class="line">&#123;</span><br><span class="line">    background-color: transparent;</span><br><span class="line">&#125;</span><br><span class="line">QScrollBar::sub-page</span><br><span class="line">&#123;</span><br><span class="line">    background-color: transparent;</span><br><span class="line">&#125;</span><br><span class="line">QScrollBar::add-line</span><br><span class="line">&#123;</span><br><span class="line">    background-color: transparent;</span><br><span class="line">&#125;</span><br><span class="line">QScrollBar::sub-line</span><br><span class="line">&#123;</span><br><span class="line">    background-color: transparent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="QProgressBar"><a href="#QProgressBar" class="headerlink" title="QProgressBar"></a>QProgressBar</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># 设置QProgressBar的样式</span><br><span class="line">progress_bar = QProgressBar()</span><br><span class="line">style_sheet = &quot;&quot;&quot;</span><br><span class="line">    QProgressBar &#123;</span><br><span class="line">        <span class="attribute">border</span>: <span class="number">1px</span> solid grey;</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">        <span class="attribute">background-color</span>: grey;</span><br><span class="line">        <span class="attribute">text-align</span>: center;</span><br><span class="line">    &#125;</span><br><span class="line">    QProgressBar::chunk &#123;</span><br><span class="line">        background-color: <span class="number">#2453A4</span>;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">20px</span>; <span class="comment">/* just a placeholder value */</span></span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">0.5px</span>;</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">progress_bar<span class="selector-class">.setStyleSheet</span>(style_sheet)</span><br></pre></td></tr></table></figure>

<h4 id="myuse-1"><a href="#myuse-1" class="headerlink" title="myuse"></a>myuse</h4><p><img src="/2021/06/27/Qt/image-20231212141251841.png" alt="image-20231212141251841"></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">QProgressBar </span><br><span class="line">&#123;</span><br><span class="line">	<span class="attribute">color</span>:<span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">255</span>);</span><br><span class="line">	<span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">rgba</span>(<span class="number">27</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">1</span>);</span><br><span class="line">	<span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">	<span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">27</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">1</span>);</span><br><span class="line">	<span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line">QProgressBar::chunk </span><br><span class="line">&#123;</span><br><span class="line">	background-color: <span class="built_in">rgba</span>(<span class="number">211</span>, <span class="number">248</span>, <span class="number">248</span>, <span class="number">100</span>);</span><br><span class="line">	<span class="attribute">width</span>: <span class="number">20px</span>; <span class="comment">/* just a placeholder value */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="设置Qwidget类背景方法总结"><a href="#设置Qwidget类背景方法总结" class="headerlink" title="设置Qwidget类背景方法总结"></a>设置Qwidget类背景方法总结</h3><h4 id="1、引言"><a href="#1、引言" class="headerlink" title="1、引言"></a>1、引言</h4><p>  在实现一个页面跳转功能时，选择PushButton或QWidget可以有效当作按钮，而Qwidget可以添加label或者其它控件，自定义程度更高，因此本文给出几种给Qwidget绘制背景图片方法。</p>
<h4 id="2、使用样式表（setStyleSheet）"><a href="#2、使用样式表（setStyleSheet）" class="headerlink" title="2、使用样式表（setStyleSheet）"></a>2、使用样式表（setStyleSheet）</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ui-&gt;widget-&gt;setStyleSheet(&quot;border-image:url(://MainButton1.png)&quot;);</span><br></pre></td></tr></table></figure>

<p>  该种方法简单高效，可以快速实现Qwidget背景图片的切换。</p>
<h4 id="3、QPalette"><a href="#3、QPalette" class="headerlink" title="3、QPalette"></a>3、QPalette</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QPalette pal =<span class="keyword">this</span>-&gt;<span class="built_in">palette</span>();</span><br><span class="line">pal.<span class="built_in">setBrush</span>(QPalette::Background,<span class="built_in">QBrush</span>(<span class="built_in">QPixmap</span>(<span class="string">&quot;:/bg.jpg&quot;</span>)));</span><br><span class="line"><span class="built_in">setPalette</span>(pal);</span><br></pre></td></tr></table></figure>

<p>  首先获得Widget调色板，再设置Brush，最后将设置应用到Widget中。<br>  若显示不出来加上setAutoFillBackground(true);</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置背景图片</span></span><br><span class="line"><span class="built_in">setAutoFillBackground</span>(<span class="literal">true</span>);    <span class="comment">// 这句要加上, 否则可能显示不出背景图.</span></span><br><span class="line">QPalette palette = <span class="keyword">this</span>-&gt;<span class="built_in">palette</span>();</span><br><span class="line"><span class="comment">//palette.setColor(QPalette::Window, Qt::red);  // 设置背景色</span></span><br><span class="line"><span class="comment">//palette.setBrush(this-&gt;backgroundRole(), Qt::black);// 设置背景色</span></span><br><span class="line">palette.<span class="built_in">setBrush</span>(QPalette::Window,</span><br><span class="line">        <span class="built_in">QBrush</span>(<span class="built_in">QPixmap</span>(<span class="string">&quot;:/image/bkg.png&quot;</span>).<span class="built_in">scaled</span>(    <span class="comment">// 缩放背景图.</span></span><br><span class="line">            <span class="keyword">this</span>-&gt;<span class="built_in">size</span>(),</span><br><span class="line">            Qt::IgnoreAspectRatio,</span><br><span class="line">            Qt::SmoothTransformation)));    <span class="comment">// 使用平滑的缩放方式</span></span><br><span class="line"><span class="keyword">this</span>-&gt;<span class="built_in">setPalette</span>(palette);</span><br></pre></td></tr></table></figure>
<h4 id="4、paintEvent事件"><a href="#4、paintEvent事件" class="headerlink" title="4、paintEvent事件"></a>4、paintEvent事件</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Widget::paintEvent</span><span class="params">(QPaintEvent * ev)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">QPainter <span class="title">painter</span><span class="params">(<span class="keyword">this</span>)</span></span>;</span><br><span class="line">	painter.<span class="built_in">drawPixmap</span>(<span class="built_in">rect</span>(),<span class="built_in">QPixmap</span>(<span class="string">&quot;:/bg.jpg&quot;</span>),<span class="built_in">QRect</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>  使用drawPixmap方法绘制一个矩形，传入第三个参数QRect()表示整个矩形区域，使用需要在新的类中重写PaintEvent，不适用于子窗口中的Widget绘制。</p>
<h5 id="5、简洁方式"><a href="#5、简洁方式" class="headerlink" title="5、简洁方式"></a>5、简洁方式</h5><p>QLabel：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Widget::<span class="built_in">Widget</span>(QWidget *parent) :</span><br><span class="line">	<span class="built_in">QWidget</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">	m_lblBg = <span class="keyword">new</span> <span class="built_in">QLabel</span>(<span class="keyword">this</span>);</span><br><span class="line">	m_lblBg -&gt;<span class="built_in">setPixmap</span>(<span class="built_in">QPixmap</span>(<span class="string">&quot;:/bg.jpg&quot;</span>));</span><br><span class="line">	m_lblBg -&gt;<span class="built_in">setScaledContents</span>(<span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Widget::resizeEvent</span><span class="params">(QResizeEvent * ev)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	m_lblBg-&gt;<span class="built_in">resize</span>(<span class="keyword">this</span>-&gt;<span class="built_in">size</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  需要调用QLabel的setScaledContents(true)，否则会和使用qss效果相同，不过label可以显示动态图，因此这种方式也适用于动态界面。</p>
<p>QFrame：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QFrame *frame = <span class="keyword">new</span> <span class="built_in">QFrame</span>(<span class="keyword">this</span>);</span><br><span class="line">frame-&gt;<span class="built_in">setObjectName</span>(<span class="string">&quot;myframe&quot;</span>);</span><br><span class="line">frame-&gt;<span class="built_in">setGeometry</span>(<span class="keyword">this</span>-&gt;<span class="built_in">geometry</span>());</span><br><span class="line">frame-&gt;<span class="built_in">resize</span>(<span class="built_in">width</span>(),<span class="built_in">height</span>());</span><br><span class="line">frame-&gt;<span class="built_in">setStyleSheet</span>(<span class="string">&quot;QFrame#myframe&#123;border-image:url(:/image/bkg.png)&#125;&quot;</span> );</span><br></pre></td></tr></table></figure>

<p>  将label或frame通过Widget 的resizeEvent时间设置成和Widget一样，可以实现平铺效果，不过还是需要新建一个类，不适用子窗口。</p>
<h5 id="6、总结"><a href="#6、总结" class="headerlink" title="6、总结"></a>6、总结</h5><table>
<thead>
<tr>
<th>方法</th>
<th>自适应</th>
<th>动图</th>
<th>新建类</th>
</tr>
</thead>
<tbody><tr>
<td>Qss</td>
<td>是</td>
<td>否</td>
<td>否</td>
</tr>
<tr>
<td>QPalette</td>
<td>是</td>
<td>否</td>
<td>否</td>
</tr>
<tr>
<td>paintEvent</td>
<td>是</td>
<td>否</td>
<td>是</td>
</tr>
<tr>
<td>QLabel</td>
<td>是</td>
<td>是</td>
<td>是</td>
</tr>
<tr>
<td>QFrame</td>
<td>是</td>
<td>否</td>
<td>是</td>
</tr>
</tbody></table>
<h3 id="QPushButton"><a href="#QPushButton" class="headerlink" title="QPushButton"></a>QPushButton</h3><p>QPushButton样式表设置背景色 background-color无效的原因</p>
<p><img src="/2021/06/27/Qt/70.png" alt="img"> </p>
<p>想使背景色生效，必须要设置一下某个border属性，border-color、border-width等等任何一个跟border相关的属性都行。因为pushbutton的原生边界把背景色给覆盖住了。</p>
<h4 id="setFlat（TRUE）后，会取消凸出效果"><a href="#setFlat（TRUE）后，会取消凸出效果" class="headerlink" title="setFlat（TRUE）后，会取消凸出效果"></a>setFlat（TRUE）后，会取消凸出效果</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">对于QPushButton设置属性setFlat（TRUE）后，会取消凸出效果，但是点击后还会出现下陷效果，该如何让QPushButton点击后无下陷效果呢？</span><br><span class="line">可以试试stylesheet。</span><br><span class="line">button-&gt;setStyleSheet(&quot;QPushButton&#123;border:none;&#125;&quot;);</span><br></pre></td></tr></table></figure>

<h4 id="myuse-2"><a href="#myuse-2" class="headerlink" title="myuse"></a>myuse</h4><p><img src="/2021/06/27/Qt/image-20231212141320048.png" alt="image-20231212141320048"></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">QPushButton</span><br><span class="line">&#123;</span><br><span class="line">	<span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">:/slices/矩形 46(9</span>).png);</span><br><span class="line">	<span class="attribute">border-radius</span>: <span class="number">4px</span>;  </span><br><span class="line">	<span class="attribute">border-width</span>:<span class="number">1px</span>;</span><br><span class="line">	<span class="attribute">border-color</span>:<span class="built_in">rgba</span>(<span class="number">22</span>, <span class="number">33</span>, <span class="number">55</span>, <span class="number">0.38</span>);</span><br><span class="line">	<span class="attribute">color</span>:<span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">1</span>);</span><br><span class="line">	<span class="attribute">font-size</span>:<span class="number">18px</span>;</span><br><span class="line">&#125;</span><br><span class="line">QPushButton::hover</span><br><span class="line">&#123;</span><br><span class="line">	background-color:<span class="built_in">rgba</span>(<span class="number">27</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">1</span>);</span><br><span class="line">	<span class="attribute">border-radius</span>: <span class="number">4px</span>;  </span><br><span class="line">	<span class="attribute">border-width</span>:<span class="number">1px</span>;</span><br><span class="line">	<span class="attribute">border</span>: <span class="number">2px</span> solid <span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="QCalendarWidget"><a href="#QCalendarWidget" class="headerlink" title="QCalendarWidget"></a>QCalendarWidget</h3><p><img src="/2021/06/27/Qt/QSS-Subcontrol-CalendarWidget.png" alt="img"></p>
<p><img src="/2021/06/27/Qt/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0NzIzOTM3,size_16,color_FFFFFF,t_70#pic_center.png" alt="img"></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*日历部分的背景颜色*/</span></span><br><span class="line"><span class="selector-id">#qt_calendar_calendarview</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">10</span>, <span class="number">95</span>, <span class="number">189</span>, <span class="number">1</span>);	<span class="comment">/*背景颜色*/</span></span><br><span class="line">    <span class="attribute">font</span>: <span class="number">16px</span>;								<span class="comment">/*字体*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*这是日历部分的另外一个写法*/</span></span><br><span class="line">QCalendarWidget QTableView </span><br><span class="line">&#123;</span><br><span class="line">    alternate-<span class="attribute">background-color</span>:<span class="built_in">rgba</span>(<span class="number">10</span>, <span class="number">95</span>, <span class="number">189</span>, <span class="number">1</span>);  <span class="comment">/* day name/week number background */</span></span><br><span class="line"> 	<span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*标题栏的样式*/</span></span><br><span class="line">QCalendarWidget QWidget<span class="selector-id">#qt_calendar_navigationbar</span></span><br><span class="line">&#123; </span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">4</span>, <span class="number">51</span>, <span class="number">114</span>, <span class="number">1</span>); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*上一月的箭头的样式*/</span></span><br><span class="line">QCalendarWidget QToolButton<span class="selector-id">#qt_calendar_prevmonth</span> </span><br><span class="line">&#123;</span><br><span class="line">    qproperty-<span class="attribute">icon</span>: <span class="built_in">url</span>(<span class="string">:/images/images/B.png</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*下一月的箭头的图标*/</span></span><br><span class="line">QCalendarWidget QToolButton<span class="selector-id">#qt_calendar_nextmonth</span> </span><br><span class="line">&#123;</span><br><span class="line">    qproperty-<span class="attribute">icon</span>: <span class="built_in">url</span>(<span class="string">:/images/images/A.png</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*这里是激活的日期的样式也就是当前这个月*/</span></span><br><span class="line">QCalendarWidget QAbstractItemView<span class="selector-pseudo">:enabled</span> </span><br><span class="line"> &#123;</span><br><span class="line">   	<span class="attribute">font-size</span>:<span class="number">24px</span>;  </span><br><span class="line">   	<span class="attribute">color</span>: <span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>); </span><br><span class="line"><span class="comment">/* 这里是你选择一个日期时的样式，包括背景和字体颜色</span></span><br><span class="line"><span class="comment">   selection-background-color: rgb(64, 64, 64); </span></span><br><span class="line"><span class="comment">   selection-color: rgb(0, 255, 0); */</span></span><br><span class="line"> &#125;</span><br><span class="line">  </span><br><span class="line"> <span class="comment">/*这里是其他月份的样式*/</span></span><br><span class="line">QCalendarWidget QAbstractItemView<span class="selector-pseudo">:disabled</span> </span><br><span class="line">&#123; </span><br><span class="line">	<span class="attribute">color</span>: <span class="built_in">rgb</span>(<span class="number">64</span>, <span class="number">64</span>, <span class="number">64</span>); </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QTextCharFormat format = calendarWidget-&gt;<span class="built_in">weekdayTextFormat</span>(Qt::Saturday);</span><br><span class="line">format.<span class="built_in">setForeground</span>(<span class="built_in">QBrush</span>(Qt::white, Qt::SolidPattern));</span><br><span class="line">calendarWidget-&gt;<span class="built_in">setWeekdayTextFormat</span>(Qt::Saturday, format);</span><br></pre></td></tr></table></figure>

<h4 id="标题背景"><a href="#标题背景" class="headerlink" title="标题背景"></a>标题背景</h4><p><img src="/2021/06/27/Qt/3bae3e3020764776a38d28fb78890d28.png" alt="img"></p>
<p>​    标题背景： </p>
<p><img src="/2021/06/27/Qt/011e9a4d1c264f1d888fa55438d87208.png" alt="img"></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#qt_calendar_navigationbar</span>&#123;</span><br><span class="line">        <span class="attribute">font</span>:<span class="number">18px</span> Microsoft YaHei;</span><br><span class="line">        <span class="attribute">background-color</span>:<span class="built_in">rgb</span>(<span class="number">196</span>, <span class="number">196</span>, <span class="number">249</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 如果需要将年月选择栏背景颜色和日期背景颜色设置为同一个颜色，可以选择设置QWidget。</p>
<p><img src="/2021/06/27/Qt/b4c3df49d05e4c34b94cad1f73b95a46.png" alt="img"><img src="/2021/06/27/Qt/d758ff909cb24010a9daf2aa2b13acc5.png" alt="img"></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QCalendarWidget QWidget&#123;</span><br><span class="line">        <span class="attribute">background-color</span>:<span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">153</span>);    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="上一个月、下一个月跳转图标"><a href="#上一个月、下一个月跳转图标" class="headerlink" title="上一个月、下一个月跳转图标"></a>上一个月、下一个月跳转图标</h4><p> 如果设置了QDateEdit的时间范围（本例：当前时间），下一个月按钮样式自动回变成灰色的不可点击状态（上一个月图标同理），不需要单独去设置上一个月、下一个月的不可点击状态样式。</p>
<p><img src="/2021/06/27/Qt/0dc10133aaaa4f19b3767e988bc3f386.png" alt="img"><img src="/2021/06/27/Qt/e14057f812bc4bd1a436ce877f70b455.png" alt="img"></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#qt_calendar_prevmonth</span>&#123;</span><br><span class="line">        qproperty-<span class="attribute">icon</span>:<span class="built_in">url</span>(<span class="string">:/Picture/iconGate_blue.png</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="selector-id">#qt_calendar_nextmonth</span>&#123;</span><br><span class="line">        qproperty-<span class="attribute">icon</span>:<span class="built_in">url</span>(<span class="string">:/Picture/iconGate_red.png</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="月份选择"><a href="#月份选择" class="headerlink" title="月份选择"></a>月份选择</h4><p>分为两个部分，当前月的正常状态与选择状态，月份下拉框。        </p>
<p> <img src="/2021/06/27/Qt/ecb1cd1163014f33bce1aaddb6321449.png" alt="img"><img src="/2021/06/27/Qt/fd35446aac2a428fb852c759ac0d09bc.png" alt="img"></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">QToolButton<span class="selector-id">#qt_calendar_monthbutton</span>&#123;</span><br><span class="line">        <span class="attribute">color</span>:<span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">51</span>, <span class="number">153</span>);</span><br><span class="line">        <span class="attribute">background-color</span>:<span class="built_in">rgb</span>(<span class="number">244</span>, <span class="number">244</span>, <span class="number">244</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">QCalendarWidget QMenu&#123;</span><br><span class="line">        <span class="attribute">font</span>:<span class="number">18px</span> Microsoft YaHei;</span><br><span class="line">        <span class="attribute">left</span>:<span class="number">5px</span>;</span><br><span class="line">        <span class="attribute">color</span>:<span class="built_in">rgb</span>(<span class="number">0</span>, <span class="number">128</span>, <span class="number">255</span>);</span><br><span class="line">        <span class="attribute">background-color</span>:<span class="built_in">rgb</span>(<span class="number">196</span>, <span class="number">196</span>, <span class="number">249</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="年份选择"><a href="#年份选择" class="headerlink" title="年份选择"></a>年份选择</h4><p>修改样式其实就是QSpinBox修改样式。</p>
<p><img src="/2021/06/27/Qt/111187fbae4b47d1ad5036899ba4e6d8-170237580828119.png" alt="img"><img src="/2021/06/27/Qt/8d394762d4ca48f8968d745e676ea436-170237579561614.png" alt="img"></p>
<p><img src="/2021/06/27/Qt/f8e35567fe6241a6b545a22fe0cf890f.png" alt="img"><img src="/2021/06/27/Qt/18bb4da6d45946a9a99244d36d636636.png" alt="img"></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*年份选择：正常状态*/</span></span><br><span class="line">QToolButton<span class="selector-id">#qt_calendar_yearbutton</span>&#123;</span><br><span class="line">        <span class="attribute">color</span>:<span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">51</span>, <span class="number">153</span>);</span><br><span class="line">        <span class="attribute">background-color</span>:<span class="built_in">rgb</span>(<span class="number">244</span>, <span class="number">244</span>, <span class="number">244</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*年份选择:修改时*/</span></span><br><span class="line">QSpinBox<span class="selector-id">#qt_calendar_yearedit</span>&#123;</span><br><span class="line">        <span class="attribute">font</span>:<span class="number">18px</span> Microsoft YaHei;</span><br><span class="line">        <span class="attribute">color</span>:<span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">178</span>, <span class="number">102</span>);</span><br><span class="line">        <span class="attribute">background</span>:<span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">209</span>, <span class="number">204</span>);                  <span class="comment">/*文本框背景颜色*/</span></span><br><span class="line">        selection-<span class="attribute">color</span>:<span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>);             <span class="comment">/*选中字体颜色*/</span></span><br><span class="line">        selection-<span class="attribute">background-color</span>:<span class="built_in">rgb</span>(<span class="number">204</span>, <span class="number">153</span>, <span class="number">255</span>);  <span class="comment">/*选中背景颜色*/</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">/*年份选择:向上箭头*/</span></span><br><span class="line">QSpinBox<span class="selector-id">#qt_calendar_yearedit</span>::up-arrow&#123;</span><br><span class="line">        image:<span class="built_in">url</span>(<span class="string">:/Picture/44.png</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*年份选择:向下箭头*/</span></span><br><span class="line">QSpinBox<span class="selector-id">#qt_calendar_yearedit</span>::down-arrow&#123;</span><br><span class="line">        image:<span class="built_in">url</span>(<span class="string">:/Picture/44.png</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">/*年份选择:向上图标*/</span></span><br><span class="line">QSpinBox<span class="selector-id">#qt_calendar_yearedit</span>::up-button&#123;</span><br><span class="line">        /*border-image:<span class="built_in">url</span>(<span class="string">:/Picture/top.png</span>);*/</span><br><span class="line">        <span class="attribute">color</span>:<span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">153</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*年份选择:向下图标*/</span></span><br><span class="line">QSpinBox<span class="selector-id">#qt_calendar_yearedit</span>::down-button&#123;</span><br><span class="line">        /*border-image:<span class="built_in">url</span>(<span class="string">:/Picture/bottom.png</span>);*/</span><br><span class="line">        <span class="attribute">color</span>:<span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">153</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="周一到周末栏"><a href="#周一到周末栏" class="headerlink" title="周一到周末栏"></a>周一到周末栏</h4><p>修改字体颜色、背景色。</p>
<p>修改背景色。周一到周五字体的颜色和日期当中周一到周五的颜色是同步的设置的，周六和周末的字体颜色和日期当中的周六周末的颜色是同步设置的。如果在此处修改字体颜色，后续就不要设置日期当中的字体颜色了，否则，日期当中的周一到周五的颜色设置会覆盖此处的字体颜色设置。</p>
<p><img src="/2021/06/27/Qt/8dd13fc785ad40bca0e3919ec5d19f1b.png" alt="img"><img src="/2021/06/27/Qt/a298120c21b240518c7dbb971959a32b.png" alt="img"></p>
<p><img src="/2021/06/27/Qt/dfe472dc52e140558800d446e6935d9d.png" alt="img"></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QCalendarWidget QTableView</span><br><span class="line">&#123;</span><br><span class="line">        alternate-background-color:<span class="built_in">rgb</span>(<span class="number">204</span>, <span class="number">229</span>, <span class="number">255</span>);</span><br><span class="line">        color:<span class="built_in">rgb</span>(<span class="number">0</span>, <span class="number">128</span>, <span class="number">255</span>);     <span class="comment">/*字体颜色*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 周六周末的颜色是单独在代码里面设置的，不在QSS里。</p>
<p><img src="/2021/06/27/Qt/672b9675c09e49d9a0a59c22e46927dc.png" alt="img"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QCalendarWidget *calendar = ui-&gt;dateEdit_timeEnd-&gt;<span class="built_in">calendarWidget</span>();</span><br><span class="line">QTextCharFormat weekendFormat;</span><br><span class="line">weekendFormat.<span class="built_in">setForeground</span>(<span class="built_in">QBrush</span>(<span class="built_in">QColor</span>(<span class="number">153</span>, <span class="number">51</span>, <span class="number">255</span>)));</span><br><span class="line">calendar-&gt;<span class="built_in">setWeekdayTextFormat</span>(Qt::Saturday, weekendFormat);</span><br><span class="line">calendar-&gt;<span class="built_in">setWeekdayTextFormat</span>(Qt::Sunday, weekendFormat);</span><br></pre></td></tr></table></figure>

<h4 id="日期栏背景色"><a href="#日期栏背景色" class="headerlink" title="日期栏背景色"></a>日期栏背景色</h4><p><img src="/2021/06/27/Qt/b00091c1efe445b3bfbe0fce9201e0b8.png" alt="img"><img src="/2021/06/27/Qt/7697c67f750a4afb8a7e431786f98bef.png" alt="img"></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#qt_calendar_calendarview</span>&#123;</span><br><span class="line">        <span class="attribute">background-color</span>:<span class="built_in">rgb</span>(<span class="number">229</span>, <span class="number">229</span>, <span class="number">252</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*选中月日期*/</span></span><br><span class="line">QCalendarWidget QAbstractItemView<span class="selector-pseudo">:enabled</span>&#123;</span><br><span class="line">        <span class="attribute">font</span>:<span class="number">18px</span> Microsoft YaHei;</span><br><span class="line">        <span class="attribute">color</span>:<span class="built_in">rgb</span>(<span class="number">0</span>, <span class="number">204</span>, <span class="number">204</span>);</span><br><span class="line">        selection-<span class="attribute">color</span>:<span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>);           <span class="comment">/* 当前选中日期：字体颜色*/</span></span><br><span class="line">        selection-<span class="attribute">background-color</span>:<span class="built_in">rgb</span>(<span class="number">0</span>, <span class="number">102</span>, <span class="number">102</span>);  <span class="comment">/* 当前选中日期：背景颜色*/</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*非选中月日期*/</span></span><br><span class="line">QCalendarWidget QAbstractItemView<span class="selector-pseudo">:disabled</span>&#123;</span><br><span class="line">        <span class="attribute">color</span>:<span class="built_in">rgb</span>(<span class="number">204</span>, <span class="number">255</span>, <span class="number">204</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="myuse-3"><a href="#myuse-3" class="headerlink" title="myuse"></a>myuse</h4><p><img src="/2021/06/27/Qt/image-20231212141349546.png" alt="image-20231212141349546"><img src="/2021/06/27/Qt/image-20231212141358404.png" alt="image-20231212141358404"></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/*日历部分的背景颜色*/</span></span><br><span class="line"><span class="selector-id">#qt_calendar_calendarview</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">27</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">1</span>); 	<span class="comment">/*背景颜色*/</span></span><br><span class="line">    <span class="attribute">font</span>: <span class="number">16px</span>;								<span class="comment">/*字体*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*标题栏的样式*/</span></span><br><span class="line">QCalendarWidget QWidget<span class="selector-id">#qt_calendar_navigationbar</span></span><br><span class="line">&#123; </span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">27</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">1</span>); </span><br><span class="line">  <span class="attribute">color</span>:<span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">255</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*这是日历部分的另外一个写法*/</span></span><br><span class="line">QCalendarWidget QTableView </span><br><span class="line">&#123;</span><br><span class="line">    alternate-<span class="attribute">background-color</span>:<span class="built_in">rgba</span>(<span class="number">27</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">1</span>);  <span class="comment">/* day name/week number background */</span></span><br><span class="line"> 	<span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">255</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QDateTimeEdit&#123;</span><br><span class="line">	<span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">	<span class="attribute">border</span>:<span class="number">1px</span> solid  <span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">204</span>);</span><br><span class="line">&#125;</span><br><span class="line">QDateEdit<span class="selector-id">#dateEdit</span><span class="selector-pseudo">:drop</span>-down&#123;</span><br><span class="line">        <span class="attribute">border-image</span>:<span class="built_in">url</span>(<span class="string">:/Images/showcalendar.png</span>);</span><br><span class="line">        <span class="attribute">width</span>:<span class="number">40px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*上一月的箭头的样式*/</span></span><br><span class="line">QToolButton<span class="selector-id">#qt_calendar_prevmonth</span> &#123;</span><br><span class="line">	<span class="attribute">background</span>: transparent;</span><br><span class="line">	<span class="attribute">width</span>: <span class="number">40px</span>;</span><br><span class="line">	qproperty-<span class="attribute">icon</span>: <span class="built_in">url</span>(<span class="string">:/slices/Shape807.png</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*下一月的箭头的样式*/</span></span><br><span class="line">QToolButton<span class="selector-id">#qt_calendar_nextmonth</span> &#123;</span><br><span class="line">	<span class="attribute">background</span>: transparent;</span><br><span class="line">	<span class="attribute">width</span>: <span class="number">40px</span>;</span><br><span class="line">	qproperty-<span class="attribute">icon</span>: <span class="built_in">url</span>(<span class="string">:/slices/Shape807-2.png</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*月份选择*/</span></span><br><span class="line">QToolButton<span class="selector-id">#qt_calendar_monthbutton</span> &#123;</span><br><span class="line">	<span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">27</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">1</span>);</span><br><span class="line">	<span class="attribute">padding-right</span>: <span class="number">20px</span>;</span><br><span class="line">	<span class="attribute">color</span>:<span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">255</span>);</span><br><span class="line">&#125;</span><br><span class="line">QCalendarWidget QMenu&#123;</span><br><span class="line">	<span class="comment">/*font:18px Microsoft YaHei;*/</span></span><br><span class="line">	<span class="attribute">left</span>:<span class="number">5px</span>;</span><br><span class="line">	<span class="attribute">color</span>:<span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">255</span>);</span><br><span class="line">	<span class="attribute">background-color</span>:<span class="built_in">rgba</span>(<span class="number">27</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*年份选择*/</span></span><br><span class="line">QToolButton<span class="selector-id">#qt_calendar_yearbutton</span> &#123;</span><br><span class="line">	<span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">27</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">1</span>);</span><br><span class="line">	<span class="attribute">color</span>:<span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">255</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*年份选择:修改时*/</span></span><br><span class="line">QSpinBox<span class="selector-id">#qt_calendar_yearedit</span>&#123;</span><br><span class="line">	<span class="attribute">color</span>:<span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">255</span>);</span><br><span class="line">	<span class="attribute">background</span>:<span class="built_in">rgba</span>(<span class="number">27</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">1</span>);                 <span class="comment">/*文本框背景颜色*/</span></span><br><span class="line">	selection-<span class="attribute">color</span>:<span class="built_in">r</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">255</span>);          <span class="comment">/*选中字体颜色*/</span></span><br><span class="line">	selection-<span class="attribute">background-color</span>:<span class="built_in">rgba</span>(<span class="number">27</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">1</span>); <span class="comment">/*选中背景颜色*/</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*年份选择:向上箭头*/</span></span><br><span class="line">QSpinBox<span class="selector-id">#qt_calendar_yearedit</span>::up-arrow&#123;</span><br><span class="line">        image:<span class="built_in">url</span>(<span class="string">:/slices/向上年份选择.png</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*年份选择:向下箭头*/</span></span><br><span class="line">QSpinBox<span class="selector-id">#qt_calendar_yearedit</span>::down-arrow&#123;</span><br><span class="line">        image:<span class="built_in">url</span>(<span class="string">:/slices/向下年份选择.png</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*年份选择:向上图标*/</span></span><br><span class="line">QSpinBox<span class="selector-id">#qt_calendar_yearedit</span>::up-button&#123;</span><br><span class="line">        /*border-image:<span class="built_in">url</span>(<span class="string">:/Picture/top.png</span>);*/</span><br><span class="line">        <span class="attribute">color</span>:<span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">153</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*年份选择:向下图标*/</span></span><br><span class="line">QSpinBox<span class="selector-id">#qt_calendar_yearedit</span>::down-button&#123;</span><br><span class="line">        /*border-image:<span class="built_in">url</span>(<span class="string">:/Picture/bottom.png</span>);*/</span><br><span class="line">        <span class="attribute">color</span>:<span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">153</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="QDateEdit样式"><a href="#QDateEdit样式" class="headerlink" title="QDateEdit样式"></a>QDateEdit样式</h3><h4 id="正常状态与选中状态"><a href="#正常状态与选中状态" class="headerlink" title="正常状态与选中状态"></a>正常状态与选中状态</h4><p><img src="/2021/06/27/Qt/e2f13aed47db45fea75cba8b5971237a.png" alt="img"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*正常状态*/</span></span><br><span class="line">QDateEdit#dateEdit_timeEnd&#123;</span><br><span class="line">        font:<span class="number">20</span>px Microsoft YaHei;</span><br><span class="line">        color:<span class="built_in">rgb</span>(<span class="number">32</span>, <span class="number">32</span>, <span class="number">32</span>);</span><br><span class="line">        background-color:<span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">204</span>, <span class="number">229</span>, <span class="number">80</span>);</span><br><span class="line">        border-color:<span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">153</span>, <span class="number">204</span>);</span><br><span class="line">        border-style:solid;</span><br><span class="line">        border-radius:<span class="number">10</span>px;</span><br><span class="line">        border-width:<span class="number">5</span>px;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*选中状态*/</span></span><br><span class="line">QDateEdit#dateEdit:focus&#123;</span><br><span class="line">        font:<span class="number">20</span>px Microsoft YaHei;</span><br><span class="line">        border-color:<span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">102</span>, <span class="number">178</span>);    <span class="comment">/*边框颜色*/</span></span><br><span class="line">        border-style:solid;                 <span class="comment">/*边框内容*/</span></span><br><span class="line">        border-radius:<span class="number">10</span>px;                 <span class="comment">/*边框圆角弧度*/</span></span><br><span class="line">        border-width:<span class="number">5</span>px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>日历下拉图标设置</p>
<p><img src="/2021/06/27/Qt/7f5470c6db0a44529d088995035c8f07-17023757570242.png" alt="img"></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">QDateEdit<span class="selector-id">#dateEdit</span><span class="selector-pseudo">:drop</span>-down&#123;</span><br><span class="line">        <span class="attribute">border-image</span>:<span class="built_in">url</span>(<span class="string">:/Picture/calendar-icon.png</span>);</span><br><span class="line">        <span class="attribute">width</span>:<span class="number">40px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="QComboBox"><a href="#QComboBox" class="headerlink" title="QComboBox"></a>QComboBox</h3><p><img src="/2021/06/27/Qt/image-20231212141510099.png" alt="image-20231212141510099"></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">QComboBox &#123;</span><br><span class="line">    	<span class="attribute">font-size</span>:<span class="number">16px</span>;</span><br><span class="line">        <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">rgb</span>(<span class="number">113</span>,<span class="number">140</span>,<span class="number">201</span>);</span><br><span class="line">        <span class="attribute">background-color</span>: transparent;</span><br><span class="line">		<span class="attribute">border-radius</span>:<span class="number">5px</span>;</span><br><span class="line">		<span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">255</span>);</span><br><span class="line">&#125;</span><br><span class="line">QComboBox<span class="selector-pseudo">:enabled</span> &#123;</span><br><span class="line">        <span class="attribute">color</span>:<span class="built_in">rgba</span>(<span class="number">240</span>, <span class="number">244</span>, <span class="number">252</span>, <span class="number">255</span>);</span><br><span class="line">&#125;</span><br><span class="line">QComboBox:!enabled &#123;</span><br><span class="line">        color:<span class="built_in">rgba</span>(<span class="number">240</span>, <span class="number">244</span>, <span class="number">252</span>, <span class="number">50</span>);</span><br><span class="line">&#125;</span><br><span class="line">QComboBox<span class="selector-pseudo">:enabled</span><span class="selector-pseudo">:hover</span>, QComboBox<span class="selector-pseudo">:enabled</span><span class="selector-pseudo">:focus</span> </span><br><span class="line">&#123;</span><br><span class="line">		<span class="attribute">color</span>:<span class="built_in">rgba</span>(<span class="number">240</span>, <span class="number">244</span>, <span class="number">252</span>, <span class="number">255</span>);</span><br><span class="line">        <span class="attribute">background-color</span>:<span class="built_in">rgba</span>(<span class="number">146</span>, <span class="number">170</span>, <span class="number">186</span>, <span class="number">75</span>);</span><br><span class="line">&#125;</span><br><span class="line">QComboBox::drop-down &#123;</span><br><span class="line">        border: none;</span><br><span class="line">        <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">146</span>, <span class="number">170</span>, <span class="number">186</span>, <span class="number">25</span>);</span><br><span class="line">		<span class="attribute">border-radius</span>:<span class="number">3px</span>;</span><br><span class="line">&#125;</span><br><span class="line">QComboBox::drop-down:hover &#123;</span><br><span class="line">        background-color: <span class="built_in">rgba</span>(<span class="number">146</span>, <span class="number">170</span>, <span class="number">186</span>, <span class="number">75</span>);</span><br><span class="line">&#125;</span><br><span class="line">QComboBox::down-arrow &#123;</span><br><span class="line">       image:<span class="built_in">url</span>(<span class="string">:/Images/downArrow.png</span>);</span><br><span class="line">&#125;</span><br><span class="line">QComboBox::down-arrow:on &#123;</span><br><span class="line">        /**top: <span class="number">1px</span>;**/</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QComboBox QAbstractItemView</span><br><span class="line">&#123;</span><br><span class="line">	<span class="attribute">background-color</span>: transparent;</span><br><span class="line">	<span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">255</span>);</span><br><span class="line">&#125;</span><br><span class="line">QComboBox QAbstractItemView::item &#123;</span><br><span class="line">        height: <span class="number">32px</span>;</span><br><span class="line">		<span class="attribute">background-color</span>: blue;</span><br><span class="line">&#125;</span><br><span class="line">QComboBox QAbstractItemView::item:selected &#123;</span><br><span class="line">        background-color: blue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="QMenu"><a href="#QMenu" class="headerlink" title="QMenu"></a>QMenu</h3><p><img src="/2021/06/27/Qt/image-20231212141626200.png" alt="image-20231212141626200"></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">QMenu&#123;</span><br><span class="line">	<span class="attribute">color</span>:<span class="built_in">rgb</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>);</span><br><span class="line">	<span class="attribute">background-color</span>:<span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">150</span>); </span><br><span class="line">	<span class="attribute">border</span>:<span class="number">0px</span>;</span><br><span class="line">	<span class="attribute">padding</span>:<span class="number">5px</span>;</span><br><span class="line">	<span class="attribute">margin</span>:<span class="number">6px</span>;</span><br><span class="line">&#125;</span><br><span class="line">QMenu::item&#123;</span><br><span class="line">    height:<span class="number">34px</span>;</span><br><span class="line">    <span class="attribute">width</span>:<span class="number">120px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>:<span class="number">20px</span>;</span><br><span class="line">	<span class="attribute">color</span>:<span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">232</span>, <span class="number">250</span>, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">QMenu::item:text &#123; </span><br><span class="line">	padding-left:<span class="number">10px</span>;</span><br><span class="line">	<span class="attribute">padding-right</span>:<span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line">QMenu::item:selected&#123; </span><br><span class="line">	color:<span class="built_in">rgb</span>(<span class="number">112</span>, <span class="number">197</span>, <span class="number">255</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="QIFW（Qt-Installer-Framework）"><a href="#QIFW（Qt-Installer-Framework）" class="headerlink" title="QIFW（Qt Installer Framework）"></a>QIFW（Qt Installer Framework）</h1><p>官网-<a target="_blank" rel="noopener" href="https://doc.qt.io/qtinstallerframework/ifw-overview.html">https://doc.qt.io/qtinstallerframework/ifw-overview.html</a></p>
<p><img src="/2021/06/27/Qt/image-20240206143605770.png" alt="image-20240206143605770"></p>
<p>组件信号-<a target="_blank" rel="noopener" href="https://doc.qt.io/qtinstallerframework/scripting-installer.html">https://doc.qt.io/qtinstallerframework/scripting-installer.html</a></p>
<p>所有默认界面-<a target="_blank" rel="noopener" href="https://doc.qt.io/qtinstallerframework/scripting-qinstaller.html">https://doc.qt.io/qtinstallerframework/scripting-qinstaller.html</a></p>
<p><strong>看了这么多，这两个是最有用的：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_39480297/article/details/132038981">https://blog.csdn.net/qq_39480297/article/details/132038981</a></strong></p>
<p><strong><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_34183232/article/details/118255975">https://blog.csdn.net/qq_34183232/article/details/118255975</a></strong></p>
<h2 id="环境构建"><a href="#环境构建" class="headerlink" title="环境构建"></a>环境构建</h2><p>GIFW下载地址：<a target="_blank" rel="noopener" href="https://download.qt.io/official_releases/qt-installer-framework/">https://download.qt.io/official_releases/qt-installer-framework/</a></p>
<p><img src="/2021/06/27/Qt/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjg5MjEwMQ==,size_16,color_FFFFFF,t_70.png" alt="img"></p>
<p>bin：提供了一些基本的工具，比如打包要用的 binarycreator。<br>doc：包含了相应的帮助文档，有助于更好的掌握 Qt IFW。<br>examples：有各种各样的示例，方便我们学习研究。<br>Licenses：许可协议。</p>
<p><img src="/2021/06/27/Qt/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mjg5MjEwMQ==,size_16,color_FFFFFF,t_70-17072022583692.png" alt="img"></p>
<h3 id="添加到Qt-Creator帮助文档"><a href="#添加到Qt-Creator帮助文档" class="headerlink" title="添加到Qt Creator帮助文档"></a>添加到Qt Creator帮助文档</h3><p>打开 Qt Creator，选择【工具】–&gt;【选项】–&gt;【帮助】–&gt;【文档】–&gt;【添加】<br>选择Qt IFW安装目录doc下的ifw.qch文件。</p>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">binarycreator -c config\config.xml -p packages MySoftwareInstaller.exe -v</span><br></pre></td></tr></table></figure>



<h2 id="离线安装文件结构"><a href="#离线安装文件结构" class="headerlink" title="离线安装文件结构"></a>离线安装文件结构</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">--Installer</span><br><span class="line">  |__config（全局配置）</span><br><span class="line">     |__config.xml</span><br><span class="line">     |__control.qs</span><br><span class="line">  |__packages</span><br><span class="line">     |__com.root(根目录，主包)</span><br><span class="line">        |__data</span><br><span class="line">           |__可执行程序及所有的库文件</span><br><span class="line">           |__uninstallscript.qs</span><br><span class="line">        |__meta</span><br><span class="line">           |__installscript.js</span><br><span class="line">           |__package.xml</span><br><span class="line">           |__license.txt</span><br><span class="line">     |__com.root.foundation（多包）</span><br><span class="line">   		|__data</span><br><span class="line">           |__第三方安装包</span><br><span class="line">        |__meta</span><br><span class="line">           |__installscript.qs</span><br><span class="line">           |__package.xml</span><br></pre></td></tr></table></figure>

<p>其中：</p>
<ol>
<li>com.root中的license.txt就是随便写，到时候安装会加载显示；</li>
<li>comfig、packages两个名字不能改；com.root和com.root.foundation名字可以改，但是都要放在packages下面，同时各自下面都要有data和meta文件夹，data放用到的可执行程序以及库，meta放配置文件和脚本；</li>
<li>对于第三方安装包，可以在配置文件中设置installer为true（没有验证）；</li>
<li>卸载静默，将卸载脚本uninstallscript.qs放入 data 目录中（例如：data/script/uninstallscript.qs），最终由 Qt IFW 打包进安装程序。当需要进行覆盖安装时，maintenancetool 工具就可以很容易的找到它。</li>
</ol>
<h2 id="离线安装示例："><a href="#离线安装示例：" class="headerlink" title="离线安装示例："></a>离线安装示例：</h2><p><strong>在对应的文件下</strong></p>
<p>Install.rar</p>
<h2 id="离线安装详解："><a href="#离线安装详解：" class="headerlink" title="离线安装详解："></a>离线安装详解：</h2><h3 id="config文件夹"><a href="#config文件夹" class="headerlink" title="config文件夹"></a>config文件夹</h3><h4 id="config-xml"><a href="#config-xml" class="headerlink" title="config.xml"></a>config.xml</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;!--配置的所有属性-https:<span class="comment">//doc.qt.io/qtinstallerframework/ifw-globalconfig.html--&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">Installer</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">Name</span>&gt;</span>TZ Weather System Installer<span class="tag">&lt;/<span class="name">Name</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">Version</span>&gt;</span>1.01<span class="tag">&lt;/<span class="name">Version</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">Title</span>&gt;</span>TZ Weather System Installer<span class="tag">&lt;/<span class="name">Title</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">Publisher</span>&gt;</span>ISCAS<span class="tag">&lt;/<span class="name">Publisher</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">StartMenuDir</span>&gt;</span>TZWeather System<span class="tag">&lt;/<span class="name">StartMenuDir</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">TargetDir</span>&gt;</span>@rootDir@/TZWeather<span class="tag">&lt;/<span class="name">TargetDir</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">Installer</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h4 id="control-qs"><a href="#control-qs" class="headerlink" title="control.qs"></a>control.qs</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//https://doc.qt.io/qtinstallerframework/noninteractive.html</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Controller</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 判断是否是卸载程序</span></span><br><span class="line">    <span class="keyword">if</span>(installer.isUninstaller())&#123;</span><br><span class="line">        installer.uninstallationStarted.connect(<span class="built_in">this</span>, <span class="built_in">this</span>.uninstallationStarted);</span><br><span class="line">    	installer.uninstallationFinished.connect(<span class="built_in">this</span>, <span class="built_in">this</span>.uninstallationFinished);</span><br><span class="line">    &#125;</span><br><span class="line"> <span class="comment">// 判断是否是安装程序</span></span><br><span class="line">    <span class="keyword">if</span>(installer.isInstaller())&#123;</span><br><span class="line">        installer.installationStarted.connect(<span class="built_in">this</span>,<span class="built_in">this</span>.installationStarted);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 卸载开始前需要执行的操作</span></span><br><span class="line">Controller.prototype.uninstallationStarted = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//var dir = installer.value(&quot;TargetDir&quot;);</span></span><br><span class="line">    <span class="comment">//installer.execute(dir + &quot;/script/uninstall.sh&quot;); // 可以自定义一些卸载的shell脚本</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 当卸载完成时，触发</span></span><br><span class="line">Controller.prototype.uninstallationFinished = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 开始安装前执行的操作</span></span><br><span class="line">Controller.prototype.installationStarted = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//installer.execute(&quot;touch&quot;,&quot;/home/arteryflow/aa/bb.txt&quot;);</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="packages的com-root的meta"><a href="#packages的com-root的meta" class="headerlink" title="packages的com.root的meta"></a>packages的com.root的meta</h3><h4 id="package-xml"><a href="#package-xml" class="headerlink" title="package.xml"></a>package.xml</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span><br><span class="line">&lt;!--package中所有的属性-https:<span class="comment">//doc.qt.io/qtinstallerframework/ifw-component-description.html--&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">Package</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">Name</span>&gt;</span>com.root<span class="tag">&lt;/<span class="name">Name</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">DisplayName</span>&gt;</span>TZ Weather System<span class="tag">&lt;/<span class="name">DisplayName</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">Description</span>&gt;</span>TZ Weather System<span class="tag">&lt;/<span class="name">Description</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">Version</span>&gt;</span>1.01<span class="tag">&lt;/<span class="name">Version</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">ReleaseDate</span>&gt;</span>2024-02-05<span class="tag">&lt;/<span class="name">ReleaseDate</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="comment">&lt;!--就是个txt，在安装过程中可以显示出来--&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">Licenses</span>&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">License</span> <span class="attr">name</span>=<span class="string">&quot;license&quot;</span> <span class="attr">file</span>=<span class="string">&quot;license.txt&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">Licenses</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">Default</span>&gt;</span>true<span class="tag">&lt;/<span class="name">Default</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">Script</span>&gt;</span>installscript.js<span class="tag">&lt;/<span class="name">Script</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">UserInterfaces</span>&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">UserInterface</span>&gt;</span>targetwidget.ui<span class="tag">&lt;/<span class="name">UserInterface</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">UserInterfaces</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">Package</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h4 id="installscript-js"><a href="#installscript-js" class="headerlink" title="installscript.js"></a>installscript.js</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************************</span></span><br><span class="line"><span class="comment">**</span></span><br><span class="line"><span class="comment">** Copyright (C) 2017 The Qt Company Ltd.</span></span><br><span class="line"><span class="comment">** Contact: https://www.qt.io/licensing/</span></span><br><span class="line"><span class="comment">**</span></span><br><span class="line"><span class="comment">** This file is part of the Qt Installer Framework.</span></span><br><span class="line"><span class="comment">**</span></span><br><span class="line"><span class="comment">** $QT_BEGIN_LICENSE:GPL-EXCEPT$</span></span><br><span class="line"><span class="comment">** Commercial License Usage</span></span><br><span class="line"><span class="comment">** Licensees holding valid commercial Qt licenses may use this file in</span></span><br><span class="line"><span class="comment">** accordance with the commercial license agreement provided with the</span></span><br><span class="line"><span class="comment">** Software or, alternatively, in accordance with the terms contained in</span></span><br><span class="line"><span class="comment">** a written agreement between you and The Qt Company. For licensing terms</span></span><br><span class="line"><span class="comment">** and conditions see https://www.qt.io/terms-conditions. For further</span></span><br><span class="line"><span class="comment">** information use the contact form at https://www.qt.io/contact-us.</span></span><br><span class="line"><span class="comment">**</span></span><br><span class="line"><span class="comment">** GNU General Public License Usage</span></span><br><span class="line"><span class="comment">** Alternatively, this file may be used under the terms of the GNU</span></span><br><span class="line"><span class="comment">** General Public License version 3 as published by the Free Software</span></span><br><span class="line"><span class="comment">** Foundation with exceptions as appearing in the file LICENSE.GPL3-EXCEPT</span></span><br><span class="line"><span class="comment">** included in the packaging of this file. Please review the following</span></span><br><span class="line"><span class="comment">** information to ensure the GNU General Public License requirements will</span></span><br><span class="line"><span class="comment">** be met: https://www.gnu.org/licenses/gpl-3.0.html.</span></span><br><span class="line"><span class="comment">**</span></span><br><span class="line"><span class="comment">** $QT_END_LICENSE$</span></span><br><span class="line"><span class="comment">**</span></span><br><span class="line"><span class="comment">**************************************************************************/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ComponentSelectionPage = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Dir = <span class="keyword">new</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.toNativeSparator = <span class="function"><span class="keyword">function</span> (<span class="params">path</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (systemInfo.productType === <span class="string">&quot;windows&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> path.replace(<span class="regexp">/\//g</span>, <span class="string">&#x27;\\&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span> path;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//构造函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Component</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="comment">//判断当前是安装、卸载、更新程序-https://doc.qt.io/qtinstallerframework/scripting-installer.html</span></span><br><span class="line">    <span class="keyword">if</span> (installer.isInstaller()) &#123;</span><br><span class="line">		<span class="comment">//信号0---加载组件后立即调用（一共有哪些组件的信号可绑定-https://doc.qt.io/qtinstallerframework/scripting-component.html）</span></span><br><span class="line">        component.loaded.connect(<span class="built_in">this</span>, Component.prototype.installerLoaded);</span><br><span class="line">        ComponentSelectionPage = gui.pageById(QInstaller.ComponentSelection);</span><br><span class="line"></span><br><span class="line">		<span class="comment">//默认提供的界面不显示，使用自定义的ui界面（一共有哪些默认提供的页面-https://doc.qt.io/qtinstallerframework/scripting-qinstaller.html</span></span><br><span class="line">		<span class="comment">//installer一共有哪些函数-https://doc.qt.io/qtinstallerframework/scripting-installer.html）</span></span><br><span class="line">        installer.setDefaultPageVisible(QInstaller.TargetDirectory, <span class="literal">false</span>);</span><br><span class="line">        <span class="comment">//installer.setDefaultPageVisible(QInstaller.ComponentSelection, false);</span></span><br><span class="line">        <span class="comment">//installer.setDefaultPageVisible(QInstaller.LicenseCheck, false);</span></span><br><span class="line">		<span class="comment">//可以获取的系统变量有哪些-https://doc.qt.io/qtinstallerframework/qinstaller-systeminfo.html</span></span><br><span class="line">        <span class="comment">//if (systemInfo.productType === &quot;windows&quot;)</span></span><br><span class="line">        <span class="comment">//    installer.setDefaultPageVisible(QInstaller.StartMenuSelection, false);</span></span><br><span class="line">        <span class="comment">//installer.setDefaultPageVisible(QInstaller.ReadyForInstallation, false);</span></span><br><span class="line">		</span><br><span class="line">		installer.installationFinished.connect(<span class="built_in">this</span>,Component.prototype.installationFinishedPageIsShown);</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 判断是否是更新程序</span></span><br><span class="line">    <span class="keyword">if</span>(installer.isUpdater())</span><br><span class="line">	&#123;</span><br><span class="line">		installer.finishButtonClicked.connect(<span class="built_in">this</span>,Component.prototype.updateFinishedOpenText);</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">	 <span class="comment">// 判断是否是卸载程序</span></span><br><span class="line">    <span class="keyword">if</span>(installer.isUninstaller())</span><br><span class="line">	&#123;</span><br><span class="line">    	installer.uninstallationFinished.connect(<span class="built_in">this</span>, Component.prototype.uninstallationFinishedMessage);</span><br><span class="line">		installer.finishButtonClicked.connect(<span class="built_in">this</span>, Component.prototype.uninstallationFinishedMessage);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//安装完其实就是把data中的东西放在@TargetDir@下了</span></span><br><span class="line">Component.prototype.createOperations = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// call default implementation to actually install README.txt!</span></span><br><span class="line">    component.createOperations();</span><br><span class="line"></span><br><span class="line">	<span class="comment">//有哪些operation -https://doc.qt.io/qtinstallerframework/operations.html</span></span><br><span class="line">    <span class="keyword">if</span> (systemInfo.productType === <span class="string">&quot;windows&quot;</span>) &#123;</span><br><span class="line">		<span class="comment">//创建开始菜单快捷方式</span></span><br><span class="line">        component.addOperation(<span class="string">&quot;CreateShortcut&quot;</span>, <span class="string">&quot;@TargetDir@/OceanWindPlatform.exe&quot;</span>, <span class="string">&quot;@StartMenuDir@/天智海洋气象区域精细化服务保障系统.lnk&quot;</span>,</span><br><span class="line">            <span class="string">&quot;workingDirectory=@TargetDir@/&quot;</span>);</span><br><span class="line">		<span class="comment">//创建桌面快捷方式</span></span><br><span class="line">		component.addOperation(<span class="string">&quot;CreateShortcut&quot;</span>, <span class="string">&quot;@TargetDir@/OceanWindPlatform.exe&quot;</span>, <span class="string">&quot;@DesktopDir@/天智海洋气象区域精细化服务保障系统.lnk&quot;</span>,</span><br><span class="line">            <span class="string">&quot;workingDirectory=@TargetDir@/&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		component.addOperation(</span><br><span class="line">        <span class="string">&quot;RegisterFileType&quot;</span>,</span><br><span class="line">        <span class="string">&quot;TZP&quot;</span>,                						<span class="comment">//需要注册的后缀名，不包含.</span></span><br><span class="line">        <span class="string">&quot;@TargetDir@\\OceanWindPlatform.exe %1&quot;</span>,    <span class="comment">//打开该文件的执行型程序, %1是文件路径命令行参数占位符，不可缺少</span></span><br><span class="line">        <span class="string">&quot;天智气象预报数据包&quot;</span>,              <span class="comment">//描述</span></span><br><span class="line">        <span class="string">&quot;text/xml&quot;</span>,                        <span class="comment">//上下文类型</span></span><br><span class="line">        <span class="string">&quot;@TargetDir@\\logo.ico,0&quot;</span>     	   <span class="comment">//文件图标</span></span><br><span class="line">    );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//槽函数0---加载组件后立即调用</span></span><br><span class="line">Component.prototype.installerLoaded = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">//使用新UI代替默认的安装路径选择界面，使用的时候是Dynamic+自定义的名称（https://doc.qt.io/qtinstallerframework/ifw-customizing-installers.html）</span></span><br><span class="line">    <span class="keyword">if</span> (installer.addWizardPage(component, <span class="string">&quot;TargetWidget&quot;</span>, QInstaller.TargetDirectory)) &#123;</span><br><span class="line">        <span class="keyword">var</span> widget = gui.pageWidgetByObjectName(<span class="string">&quot;DynamicTargetWidget&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (widget != <span class="literal">null</span>) &#123;</span><br><span class="line">			<span class="comment">//信号1---当点击选择安装位置按钮时调用（根据UI控件的实际信号和槽函数）</span></span><br><span class="line">            widget.targetChooser.clicked.connect(<span class="built_in">this</span>, Component.prototype.chooseTarget);</span><br><span class="line">			<span class="comment">//信号2---当安装位置发生改变时调用（根据UI控件的实际信号和槽函数）</span></span><br><span class="line">            widget.targetDirectory.textChanged.connect(<span class="built_in">this</span>, Component.prototype.targetChanged);</span><br><span class="line"></span><br><span class="line">            widget.windowTitle = qsTranslate(<span class="string">&quot;installscript&quot;</span>, <span class="string">&quot;选择安装目录&quot;</span>);;</span><br><span class="line">			<span class="comment">//在页面上的安装位置lineedit中更新路径</span></span><br><span class="line">            widget.targetDirectory.text = Dir.toNativeSparator(installer.value(<span class="string">&quot;TargetDir&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//槽函数1---当安装位置发生改变时调用</span></span><br><span class="line">Component.prototype.targetChanged = <span class="function"><span class="keyword">function</span> (<span class="params">text</span>) </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> widget = gui.pageWidgetByObjectName(<span class="string">&quot;DynamicTargetWidget&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (widget != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (text != <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">			<span class="comment">//如果是新路径</span></span><br><span class="line">            <span class="keyword">if</span> (!installer.fileExists(text + <span class="string">&quot;/components.xml&quot;</span>)) &#123;</span><br><span class="line">                widget.complete = <span class="literal">true</span>;</span><br><span class="line">                installer.setValue(<span class="string">&quot;TargetDir&quot;</span>, text);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">			<span class="comment">//如果已经存在需要先卸载</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(installer.fileExists(text + <span class="string">&quot;/maintenancetool.exe&quot;</span>))&#123;</span><br><span class="line">				</span><br><span class="line">				<span class="comment">//在控制脚本中弹出信息消息框提醒要覆盖安装--方式一</span></span><br><span class="line">				<span class="keyword">var</span> result = QMessageBox.warning(<span class="string">&quot;os.warning&quot;</span>, <span class="string">&quot;Installer&quot;</span>,<span class="string">&quot;检测到程序已安装，继续将会被覆盖.&quot;</span>, QMessageBox.Yes | QMessageBox.No);</span><br><span class="line">				<span class="keyword">if</span> (result === QMessageBox.Yes) &#123;</span><br><span class="line">					<span class="comment">//卸载时使用uninstallscript.qs脚本静默卸载</span></span><br><span class="line">					installer.execute(text + <span class="string">&quot;/maintenancetool.exe&quot;</span>, <span class="string">&quot;--script=&quot;</span> + text + <span class="string">&quot;/uninstallscript.qs&quot;</span>);</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					 widget.targetDirectory.text = installer.value(<span class="string">&quot;TargetDir&quot;</span>);<span class="comment">//恢复默认路径</span></span><br><span class="line">					 widget.complete = <span class="literal">true</span>;</span><br><span class="line">					 <span class="keyword">return</span>;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="comment">//在控制脚本中弹出信息消息框提醒要覆盖安装--方式二</span></span><br><span class="line">				<span class="comment">//QMessageBox[&quot;warning&quot;](&quot;os.warning&quot;, &quot;Installer&quot;,&quot;检测到程序已安装，继续将会被覆盖.&quot;,QMessageBox.Ok|QMessageBox::Cancel);</span></span><br><span class="line">				</span><br><span class="line">				<span class="comment">//设置新路径</span></span><br><span class="line">				widget.complete = <span class="literal">true</span>;</span><br><span class="line">				<span class="comment">//原则上这个里面的所有内容都能设置值并且获取（https://doc.qt.io/qtinstallerframework/ifw-globalconfig.html）</span></span><br><span class="line">                installer.setValue(<span class="string">&quot;TargetDir&quot;</span>, text);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        widget.complete = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//槽函数2---当点击选择安装位置按钮时调用</span></span><br><span class="line">Component.prototype.chooseTarget = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> widget = gui.pageWidgetByObjectName(<span class="string">&quot;DynamicTargetWidget&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (widget != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> newTarget = QFileDialog.getExistingDirectory(qsTranslate(<span class="string">&quot;installscript&quot;</span>, <span class="string">&quot;请选择程序的安装位置：&quot;</span>), widget</span><br><span class="line">            .targetDirectory.text);</span><br><span class="line">        <span class="keyword">if</span> (newTarget != <span class="string">&quot;&quot;</span>)</span><br><span class="line">            widget.targetDirectory.text = Dir.toNativeSparator(newTarget)+<span class="string">&quot;\\TZWeather\\&quot;</span>;<span class="comment">//自定义文件夹名称</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 安装完成执行的操作</span></span><br><span class="line">Component.prototype.installationFinishedPageIsShown = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//installer.execute(&quot;touch&quot;,&quot;/home/arteryflow/aa/bb.txt&quot;);</span></span><br><span class="line">	<span class="keyword">var</span> dir = installer.value(<span class="string">&quot;TargetDir&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span>(installer.fileExists(dir + <span class="string">&quot;/doc/天智全球海洋区域气象服务系统V1.0-用户手册-20231213.pdf&quot;</span>))</span><br><span class="line">	&#123;</span><br><span class="line">		QDesktopServices.openUrl(<span class="string">&quot;file:///&quot;</span> + dir + <span class="string">&quot;/doc/天智全球海洋区域气象服务系统V1.0-用户手册-20231213.pdf&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 更新完成后的操作</span></span><br><span class="line">Component.prototype.updateFinishedOpenText = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//installer.execute(&quot;touch&quot;,&quot;/home/arteryflow/aa/bb.txt&quot;);</span></span><br><span class="line">	<span class="keyword">var</span> dir = installer.value(<span class="string">&quot;TargetDir&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span>(installer.fileExists(dir + <span class="string">&quot;/update.txt&quot;</span>))</span><br><span class="line">	&#123;</span><br><span class="line">		QDesktopServices.openUrl(<span class="string">&quot;file:///&quot;</span> + dir + <span class="string">&quot;/update.txt&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当卸载完成时，触发(不起作用)</span></span><br><span class="line">Component.prototype.uninstallationFinishedMessage = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	QMessageBox.warning(<span class="string">&quot;os.warning&quot;</span>, <span class="string">&quot;UnInstaller&quot;</span>,<span class="string">&quot;卸载完成.&quot;</span>, QMessageBox.Yes);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="license-txt"><a href="#license-txt" class="headerlink" title="license.txt"></a>license.txt</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span> is a license！</span><br></pre></td></tr></table></figure>

<h3 id="packages的com-root的data"><a href="#packages的com-root的data" class="headerlink" title="packages的com.root的data"></a>packages的com.root的data</h3><h4 id="uninstallscript-qs"><a href="#uninstallscript-qs" class="headerlink" title="uninstallscript.qs"></a>uninstallscript.qs</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//我们可以通过模拟用户单击与 UI 交互，来实现最终的卸载功能</span></span><br><span class="line"><span class="comment">// 卸载脚本：如果程序已安装，则会调用 maintenance 工具，自动进行卸载。</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Controller</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    gui.clickButton(buttons.NextButton);</span><br><span class="line">    gui.clickButton(buttons.NextButton);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 连接信号槽</span></span><br><span class="line">    installer.uninstallationFinished.connect(<span class="built_in">this</span>, <span class="built_in">this</span>.uninstallationFinished);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当卸载完成时，触发</span></span><br><span class="line">Controller.prototype.uninstallationFinished = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    gui.clickButton(buttons.NextButton);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 与完成页面上的部件交互</span></span><br><span class="line">Controller.prototype.FinishedPageCallback = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    gui.clickButton(buttons.FinishButton);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="packages的com-root-foundation的meta"><a href="#packages的com-root-foundation的meta" class="headerlink" title="packages的com.root.foundation的meta"></a>packages的com.root.foundation的meta</h3><h4 id="package-xml-1"><a href="#package-xml-1" class="headerlink" title="package.xml"></a>package.xml</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span><br><span class="line">&lt;!--package中所有的属性-https:<span class="comment">//doc.qt.io/qtinstallerframework/ifw-component-description.html--&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">Package</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">Name</span>&gt;</span>com.root.foundation<span class="tag">&lt;/<span class="name">Name</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">DisplayName</span>&gt;</span>TZ Weather librarys<span class="tag">&lt;/<span class="name">DisplayName</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">Description</span>&gt;</span>TZ Weather librarys<span class="tag">&lt;/<span class="name">Description</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">Version</span>&gt;</span>1.01<span class="tag">&lt;/<span class="name">Version</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">ReleaseDate</span>&gt;</span>2024-02-05<span class="tag">&lt;/<span class="name">ReleaseDate</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="comment">&lt;!--是否默认被选中--&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">Default</span>&gt;</span>true<span class="tag">&lt;/<span class="name">Default</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="comment">&lt;!--表示对应的data文件夹中是个需要安装的安装包（https://doc.qt.io/qtinstallerframework/scripting-component.html）--&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">installer</span>&gt;</span>true<span class="tag">&lt;/<span class="name">installer</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">Package</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h2 id="在线安装与更新"><a href="#在线安装与更新" class="headerlink" title="在线安装与更新"></a>在线安装与更新</h2><p>流程说明：</p>
<ol>
<li><p>先安装离线安装过程创建文件结构和配置；</p>
</li>
<li><p>修改config下的config.xml，新增在线库地址；</p>
</li>
<li><p>按离线安装包创建过程创建安装包，以后就用这个安装包在不同机器上安装程序；</p>
</li>
<li><p>执行repogen  -p packages repository生成存储库，</p>
</li>
<li><p><strong>有了更新之后，增加packages里面的config下的config.xml版本号（修改config下的config.xml不管用，这个是全局配置，不是包配置）</strong></p>
<p>​    <strong>经过实际测试，不能只在包中包含更新的部分，需要全部都覆盖！</strong></p>
</li>
<li><p>删掉第四步生成的存储库，重新执行第四步</p>
</li>
<li><p>在其他机器上打开maintenancetool.exe，选择更新组件，就可以看到版本号变大，可以完成更新了</p>
</li>
</ol>
<p><img src="/2021/06/27/Qt/image-20240206172451977.png" alt="image-20240206172451977"></p>
<p>大体上和离线安装一样，指示config下的config.xml文件需要加几句话RemoteRepositories:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;!--配置的所有属性-https:<span class="comment">//doc.qt.io/qtinstallerframework/ifw-globalconfig.html--&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">Installer</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">Name</span>&gt;</span>TZ Weather System Installer<span class="tag">&lt;/<span class="name">Name</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">Version</span>&gt;</span>1.01<span class="tag">&lt;/<span class="name">Version</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">Title</span>&gt;</span>TZ Weather System Installer<span class="tag">&lt;/<span class="name">Title</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">Publisher</span>&gt;</span>ISCAS<span class="tag">&lt;/<span class="name">Publisher</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">StartMenuDir</span>&gt;</span>TZWeather System<span class="tag">&lt;/<span class="name">StartMenuDir</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="comment">&lt;!-- Directory name is used in component.xml --&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">TargetDir</span>&gt;</span>@rootDir@/TZWeather<span class="tag">&lt;/<span class="name">TargetDir</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">RemoteRepositories</span>&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;<span class="name">Repository</span>&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">Url</span>&gt;</span>http://192.168.6.44:44444/repository<span class="tag">&lt;/<span class="name">Url</span>&gt;</span></span></span><br><span class="line"><span class="xml">		<span class="tag">&lt;<span class="name">Enabled</span>&gt;</span>1<span class="tag">&lt;/<span class="name">Enabled</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">Username</span>&gt;</span>user<span class="tag">&lt;/<span class="name">Username</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">Password</span>&gt;</span>password<span class="tag">&lt;/<span class="name">Password</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">DisplayName</span>&gt;</span>Example repository<span class="tag">&lt;/<span class="name">DisplayName</span>&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="tag">&lt;/<span class="name">Repository</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">RemoteRepositories</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">Installer</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="自建服务器，替代文件夹形式，可用于在局域网内发布"><a href="#自建服务器，替代文件夹形式，可用于在局域网内发布" class="headerlink" title="自建服务器，替代文件夹形式，可用于在局域网内发布"></a>自建服务器，替代文件夹形式，可用于在局域网内发布</h3><blockquote>
<p>注意！<Url><a target="_blank" rel="noopener" href="http://192.168.6.44:44444/repository">http://192.168.6.44:44444/repository</a></Url>这一段，<a href="http://192.168.6.44:44444就是自建服务的位置,不需要再写Server这一层级的文件夹了">http://192.168.6.44:44444就是自建服务的位置,不需要再写Server这一层级的文件夹了</a></p>
<p><img src="/2021/06/27/Qt/image-20240207154404530.png" alt="image-20240207154404530"></p>
<p>同时如果要完成上图的构造，生成资源库的命令应该是：repogen  -p packages ./Server/repository；生成安装包的命令应该是：binarycreator -c config\config.xml -p packages ./Server/installer.exe -v</p>
</blockquote>
<h4 id="Python3开启http-server服务"><a href="#Python3开启http-server服务" class="headerlink" title="Python3开启http server服务"></a><strong>Python3开启http server服务</strong></h4><p>python3可以为当前目录开启http server，实现该目录下，文件的网络共享。</p>
<p>通过以下指令，python会默认开启一个端口为8000的http服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m http.server</span><br></pre></td></tr></table></figure>

<p>如果想更换端口，直接在指令最后加端口号即可（注意这个端口不要用6000段<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/605845898%EF%BC%89">https://zhuanlan.zhihu.com/p/605845898）</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m http.server -b 192.168.6.44 44444</span><br></pre></td></tr></table></figure>

<h4 id="效果"><a href="#效果" class="headerlink" title="效果"></a><strong>效果</strong></h4><p>python3开启http server，默认端口为8000</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">E:\Projects\SpxFrame\<span class="number">212</span>\TZweatherDisplay\Main\Installer-online\Server&gt;python -m http.server</span><br><span class="line">Serving HTTP on :: port <span class="number">8000</span> (http://[::]:<span class="number">8000</span>/) ...</span><br></pre></td></tr></table></figure>

<p>python3开启http server，手动指定端口为44444</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">E:\Projects\SpxFrame\212\TZweatherDisplay\Main\Installer-online\Server&gt;python -m http.server -b 192.168.6.44 44444</span><br><span class="line">Serving HTTP on 192.168.6.44 port 44444 (http://192.168.6.44:44444/) ...</span><br></pre></td></tr></table></figure>

<p>例：查看浏览器访问效果</p>
<p><img src="/2021/06/27/Qt/image-20240207154050275.png" alt="image-20240207154050275"></p>
<h3 id="自动更新"><a href="#自动更新" class="headerlink" title="自动更新"></a>自动更新</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_34183232/article/details/118255975">https://blog.csdn.net/qq_34183232/article/details/118255975</a></p>
<p>需要在应用程序中添加模块完成版本号查询：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Update</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//在使用 --checkupdates 检测更新时，并不会运行 GUI，而是仅输出更新信息</span></span><br><span class="line">    <span class="comment">//以下内容放入main.cpp中的一个函数中</span></span><br><span class="line">    <span class="function">QString <span class="title">program</span><span class="params">(<span class="string">&quot;./maintenancetool.exe&quot;</span>)</span></span>;</span><br><span class="line">    QStringList checkArgs;</span><br><span class="line">    checkArgs &lt;&lt; <span class="string">&quot;--checkupdates&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 检测更新</span></span><br><span class="line">    QProcess process;</span><br><span class="line">    process.<span class="built_in">start</span>(program, checkArgs);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 等待检测完成</span></span><br><span class="line">    <span class="keyword">if</span> (!process.<span class="built_in">waitForFinished</span>()) &#123;</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;Error checking for updates.&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 读取输出内容</span></span><br><span class="line">    QByteArray data = process.<span class="built_in">readAllStandardOutput</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//没有输出意味着没有可用的更新</span></span><br><span class="line">    <span class="keyword">if</span> (data.<span class="built_in">isEmpty</span>()) &#123;</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;No updates available.&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(data.<span class="built_in">contains</span>(<span class="string">&quot;no updates available&quot;</span>))&#123;</span><br><span class="line">        <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;No updates available.&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 倘若需要特定的更新信息，应该解析输出的 XML。</span></span><br><span class="line">    <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;444444444444:::::&quot;</span>&lt;&lt;data;</span><br><span class="line">    <span class="comment">//当检测到有可用的更新之后，以更新模式启动 maintenancetool</span></span><br><span class="line">    QMessageBox::StandardButton result =QMessageBox::<span class="built_in">information</span>(<span class="literal">NULL</span>,QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;更新&quot;</span>),QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;版本更新，是否继续?&quot;</span>),QMessageBox::Ok,QMessageBox::Cancel);</span><br><span class="line">    <span class="keyword">if</span>(result==QMessageBox::Ok)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 以分离式启动</span></span><br><span class="line">        QStringList updaterArgs;</span><br><span class="line">        updaterArgs &lt;&lt; <span class="string">&quot;--updater&quot;</span>;</span><br><span class="line">        <span class="keyword">bool</span> success = QProcess::<span class="built_in">startDetached</span>(program, updaterArgs);</span><br><span class="line">        <span class="keyword">if</span> (!success) &#123;</span><br><span class="line">            <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;Program startup failed.&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//关闭当前正在运行的程序，打开更新程序</span></span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="NSIS"><a href="#NSIS" class="headerlink" title="NSIS"></a>NSIS</h1><h2 id="脚本文件：-xiangdao-nsi"><a href="#脚本文件：-xiangdao-nsi" class="headerlink" title="脚本文件： xiangdao.nsi"></a>脚本文件： <a href="E:\oOo\source_posts\Qt\xiangdao.nsi">xiangdao.nsi</a></h2><p> <a href="E:\oOo\source_posts\Qt\额外头文件.zip">额外头文件.zip</a> </p>
<p> <a href="E:\oOo\source_posts\Qt\nsis-3.09-setup.exe">nsis-3.09-setup.exe</a> </p>
<p> <a href="E:\oOo\source_posts\Qt\nisedit2.0.3.exe">nisedit2.0.3.exe</a> </p>
<p> <a href="E:\oOo\source_posts\Qt\NsProcess.zip">NsProcess.zip</a> </p>
<p> <a href="E:\oOo\source_posts\Qt\VersionCompare.nsh">VersionCompare.nsh</a> </p>
<figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">nisedit2.<span class="number">0.3</span>.exe是IDE</span><br><span class="line">nsis-<span class="number">3.09</span>-setup.exe是编译器</span><br><span class="line"></span><br><span class="line">额外头文件.zip是额外的头文件，用于版本比较的头文件就位于FileFunc.nsh中，但是这个比较老，所以自己构建了一个，叫VersionCompare.nsh（需要放在安装路径下的include中）</span><br><span class="line">  使用</span><br><span class="line">	<span class="comment">#要使用带参数的VersionCompare宏定义，需要先插入</span></span><br><span class="line">	<span class="keyword">!insertmacro</span> VersionCompare</span><br><span class="line">	<span class="comment">#检查版本号</span></span><br><span class="line">	<span class="keyword">!macro</span> CheckUpdate</span><br><span class="line">	  <span class="keyword">ReadRegStr</span> <span class="variable">$1</span> <span class="params">HKLM</span>  <span class="string">&quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\<span class="variable">$&#123;PRODUCT_NAME&#125;</span>&quot;</span> <span class="string">&quot;DisplayVersion&quot;</span>	<span class="comment">#取注册表键值</span></span><br><span class="line">	  <span class="variable">$&#123;VersionCompare&#125;</span> <span class="string">&quot;<span class="variable">$1</span>&quot;</span> <span class="string">&quot;<span class="variable">$&#123;PRODUCT_VERSION&#125;</span>&quot;</span> <span class="variable">$2</span></span><br><span class="line">	  <span class="variable">$&#123;IF&#125;</span> <span class="variable">$2</span> == <span class="number">1</span></span><br><span class="line">		<span class="keyword">MessageBox</span> <span class="params">MB_ICONQUESTION</span>|<span class="params">MB_YESNO</span> <span class="string">&quot;你系统中版本<span class="variable">$1</span>高于更新版本<span class="variable">$&#123;PRODUCT_VERSION&#125;</span>，是否继续安装?&quot;</span> <span class="params">IDYES</span> continue <span class="params">IDNO</span> stop</span><br><span class="line">		continue:</span><br><span class="line">			return</span><br><span class="line">		stop:</span><br><span class="line">			<span class="keyword">Abort</span></span><br><span class="line">	  <span class="variable">$&#123;ElseIf&#125;</span>  <span class="variable">$2</span> == <span class="number">0</span></span><br><span class="line">		<span class="keyword">MessageBox</span> <span class="params">MB_OK</span> <span class="string">&quot;你系统中现有版本为<span class="variable">$1</span>，为最新当前最新版本&quot;</span> <span class="params">IDOK</span></span><br><span class="line">		<span class="keyword">Abort</span></span><br><span class="line">	  <span class="variable">$&#123;EndIf&#125;</span></span><br><span class="line">		return</span><br><span class="line">	<span class="keyword">!macro</span>end</span><br><span class="line"></span><br><span class="line">NsProcess.zip是用于判断程序是否运行的库文件</span><br><span class="line">	插件包Include中的nsProcess.nsh移动到nsis的Include中</span><br><span class="line">	插件包Plugin中的nsProcess.dll移动到nsis的Plugins\x86-ansi中</span><br><span class="line">	插件包Plugin中的nsProcessW.dll移动到nsis的Plugins\x86-unicode中</span><br><span class="line">	nsProcessW.dll名称修改为nsProcess.dll</span><br><span class="line">  使用</span><br><span class="line">	引入头文件</span><br><span class="line">	<span class="keyword">!include</span> <span class="string">&quot;nsProcess.nsh&quot;</span></span><br><span class="line"></span><br><span class="line">	查询进程是否处于运行状态</span><br><span class="line">	<span class="class">nsProcess::_FindProcess</span> <span class="string">&quot;xxx.exe&quot;</span> </span><br><span class="line"></span><br><span class="line">	查询到返回<span class="number">0</span></span><br><span class="line">	关闭进程</span><br><span class="line">	<span class="class">nsProcess::_KillProcess</span> <span class="string">&quot;xxx.exe&quot;</span></span><br><span class="line"></span><br><span class="line">	Nsis回调函数</span><br><span class="line">	.onInit 安装时回调</span><br><span class="line">	un.onInit 卸载时回调</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h2><p>IDE：<a target="_blank" rel="noopener" href="https://hmne.sourceforge.net/">https://hmne.sourceforge.net/</a></p>
<p>编译：<a target="_blank" rel="noopener" href="https://nsis.sourceforge.io/Main_Page">https://nsis.sourceforge.io/Main_Page</a></p>
<p>参考-向导制作脚本：<a target="_blank" rel="noopener" href="https://blog.csdn.net/cai901022/article/details/135221270">https://blog.csdn.net/cai901022/article/details/135221270</a></p>
<p>参考-安装与卸载检查是否正在运行：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43796392/article/details/131130527">https://blog.csdn.net/weixin_43796392/article/details/131130527</a>  <a target="_blank" rel="noopener" href="https://blog.csdn.net/Bear1998/article/details/101060269/">https://blog.csdn.net/Bear1998/article/details/101060269/</a></p>
<p>用户手册：<a target="_blank" rel="noopener" href="https://www.wenjiangs.com/doc/ang9qqgc">https://www.wenjiangs.com/doc/ang9qqgc</a></p>
<h3 id="1、点击-“脚本编辑器VNISEdit”"><a href="#1、点击-“脚本编辑器VNISEdit”" class="headerlink" title="1、点击 “脚本编辑器VNISEdit”"></a>1、点击 “脚本编辑器VNISEdit”</h3><p><img src="/2021/06/27/Qt/image-20240221135741227.png" alt="image-20240221135741227"></p>
<h3 id="2、选择“新建脚本：向导”"><a href="#2、选择“新建脚本：向导”" class="headerlink" title="2、选择“新建脚本：向导”"></a>2、选择“新建脚本：向导”</h3><p><img src="/2021/06/27/Qt/image-20240221135542436.png" alt="image-20240221135542436"></p>
<p><img src="/2021/06/27/Qt/3ba11f0a6cb449bba7b86717ab52dc1a.png" alt="img"></p>
<p><img src="/2021/06/27/Qt/cf92e1b6ed8a4a3092f1453010b0a996.png" alt="img"></p>
<h3 id="3、这里的参数自己都可以设置试一下，点击下一步："><a href="#3、这里的参数自己都可以设置试一下，点击下一步：" class="headerlink" title="3、这里的参数自己都可以设置试一下，点击下一步："></a>3、这里的参数自己都可以设置试一下，点击下一步：</h3><p>以打包一个test.exe程序为例：</p>
<p><img src="/2021/06/27/Qt/0d6efeb24ec448a0b20db4f84808ac25.png" alt="img"></p>
<p><img src="/2021/06/27/Qt/8a6dde29789241a5af3c454033e114f6.png" alt="img"></p>
<h3 id="4、授权文件"><a href="#4、授权文件" class="headerlink" title="4、授权文件"></a>4、授权文件</h3><p>就是我们的licence.txt文件，这个文件的编码ASCII编码，就是记事本新建的默认文本格式，这个文件的的路径必须是存在的，否则后面的时候不能生成安装程序。</p>
<p><img src="/2021/06/27/Qt/2ccfdd042bee428a9c8a6896b3170d30.png" alt="img"></p>
<p><img src="/2021/06/27/Qt/e7525eb297d94a1cbb6f1ad49bce9a1f.png" alt="img"></p>
<p>这里就是添加要打包程序文件夹的步骤。先把默认的模版文件删掉</p>
<p><img src="/2021/06/27/Qt/a53ed224910240cf8d60c73e67dd8196.png" alt="img"></p>
<p><img src="/2021/06/27/Qt/4092b9c95967481896c746197e00b64b.png" alt="img"></p>
<p><img src="/2021/06/27/Qt/32ed87ac83b345089ccf3cd39b861da4.png" alt="img"></p>
<p>勾选包含子目录（如果没有包含子目录选择就直接点击确定，后面再在脚本中加/r参数就行了）</p>
<blockquote>
<ol>
<li><p>这里可以新加多个Section，在左上角的窗口里，意为要打包多个程序、安装包</p>
</li>
<li><p>文件夹名称需要注意，只会包含到选择的文件夹下一层，本层不会包含，如下图，如果选择了第一个RouteOptimization，那安装路径下面就会是RouteOptimization/setUp0221,如果选择了第二个RouteOptimization，那安装路径下面就会是setUp0221。（当然，也可以在脚本中手动修改）</p>
<p><img src="/2021/06/27/Qt/image-20240222093537679.png" alt="image-20240222093537679"></p>
</li>
</ol>
</blockquote>
<p><img src="/2021/06/27/Qt/21f1ad0386944fdbaa0451dd3f76af9d.png" alt="img"></p>
<p>点击下一步：<br>添加桌面快捷方式</p>
<p><img src="/2021/06/27/Qt/b4304e305e014a47a1822f566ebe4ea7.png" alt="img"></p>
<p>手动补全：</p>
<p><img src="/2021/06/27/Qt/7d4dd2a3c2f146f283621623ba2a14ee.png" alt="img"></p>
<p>test.lnk是自己的快捷方式名<br>$INSTDIR\test.exe 这个是你打包的文件中的可执行文件</p>
<blockquote>
<p><strong>注：</strong></p>
<p><em><strong>$STARTMENU</strong></em></p>
<p><strong>开始菜单目录 (常用于添加一个开始菜单项，使用 <a target="_blank" rel="noopener" href="https://www.wenjiangs.com/doc/o6EbTz7C">CreateShortCut</a>)。该常量的内容 (所有用户或当前用户) 取决于 <a target="_blank" rel="noopener" href="https://www.wenjiangs.com/doc/o6EbTz7C">SetShellVarContext</a> 设置。默认为当前用户。</strong></p>
<p><em><strong>$SMPROGRAMS</strong></em></p>
<p><strong>开始菜单程序目录 (当你想定位“$STARTMENU\程序”时可以使用它)。该常量的内容 (所有用户或当前用户) 取决于 <a target="_blank" rel="noopener" href="https://www.wenjiangs.com/doc/o6EbTz7C">SetShellVarContext</a> 设置。默认为当前用户。</strong></p>
<p><em><strong>$SMSTARTUP</strong></em></p>
<p><strong>开始菜单程序/启动 目录。该常量的内容 (所有用户或当前用户) 取决于 <a target="_blank" rel="noopener" href="https://www.wenjiangs.com/doc/o6EbTz7C">SetShellVarContext</a> 设置。默认为当前用户。</strong></p>
<p><em><strong>$QUICKLAUNCH</strong></em></p>
<p><strong>在 IE4 活动桌面及以上的快速启动目录。如果快速启动不可用，仅仅返回和 $TEMP 一样。</strong></p>
</blockquote>
<p><img src="/2021/06/27/Qt/3de046a0ebf040b0a3ee6da545cfec04.png" alt="img"></p>
<p><img src="/2021/06/27/Qt/6489312f18f946eea3d2caaa80c22b2b.png" alt="img"></p>
<p><img src="/2021/06/27/Qt/f1840743cea74cb082b2d153751a9a9a.png" alt="img"></p>
<p><img src="/2021/06/27/Qt/ce3e386bc3824ea5bb95a003d703eeea.png" alt="img"></p>
<p>保存脚本，下次就可以不用重新设置一遍了（要注意的是，脚本里使用的是<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84&spm=1001.2101.3001.7020">相对路径</a>）。</p>
<p><img src="/2021/06/27/Qt/417721c15188460fbc93f08e17faf952.png" alt="img"></p>
<p><img src="/2021/06/27/Qt/6b2727ec27654ddf94b15f2974a41a71.png" alt="img"></p>
<p>如果报错，下面有提示信息，看看什么没有设置。设置好后，下面就会出现这个安装向导程序：</p>
<p><img src="/2021/06/27/Qt/f02ab95f065e4653a6b99bc824f9de23.png" alt="img"></p>
<p>安装完成后，桌面有快捷图标。双击，看是否出现界面。<br>安装目录中，有个uninst.exe卸载程序</p>
<h2 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h2><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">; Script generated by the HM NIS Edit Script Wizard.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ====================== 自定义宏 ==============================</span></span><br><span class="line"><span class="comment">; HM NIS Edit Wizard helper defines</span></span><br><span class="line"><span class="keyword">!define</span> PRODUCT_NAME <span class="string">&quot;OceanWindPlatform&quot;</span></span><br><span class="line"><span class="keyword">!define</span> PRODUCT_VERSION <span class="string">&quot;1.0&quot;</span></span><br><span class="line"><span class="keyword">!define</span> PRODUCT_PUBLISHER <span class="string">&quot;My company, Inc.&quot;</span></span><br><span class="line"><span class="keyword">!define</span> PRODUCT_WEB_SITE <span class="string">&quot;http://www.mycompany.com&quot;</span></span><br><span class="line"><span class="keyword">!define</span> PRODUCT_DIR_REGKEY <span class="string">&quot;Software\Microsoft\Windows\CurrentVersion\App Paths\OceanWindPlatform.exe&quot;</span></span><br><span class="line"><span class="keyword">!define</span> PRODUCT_UNINST_KEY <span class="string">&quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\<span class="variable">$&#123;PRODUCT_NAME&#125;</span>&quot;</span></span><br><span class="line"><span class="keyword">!define</span> PRODUCT_UNINST_ROOT_KEY <span class="string">&quot;HKLM&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ===================== 外部插件以及宏 =============================</span></span><br><span class="line"><span class="comment">; MUI 1.67 compatible ------</span></span><br><span class="line"><span class="keyword">!include</span> <span class="string">&quot;MUI.nsh&quot;</span></span><br><span class="line"><span class="keyword">!include</span> LogicLib.nsh</span><br><span class="line"><span class="keyword">!include</span> Integration.nsh</span><br><span class="line"><span class="keyword">!include</span> FileFunc.nsh <span class="comment">#刷新桌面图标缓存</span></span><br><span class="line"><span class="keyword">!include</span> nsProcess.nsh</span><br><span class="line"><span class="keyword">!include</span> VersionCompare.nsh</span><br><span class="line"></span><br><span class="line"><span class="comment"># ======================== MUI属性 =================================</span></span><br><span class="line"><span class="comment">; MUI Settings</span></span><br><span class="line"><span class="keyword">!define</span> MUI_ABORTWARNING</span><br><span class="line"><span class="keyword">!define</span> MUI_ICON <span class="string">&quot;logo.ico&quot;</span></span><br><span class="line"><span class="keyword">!define</span> MUI_UNICON <span class="string">&quot;<span class="variable">$&#123;NSISDIR&#125;</span>\Contrib\Graphics\Icons\modern-uninstall.ico&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; Language Selection Dialog Settings</span></span><br><span class="line"><span class="keyword">!define</span> MUI_LANGDLL_REGISTRY_ROOT <span class="string">&quot;<span class="variable">$&#123;PRODUCT_UNINST_ROOT_KEY&#125;</span>&quot;</span></span><br><span class="line"><span class="keyword">!define</span> MUI_LANGDLL_REGISTRY_KEY <span class="string">&quot;<span class="variable">$&#123;PRODUCT_UNINST_KEY&#125;</span>&quot;</span></span><br><span class="line"><span class="keyword">!define</span> MUI_LANGDLL_REGISTRY_VALUENAME <span class="string">&quot;NSIS:Language&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; Welcome page</span></span><br><span class="line"><span class="keyword">!insertmacro</span> MUI_PAGE_WELCOME</span><br><span class="line"><span class="comment">; License page</span></span><br><span class="line"><span class="keyword">!define</span> MUI_LICENSEPAGE_RADIOBUTTONS</span><br><span class="line"><span class="keyword">!insertmacro</span> MUI_PAGE_LICENSE <span class="string">&quot;license.txt&quot;</span></span><br><span class="line"><span class="comment">; Components page</span></span><br><span class="line"><span class="keyword">!insertmacro</span> MUI_PAGE_COMPONENTS</span><br><span class="line"><span class="comment">; Directory page</span></span><br><span class="line"><span class="keyword">!insertmacro</span> MUI_PAGE_DIRECTORY</span><br><span class="line"><span class="comment">; Instfiles page</span></span><br><span class="line"><span class="keyword">!insertmacro</span> MUI_PAGE_INSTFILES</span><br><span class="line"><span class="comment">; Finish page</span></span><br><span class="line"><span class="keyword">!define</span> MUI_FINISHPAGE_RUN <span class="string">&quot;<span class="variable">$INSTDIR</span>\<span class="variable">$&#123;PRODUCT_NAME&#125;</span>.exe&quot;</span></span><br><span class="line"><span class="keyword">!insertmacro</span> MUI_PAGE_FINISH</span><br><span class="line"></span><br><span class="line"><span class="comment">; Uninstaller pages</span></span><br><span class="line"><span class="keyword">!insertmacro</span> MUI_UNPAGE_INSTFILES</span><br><span class="line"></span><br><span class="line"><span class="comment">; Language files</span></span><br><span class="line"><span class="keyword">!insertmacro</span> MUI_LANGUAGE <span class="string">&quot;English&quot;</span></span><br><span class="line"><span class="keyword">!insertmacro</span> MUI_LANGUAGE <span class="string">&quot;SimpChinese&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; MUI end ------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ==================== NSIS属性 ================================</span></span><br><span class="line"><span class="keyword">Name</span> <span class="string">&quot;<span class="variable">$&#123;PRODUCT_NAME&#125;</span>&quot;</span></span><br><span class="line"><span class="keyword">OutFile</span> <span class="string">&quot;install.exe&quot;</span></span><br><span class="line"><span class="keyword">InstallDir</span> <span class="string">&quot;<span class="variable">$PROGRAMFILES</span>\<span class="variable">$(^Name)</span>&quot;</span></span><br><span class="line"><span class="keyword">InstallDirRegKey</span> <span class="params">HKLM</span> <span class="string">&quot;<span class="variable">$&#123;PRODUCT_DIR_REGKEY&#125;</span>&quot;</span> <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">ShowInstDetails</span> <span class="literal">show</span></span><br><span class="line">ShowUnInstDetails <span class="literal">show</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#宏定义，参考5.4.11 !macro</span></span><br><span class="line"><span class="keyword">!macro</span> EnsureAdminRights</span><br><span class="line">  <span class="comment">#从堆栈里弹出一个字串到用户变量 $x。如果堆栈是空的，则会置一个错误标记。</span></span><br><span class="line">  <span class="comment">#下面是把UserInfo::GetAccountType 给了$0</span></span><br><span class="line">  <span class="class">UserInfo::GetAccountType</span></span><br><span class="line">  <span class="keyword">Pop</span> <span class="variable">$0</span></span><br><span class="line">  <span class="comment">#E.4 逻辑函数库</span></span><br><span class="line">  <span class="variable">$&#123;If&#125;</span> <span class="variable">$0</span> != <span class="string">&quot;admin&quot;</span> <span class="comment">; Require admin rights on WinNT4+</span></span><br><span class="line">    <span class="comment">#参考4.9.4.15 MessageBox</span></span><br><span class="line">    <span class="keyword">MessageBox</span> MB_IconStop <span class="string">&quot;Administrator rights required!&quot;</span></span><br><span class="line">    <span class="keyword">SetErrorLevel</span> <span class="number">740</span> <span class="comment">; ERROR_ELEVATION_REQUIRED</span></span><br><span class="line">    <span class="keyword">Quit</span></span><br><span class="line">  <span class="variable">$&#123;EndIf&#125;</span></span><br><span class="line"><span class="keyword">!macro</span>end</span><br><span class="line"></span><br><span class="line"><span class="comment">#检查是否正在运行</span></span><br><span class="line"><span class="keyword">!macro</span> CheckRuning</span><br><span class="line">	<span class="keyword">StrCpy</span> <span class="variable">$1</span> <span class="string">&quot;<span class="variable">$(^Name)</span>.exe&quot;</span></span><br><span class="line">    <span class="class">nsProcess::_FindProcess</span> <span class="string">&quot;<span class="variable">$1</span>&quot;</span> </span><br><span class="line">    <span class="keyword">Pop</span> <span class="variable">$R0</span></span><br><span class="line">	<span class="keyword">IntCmp</span> <span class="variable">$R0</span> <span class="number">0</span> running no_running no_running</span><br><span class="line">	running:</span><br><span class="line">	<span class="keyword">MessageBox</span> <span class="params">MB_ICONQUESTION</span>|<span class="params">MB_YESNO</span> <span class="string">&quot;安装程序检测到 <span class="variable">$&#123;PRODUCT_NAME&#125;</span> 正在运行，是否强行关闭并继续安装?&quot;</span> <span class="params">IDYES</span> dokill <span class="params">IDNO</span> stopit</span><br><span class="line">	no_running:</span><br><span class="line">		GoTo endding</span><br><span class="line">	dokill:</span><br><span class="line">		<span class="class">nsProcess::_KillProcess</span> <span class="string">&quot;<span class="variable">$1</span>&quot;</span></span><br><span class="line">		<span class="keyword">Pop</span> <span class="variable">$R0</span></span><br><span class="line">		GoTo endding</span><br><span class="line">	stopit:</span><br><span class="line">		<span class="keyword">Abort</span></span><br><span class="line">	endding:</span><br><span class="line">		<span class="class">nsProcess::_Unload</span></span><br><span class="line"><span class="keyword">!macro</span>end</span><br><span class="line">      </span><br><span class="line"><span class="comment">#要使用带参数的VersionCompare宏定义，需要先插入</span></span><br><span class="line"><span class="keyword">!insertmacro</span> VersionCompare</span><br><span class="line"><span class="comment">#检查版本号</span></span><br><span class="line"><span class="keyword">!macro</span> CheckUpdate</span><br><span class="line">  <span class="keyword">ReadRegStr</span> <span class="variable">$1</span> <span class="params">HKLM</span>  <span class="string">&quot;Software\Microsoft\Windows\CurrentVersion\Uninstall\<span class="variable">$&#123;PRODUCT_NAME&#125;</span>&quot;</span> <span class="string">&quot;DisplayVersion&quot;</span>	<span class="comment">#取注册表键值</span></span><br><span class="line">  <span class="variable">$&#123;VersionCompare&#125;</span> <span class="string">&quot;<span class="variable">$1</span>&quot;</span> <span class="string">&quot;<span class="variable">$&#123;PRODUCT_VERSION&#125;</span>&quot;</span> <span class="variable">$2</span></span><br><span class="line">  <span class="variable">$&#123;IF&#125;</span> <span class="variable">$2</span> == <span class="number">1</span></span><br><span class="line">	<span class="keyword">MessageBox</span> <span class="params">MB_ICONQUESTION</span>|<span class="params">MB_YESNO</span> <span class="string">&quot;你系统中版本<span class="variable">$1</span>高于更新版本<span class="variable">$&#123;PRODUCT_VERSION&#125;</span>，是否继续安装?&quot;</span> <span class="params">IDYES</span> continue <span class="params">IDNO</span> stop</span><br><span class="line">	continue:</span><br><span class="line">		return</span><br><span class="line">	stop:</span><br><span class="line">		<span class="keyword">Abort</span></span><br><span class="line">  <span class="variable">$&#123;ElseIf&#125;</span>  <span class="variable">$2</span> == <span class="number">0</span></span><br><span class="line">	<span class="keyword">MessageBox</span> <span class="params">MB_OK</span> <span class="string">&quot;你系统中现有版本为<span class="variable">$1</span>，已为最新当前最新版本&quot;</span> <span class="params">IDOK</span></span><br><span class="line">    <span class="keyword">Abort</span></span><br><span class="line">  <span class="variable">$&#123;EndIf&#125;</span></span><br><span class="line">	return</span><br><span class="line"><span class="keyword">!macro</span>end</span><br><span class="line">      </span><br><span class="line"><span class="comment">#函数名以“.”开头的(例如 “.Whatever”)一般作为回调函数保留。</span></span><br><span class="line"><span class="comment">#参考4.7.2.1.2 .onInit</span></span><br><span class="line"><span class="function"><span class="keyword">Function</span> .onInit</span></span><br><span class="line">  <span class="keyword">!insertmacro</span> CheckRuning</span><br><span class="line">  <span class="keyword">!insertmacro</span> CheckUpdate</span><br><span class="line">  <span class="keyword">!insertmacro</span> MUI_LANGDLL_DISPLAY</span><br><span class="line">  <span class="keyword">!insertmacro</span> EnsureAdminRights</span><br><span class="line">FunctionEnd</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Section</span> &quot;MainSection&quot; SEC01</span></span><br><span class="line">  <span class="comment">#设置输出路径 ($OUTDIR) 且当路径不存在时创建 (需要时会递归创建)。必须为全路径名，通常都使用 $INSTDIR。</span></span><br><span class="line">  <span class="keyword">SetOutPath</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>&quot;</span></span><br><span class="line">  <span class="keyword">SetOverwrite</span> <span class="literal">try</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\2023122216.tzr&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\20231222161328.tzr&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\20231222164301.tzr&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\2023122216_Opt.tzr&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\2023122217.tzr&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\20240114152951.tzr&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\2024011509.tzr&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\2024011510.tzr&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\20240115101900.tzr&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\20240117162258.tzr&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\20240118161736最短距离Opt.tzr&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\AWTDataDecoder.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\awtz.conf&quot;</span></span><br><span class="line">  <span class="keyword">SetOutPath</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\bearer&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\bearer\qgenericbearer.dll&quot;</span></span><br><span class="line">  <span class="keyword">SetOutPath</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\blackLand.qss&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\config.iscas&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\crush32.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\currenttime.config&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\D3Dcompiler_47.dll&quot;</span></span><br><span class="line">  <span class="keyword">SetOutPath</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\dat\s57data&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\dat\s57data\C1100001.000&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\dat\s57data\C13A7300.000&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\dat\s57data\C1416170.000&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\dat\s57data\C1416310.000&quot;</span></span><br><span class="line">  <span class="keyword">SetOutPath</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\decode.exe&quot;</span></span><br><span class="line">  <span class="keyword">CreateDirectory</span> <span class="string">&quot;<span class="variable">$SMPROGRAMS</span>\OceanWindPlatform&quot;</span></span><br><span class="line">  <span class="keyword">CreateShortCut</span> <span class="string">&quot;<span class="variable">$SMPROGRAMS</span>\OceanWindPlatform\OceanWindPlatform.lnk&quot;</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\decode.exe&quot;</span></span><br><span class="line">  <span class="keyword">CreateShortCut</span> <span class="string">&quot;<span class="variable">$DESKTOP</span>\OceanWindPlatform.lnk&quot;</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\decode.exe&quot;</span></span><br><span class="line">  <span class="keyword">SetOutPath</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\doc&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\doc\天智全球海洋区域气象服务系统V1.0-用户手册-20231213.pdf&quot;</span></span><br><span class="line">  <span class="keyword">SetOutPath</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\FileTcpClient.exe&quot;</span></span><br><span class="line">  <span class="keyword">SetOutPath</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\iconengines&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\iconengines\qsvgicon.dll&quot;</span></span><br><span class="line">  <span class="keyword">SetOutPath</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\imageformats&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\imageformats\qgif.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\imageformats\qicns.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\imageformats\qico.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\imageformats\qjpeg.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\imageformats\qsvg.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\imageformats\qtga.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\imageformats\qtiff.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\imageformats\qwbmp.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\imageformats\qwebp.dll&quot;</span></span><br><span class="line">  <span class="keyword">SetOutPath</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\libEGL.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\libGLESV2.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\LibMComp.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\libzstd.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\logo.ico&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\mapConfig.conf&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\OceanWindPlatform.exe&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\opengl32sw.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\pdf.txt&quot;</span></span><br><span class="line">  <span class="keyword">SetOutPath</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\platforms&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\platforms\qwindows.dll&quot;</span></span><br><span class="line">  <span class="keyword">SetOutPath</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\printsupport&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\printsupport\windowsprintersupport.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\printsupport\windowsprintersupportd.dll&quot;</span></span><br><span class="line">  <span class="keyword">SetOutPath</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\readpdf\fitz&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\readpdf\fitz\_fitz.cp310-win_amd64.pyd&quot;</span></span><br><span class="line">  <span class="keyword">SetOutPath</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\readpdf&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\readpdf\python310.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\readpdf\readpdf.exe&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\readpdf\select.pyd&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\readpdf\ucrtbase.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\readpdf\unicodedata.pyd&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\readpdf\VCRUNTIME140.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\readpdf\zlib.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\readpdf\_bz2.pyd&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\readpdf\_decimal.pyd&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\readpdf\_hashlib.pyd&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\readpdf\_lzma.pyd&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\readpdf\_socket.pyd&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\readpdf\_ssl.pyd&quot;</span></span><br><span class="line">  <span class="keyword">SetOutPath</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\resource.rcc&quot;</span></span><br><span class="line">  <span class="keyword">SetOutPath</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\S57Lib&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\S57Lib\S57Attributes&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\S57Lib\S57Colours&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\S57Lib\S57ComplexLineStyles&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\S57Lib\S57LookupTable&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\S57Lib\S57ObjectClasses&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\S57Lib\S57Patterns&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\S57Lib\S57Symbols&quot;</span></span><br><span class="line">  <span class="keyword">SetOutPath</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\sqldrivers&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\sqldrivers\qsqlite.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\sqldrivers\qsqlmysql.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\sqldrivers\qsqlodbc.dll&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\sqldrivers\qsqlpsql.dll&quot;</span></span><br><span class="line">  <span class="keyword">SetOutPath</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\stationConfig.iscas&quot;</span></span><br><span class="line">  <span class="keyword">SetOutPath</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\styles&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\styles\qwindowsvistastyle.dll&quot;</span></span><br><span class="line">  <span class="keyword">SetOutPath</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\test.qss&quot;</span></span><br><span class="line">  <span class="keyword">SetOutPath</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\TZ-ImmedReq.xml&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\TzStart.exe&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\uninstallscript.qs&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\update.txt&quot;</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\OceanWindPlatform\user-route.iscas&quot;</span></span><br><span class="line">SectionEnd</span><br><span class="line"></span><br><span class="line"><span class="comment">#这个地方要特别注意，尤其是需要打包到其他机器上的文件，不管是在目标机器上安装还是就在那放着，需要都打包到安装包里，这个时候需要先把文件释放到目标机器的路径下面，然后再执行，最开始用的是直接ExecWait  &quot;third\RuntimePack x86 x64 17.3.14.exe&quot;，在其他机器上就没有这个文件，所以无法安装，现在按照下面的方式，先释放到目标路径下面，再执行安装就可以了</span></span><br><span class="line"><span class="function"><span class="keyword">Section</span> &quot;third&quot; SEC02</span></span><br><span class="line">  <span class="keyword">SetOutPath</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>&quot;</span></span><br><span class="line">  <span class="keyword">SetOverwrite</span> <span class="literal">try</span></span><br><span class="line">  <span class="keyword">File</span> <span class="string">&quot;F:\MyC-Example\install\Installer-nsis\third\RuntimePack x86 x64 17.3.14.exe&quot;</span></span><br><span class="line">  <span class="keyword">ExecWait</span>  <span class="string">&quot;<span class="variable">$INSTDIR</span>\RuntimePack x86 x64 17.3.14.exe&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\RuntimePack x86 x64 17.3.14.exe&quot;</span></span><br><span class="line">SectionEnd</span><br><span class="line"></span><br><span class="line"><span class="comment">#创建快捷方式</span></span><br><span class="line"><span class="function"><span class="keyword">Section</span> -AdditionalIcons</span></span><br><span class="line">  WriteIniStr <span class="string">&quot;<span class="variable">$INSTDIR</span>\<span class="variable">$&#123;PRODUCT_NAME&#125;</span>.url&quot;</span> <span class="string">&quot;InternetShortcut&quot;</span> <span class="string">&quot;URL&quot;</span> <span class="string">&quot;<span class="variable">$&#123;PRODUCT_WEB_SITE&#125;</span>&quot;</span></span><br><span class="line">  <span class="keyword">CreateShortCut</span> <span class="string">&quot;<span class="variable">$SMPROGRAMS</span>\<span class="variable">$(^Name)</span>\Website.lnk&quot;</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\<span class="variable">$&#123;PRODUCT_NAME&#125;</span>.url&quot;</span></span><br><span class="line">  <span class="keyword">CreateShortCut</span> <span class="string">&quot;<span class="variable">$SMPROGRAMS</span>\<span class="variable">$(^Name)</span>\Uninstall.lnk&quot;</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\uninst.exe&quot;</span></span><br><span class="line">  <span class="keyword">CreateShortCut</span> <span class="string">&quot;<span class="variable">$SMPROGRAMS</span>\<span class="variable">$(^Name)</span>\<span class="variable">$(^Name)</span>.lnk&quot;</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\<span class="variable">$(^Name)</span>.exe&quot;</span></span><br><span class="line">  <span class="keyword">CreateShortCut</span> <span class="string">&quot;<span class="variable">$DESKTOP</span>\<span class="variable">$(^Name)</span>.lnk&quot;</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\<span class="variable">$(^Name)</span>.exe&quot;</span></span><br><span class="line">  <span class="keyword">CreateShortCut</span> <span class="string">&quot;<span class="variable">$STARTMENU</span>\<span class="variable">$(^Name)</span>.lnk&quot;</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\<span class="variable">$(^Name)</span>.exe&quot;</span></span><br><span class="line">  <span class="keyword">CreateShortCut</span> <span class="string">&quot;<span class="variable">$QUICKLAUNCH</span>\<span class="variable">$(^Name)</span>.lnk&quot;</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\<span class="variable">$(^Name)</span>.exe&quot;</span></span><br><span class="line">  <span class="keyword">CreateShortCut</span> <span class="string">&quot;<span class="variable">$SMPROGRAMS</span>\<span class="variable">$(^Name)</span>.lnk&quot;</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\<span class="variable">$(^Name)</span>.exe&quot;</span></span><br><span class="line">SectionEnd</span><br><span class="line"></span><br><span class="line"><span class="comment">#创建控制面板中的删除选项</span></span><br><span class="line"><span class="function"><span class="keyword">Section</span> -Post</span></span><br><span class="line">  <span class="comment">#由指定的文件名(路径为可选项)写入卸载程序。</span></span><br><span class="line">  <span class="keyword">WriteUninstaller</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\uninst.exe&quot;</span></span><br><span class="line">  <span class="comment">#在 HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall 下创建一个以你的产品名为名的项，就可以向控制面板中的添加/删除程序添加一个条目。</span></span><br><span class="line">  <span class="comment">#参考D.2与4.9.2.17 WriteRegExpandStr</span></span><br><span class="line">  <span class="keyword">WriteRegStr</span> <span class="params">HKLM</span> <span class="string">&quot;<span class="variable">$&#123;PRODUCT_DIR_REGKEY&#125;</span>&quot;</span> <span class="string">&quot;&quot;</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\<span class="variable">$(^Name)</span>.exe&quot;</span></span><br><span class="line">  <span class="keyword">WriteRegStr</span> <span class="variable">$&#123;PRODUCT_UNINST_ROOT_KEY&#125;</span> <span class="string">&quot;<span class="variable">$&#123;PRODUCT_UNINST_KEY&#125;</span>&quot;</span> <span class="string">&quot;DisplayName&quot;</span> <span class="string">&quot;<span class="variable">$(^Name)</span>&quot;</span></span><br><span class="line">  <span class="keyword">WriteRegStr</span> <span class="variable">$&#123;PRODUCT_UNINST_ROOT_KEY&#125;</span> <span class="string">&quot;<span class="variable">$&#123;PRODUCT_UNINST_KEY&#125;</span>&quot;</span> <span class="string">&quot;UninstallString&quot;</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\uninst.exe&quot;</span></span><br><span class="line">  <span class="keyword">WriteRegStr</span> <span class="variable">$&#123;PRODUCT_UNINST_ROOT_KEY&#125;</span> <span class="string">&quot;<span class="variable">$&#123;PRODUCT_UNINST_KEY&#125;</span>&quot;</span> <span class="string">&quot;DisplayIcon&quot;</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\<span class="variable">$(^Name)</span>.exe&quot;</span></span><br><span class="line">  <span class="keyword">WriteRegStr</span> <span class="variable">$&#123;PRODUCT_UNINST_ROOT_KEY&#125;</span> <span class="string">&quot;<span class="variable">$&#123;PRODUCT_UNINST_KEY&#125;</span>&quot;</span> <span class="string">&quot;DisplayVersion&quot;</span> <span class="string">&quot;<span class="variable">$&#123;PRODUCT_VERSION&#125;</span>&quot;</span></span><br><span class="line">  <span class="keyword">WriteRegStr</span> <span class="variable">$&#123;PRODUCT_UNINST_ROOT_KEY&#125;</span> <span class="string">&quot;<span class="variable">$&#123;PRODUCT_UNINST_KEY&#125;</span>&quot;</span> <span class="string">&quot;URLInfoAbout&quot;</span> <span class="string">&quot;<span class="variable">$&#123;PRODUCT_WEB_SITE&#125;</span>&quot;</span></span><br><span class="line">  <span class="keyword">WriteRegStr</span> <span class="variable">$&#123;PRODUCT_UNINST_ROOT_KEY&#125;</span> <span class="string">&quot;<span class="variable">$&#123;PRODUCT_UNINST_KEY&#125;</span>&quot;</span> <span class="string">&quot;Publisher&quot;</span> <span class="string">&quot;<span class="variable">$&#123;PRODUCT_PUBLISHER&#125;</span>&quot;</span></span><br><span class="line">SectionEnd</span><br><span class="line"></span><br><span class="line"><span class="comment">#文件后缀与应用程序关联,不在安装界面中体现出来</span></span><br><span class="line"><span class="function"><span class="keyword">Section</span> -IconExe</span></span><br><span class="line">  <span class="keyword">WriteRegStr</span> <span class="params">HKCR</span> <span class="string">&quot;.TZP&quot;</span> <span class="string">&quot;&quot;</span> <span class="string">&quot;TZP.File&quot;</span></span><br><span class="line">  <span class="keyword">WriteRegStr</span> <span class="params">HKCR</span> <span class="string">&quot;TZP.File&quot;</span> <span class="string">&quot;&quot;</span> <span class="string">&quot;天智全球海洋区域气象服务系统文件&quot;</span>                       <span class="comment">; 文件类型名称</span></span><br><span class="line">  <span class="keyword">WriteRegStr</span> <span class="params">HKCR</span> <span class="string">&quot;TZP.File\DefaultIcon&quot;</span> <span class="string">&quot;&quot;</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\logo.ico&quot;</span>       <span class="comment">; 图标</span></span><br><span class="line">  <span class="keyword">WriteRegStr</span> <span class="params">HKCR</span> <span class="string">&quot;TZP.File\shell&quot;</span> <span class="string">&quot;&quot;</span> <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="keyword">WriteRegStr</span> <span class="params">HKCR</span> <span class="string">&quot;TZP.File\shell\open&quot;</span> <span class="string">&quot;&quot;</span> <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="keyword">WriteRegStr</span> <span class="params">HKCR</span> <span class="string">&quot;TZP.File\shell\open\command&quot;</span> <span class="string">&quot;&quot;</span> <span class="string">&#x27;&quot;<span class="variable">$InstDir</span>\<span class="variable">$(^Name)</span>.exe&quot; &quot;%1&quot;&#x27;</span> <span class="comment">; 运行时指令，单引号里的内容同前面FTYPE指令</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">#刷新桌面图标缓存</span></span><br><span class="line">  <span class="variable">$&#123;RefreshShellIcons&#125;</span></span><br><span class="line">SectionEnd</span><br><span class="line"></span><br><span class="line"><span class="comment">; Section descriptions</span></span><br><span class="line"><span class="keyword">!insertmacro</span> MUI_FUNCTION_DESCRIPTION_BEGIN</span><br><span class="line">  <span class="keyword">!insertmacro</span> MUI_DESCRIPTION_TEXT <span class="variable">$&#123;SEC01&#125;</span> <span class="string">&quot;主程序&quot;</span></span><br><span class="line">  <span class="keyword">!insertmacro</span> MUI_DESCRIPTION_TEXT <span class="variable">$&#123;SEC02&#125;</span> <span class="string">&quot;库文件&quot;</span></span><br><span class="line"><span class="keyword">!insertmacro</span> MUI_FUNCTION_DESCRIPTION_END</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Function</span> un.onUninstSuccess</span></span><br><span class="line">  <span class="keyword">HideWindow</span></span><br><span class="line">  <span class="keyword">MessageBox</span> <span class="params">MB_ICONINFORMATION</span>|<span class="params">MB_OK</span> <span class="string">&quot;<span class="variable">$(^Name)</span> 已成功地从你的计算机移除。&quot;</span></span><br><span class="line">FunctionEnd</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">Function</span> un.onInit</span></span><br><span class="line"><span class="keyword">!insertmacro</span> CheckRuning</span><br><span class="line"><span class="keyword">!insertmacro</span> EnsureAdminRights</span><br><span class="line"><span class="keyword">!insertmacro</span> MUI_UNGETLANGUAGE</span><br><span class="line"> <span class="comment">#相对跳转由数字标定。+1 跳转到下一条指令 (默认的步进)，+2 会跳过一条指令也并且从当前指令转到第二条指令，-2 将往后跳两条指令，+10 将会跳过 9 条指令，从当前指令跳到第十条指令。</span></span><br><span class="line">  <span class="comment">#参考4.4 相对跳转</span></span><br><span class="line">  <span class="comment">#错误时跳转的标记 [没有错误时跳转的标记]（有错误就执行下面的MessageBox,没有错误就跳3行向下执行）</span></span><br><span class="line">  <span class="keyword">MessageBox</span> <span class="params">MB_ICONQUESTION</span>|<span class="params">MB_YESNO</span>|<span class="params">MB_DEFBUTTON2</span> <span class="string">&quot;你确实要完全移除 <span class="variable">$(^Name)</span> ，其及所有的组件？&quot;</span> <span class="params">IDYES</span> +<span class="number">2</span></span><br><span class="line">  <span class="keyword">Abort</span></span><br><span class="line">FunctionEnd</span><br><span class="line"></span><br><span class="line"><span class="comment">#如果区段名为空、遗漏或者以一个 - 开头，那么它将是一个隐藏的区段，用户也不能选择禁止它。如果一个区段名为“Uninstall”或以“un.”为前缀，那么它就是一个卸载程序区段。</span></span><br><span class="line"><span class="comment">#参考4.6.1.2 Section</span></span><br><span class="line"><span class="function"><span class="keyword">Section</span> Uninstall</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\<span class="variable">$&#123;PRODUCT_NAME&#125;</span>.url&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\uninst.exe&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\user-route.iscas&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\update.txt&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\uninstallscript.qs&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\TzStart.exe&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\TZ-ImmedReq.xml&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\test.qss&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\styles\qwindowsvistastyle.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\stationConfig.iscas&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\sqldrivers\qsqlpsql.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\sqldrivers\qsqlodbc.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\sqldrivers\qsqlmysql.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\sqldrivers\qsqlite.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\S57Lib\S57Symbols&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\S57Lib\S57Patterns&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\S57Lib\S57ObjectClasses&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\S57Lib\S57LookupTable&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\S57Lib\S57ComplexLineStyles&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\S57Lib\S57Colours&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\S57Lib\S57Attributes&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\resource.rcc&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\readpdf\_ssl.pyd&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\readpdf\_socket.pyd&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\readpdf\_lzma.pyd&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\readpdf\_hashlib.pyd&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\readpdf\_decimal.pyd&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\readpdf\_bz2.pyd&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\readpdf\zlib.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\readpdf\VCRUNTIME140.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\readpdf\unicodedata.pyd&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\readpdf\ucrtbase.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\readpdf\select.pyd&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\readpdf\readpdf.exe&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\readpdf\python310.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\readpdf\fitz\_fitz.cp310-win_amd64.pyd&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\readpdf\base_library.zip&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\qwt.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\Qt5Xml.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\Qt5Widgets.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\Qt5Svg.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\Qt5Sql.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\Qt5PrintSupport.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\Qt5OpenGL.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\Qt5Network.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\Qt5Gui.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\Qt5Core.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\Qt5Charts.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\qrc_resource.tmp.obj&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\qrc_resource.obj&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\qrc_resource.cpp&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\pthreadVC2.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\ProhebitedArea.phb&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\printsupport\windowsprintersupportd.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\printsupport\windowsprintersupport.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\platforms\qwindows.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\pdf.txt&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\opengl32sw.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\OceanWindPlatform.exe&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\mapConfig.conf&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\logo.ico&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\FileTcpClient.exe&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\doc\天智全球海洋区域气象服务系统V1.0-用户手册-20231213.pdf&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\decode.exe&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\D3Dcompiler_47.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\currenttime.config&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\crush32.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\config.iscas&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\blackLand.qss&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\bearer\qgenericbearer.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\awtz.conf&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\AWTDataDecoder.dll&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\20240118161736最短距离Opt.tzr&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\20240117162258.tzr&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\20240115101900.tzr&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\2024011510.tzr&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\2024011509.tzr&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\20240114152951.tzr&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\2023122217.tzr&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\2023122216_Opt.tzr&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\20231222164301.tzr&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\20231222161328.tzr&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\2023122216.tzr&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$SMPROGRAMS</span>\OceanWindPlatform\Uninstall.lnk&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$SMPROGRAMS</span>\OceanWindPlatform\Website.lnk&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$DESKTOP</span>\OceanWindPlatform.lnk&quot;</span></span><br><span class="line">  <span class="keyword">Delete</span> <span class="string">&quot;<span class="variable">$SMPROGRAMS</span>\OceanWindPlatform\OceanWindPlatform.lnk&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">RMDir</span> <span class="string">&quot;<span class="variable">$SMPROGRAMS</span>\OceanWindPlatform&quot;</span></span><br><span class="line">  <span class="keyword">RMDir</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\translations&quot;</span></span><br><span class="line">  <span class="keyword">RMDir</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\styles&quot;</span></span><br><span class="line">  <span class="keyword">RMDir</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\sqldrivers&quot;</span></span><br><span class="line">  <span class="keyword">RMDir</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\saveImg&quot;</span></span><br><span class="line">  <span class="keyword">RMDir</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\S57Lib&quot;</span></span><br><span class="line">  <span class="keyword">RMDir</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\readpdf\fitz&quot;</span></span><br><span class="line">  <span class="keyword">RMDir</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\readpdf&quot;</span></span><br><span class="line">  <span class="keyword">RMDir</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\printsupport&quot;</span></span><br><span class="line">  <span class="keyword">RMDir</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\platforms&quot;</span></span><br><span class="line">  <span class="keyword">RMDir</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\imageformats&quot;</span></span><br><span class="line">  <span class="keyword">RMDir</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\iconengines&quot;</span></span><br><span class="line">  <span class="keyword">RMDir</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\doc&quot;</span></span><br><span class="line">  <span class="keyword">RMDir</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\dat&quot;</span></span><br><span class="line">  <span class="keyword">RMDir</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\bearer&quot;</span></span><br><span class="line">  <span class="keyword">RMDir</span> -r <span class="string">&quot;<span class="variable">$INSTDIR</span>&quot;</span></span><br><span class="line">  <span class="keyword">RMDir</span> -r <span class="string">&quot;<span class="variable">$INSTDIR</span>\&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">DeleteRegKey</span> <span class="variable">$&#123;PRODUCT_UNINST_ROOT_KEY&#125;</span> <span class="string">&quot;<span class="variable">$&#123;PRODUCT_UNINST_KEY&#125;</span>&quot;</span></span><br><span class="line">  <span class="keyword">DeleteRegKey</span> <span class="params">HKLM</span> <span class="string">&quot;<span class="variable">$&#123;PRODUCT_DIR_REGKEY&#125;</span>&quot;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">#解除文件后缀与应用程序关联</span></span><br><span class="line">  <span class="keyword">DeleteRegKey</span> <span class="params">HKCR</span> <span class="string">&quot;.TZP&quot;</span></span><br><span class="line">  <span class="comment">#刷新桌面图标缓存</span></span><br><span class="line">  <span class="variable">$&#123;un.RefreshShellIcons&#125;</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">SetAutoClose</span> <span class="literal">true</span></span><br><span class="line">SectionEnd</span><br></pre></td></tr></table></figure>

<h2 id="开机自启动"><a href="#开机自启动" class="headerlink" title="开机自启动"></a>开机自启动</h2><p>对于制作好的安装包，有些时候可能需要在安装完成界面上添加一个可勾选的开机自启动的选项。</p>
<p>下面是具体的细节：</p>
<p>1.在安装完成界面设置添加如下代码：</p>
<figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">!define</span> MUI_FINISHPAGE_SHOWREADME</span><br><span class="line"><span class="keyword">!define</span> MUI_FINISHPAGE_SHOWREADME_Function AutoBoot</span><br><span class="line"><span class="keyword">!define</span> MUI_FINISHPAGE_SHOWREADME_TEXT <span class="string">&quot;开机自启动&quot;</span></span><br></pre></td></tr></table></figure>

<p>上面的代码务必要添加在 “ !insertmacro MUI_PAGE_FINISH “之前。</p>
<p><img src="/2021/06/27/Qt/c4614f0b67ee4bbd9e5517fda4cbaba5.png" alt="img"></p>
<p>2.在Section后区段的后面添加Function部分（在Section之后，是为了避免产生未知的错误）</p>
<p>代码如下：</p>
<figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">Function</span> AutoBoot</span></span><br><span class="line">    <span class="keyword">WriteRegStr</span> <span class="params">HKCU</span> <span class="string">&quot;Software\Microsoft\Windows\CurrentVersion\Run&quot;</span> <span class="string">&quot;testKey&quot;</span> <span class="string">&quot;test.exe&quot;</span></span><br><span class="line">FunctionEnd</span><br></pre></td></tr></table></figure>

<p>把上面的test替换成你要打包程序名就行了，主要是把信息写入系统注册表。</p>
<p>3.前两步已经可以实现开机自启动了。这最后一步，需要在卸载和初始化区段里面把注册表信息删除。原因是让用户在卸载程序和覆盖安装程序后，不会受到刚开始安装程序的写入系统注册表的影响。</p>
<p>在Section Uninstall里面添加如下代码：</p>
<figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">;删除开机自启</span></span><br><span class="line"><span class="keyword">DeleteRegValue</span> <span class="params">HKCU</span> <span class="string">&quot;Software\Microsoft\Windows\CurrentVersion\Run&quot;</span> <span class="string">&quot;testKey&quot;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/06/27/Qt/a650e7c64615416b85869109cc5b4506.png" alt="img"></p>
<p>最后编译运行，就会发现在程序的安装完成界面出现了可勾选的开机自启动选项。</p>
<h3 id="注册启动项"><a href="#注册启动项" class="headerlink" title="注册启动项"></a>注册启动项</h3><ul>
<li><p>WriteRegStr</p>
<p>root_key + subkey + key_name + value</p>
</li>
<li><p>以Test.exe为例, 注册启动项命令如下</p>
<p>WriteRegStr HKCU “Software\Microsoft\Windows\CurrentVersion\Run” “TestAddKey” “$INSTDIR\Test.exe”</p>
</li>
<li><p>#该命令放在安装区域(Section “MainSection” SEC01), 或者注册区域(Section -Post)都可以</p>
</li>
</ul>
<p>命令解释:</p>
<p>root_key: 注册表根键值: HKCU (HKEY_CURRENT_USER)<br>subkey: 子键值: Run键(解释见前言)<br>key_name: 新增键值名称: TestAddKey<br>value: 启动命令: “Test.exe绝对路径”, 如有命令行参数可以在路径后添加</p>
<h3 id="删除启动项"><a href="#删除启动项" class="headerlink" title="删除启动项"></a>删除启动项</h3><ul>
<li><p>DeleteRegValue</p>
<p>root_key + subkey + key_name</p>
</li>
<li><p>以Test.exe为例, 删除启动项命令如下</p>
<p>DeleteRegValue HKCU “Software\Microsoft\Windows\CurrentVersion\Run” “TestAddKey”</p>
</li>
<li><p>#该命令放在卸载命令区域(Section Uninstall)</p>
</li>
</ul>
<p>命令解释:</p>
<p>root_key: 注册表根键: HKCU (HKEY_CURRENT_USER)<br>subkey: 子键位置: Run键(解释见前言)<br>key_name: 要删除的Key名称: TestAddKey</p>
<h3 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h3><p>打开注册表: WIN + R 输入: regedit</p>
<p><img src="/2021/06/27/Qt/3df60040bd574a51a70a79c368020ad8.png" alt="img"></p>
<p>在HKCU下依次展开找到Run键<br>观察Run键下子键是否新增/删除, 键值是否正确</p>
<h2 id="解决程序安装后要右键管理员权限运行问题"><a href="#解决程序安装后要右键管理员权限运行问题" class="headerlink" title="解决程序安装后要右键管理员权限运行问题"></a>解决程序安装后要右键管理员权限运行问题</h2><p>如下图，加入一下几行代码</p>
<figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">;让安装程序以管理权限运行</span></span><br><span class="line"><span class="keyword">RequestExecutionLevel</span> <span class="literal">admin</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">Section</span> &quot;test&quot;</span></span><br><span class="line"> 	<span class="comment">;针对当前用户有效</span></span><br><span class="line">	<span class="keyword">WriteRegStr</span> <span class="params">HKCU</span> <span class="string">&quot;SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers&quot;</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\xxxx.exe&quot;</span> <span class="string">&quot;RUNASADMIN&quot;</span></span><br><span class="line">	<span class="comment">;针对所有用户有效</span></span><br><span class="line">	<span class="keyword">WriteRegStr</span> <span class="params">HKEY_LOCAL_MACHINE</span> <span class="string">&quot;SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers&quot;</span> <span class="string">&quot;<span class="variable">$INSTDIR</span>\xxxx.exe&quot;</span> <span class="string">&quot;RUNASADMIN&quot;</span></span><br><span class="line">SectionEnd</span><br></pre></td></tr></table></figure>

<p><img src="/2021/06/27/Qt/36f98d15ab8847e3ab3a33c4d82875a0.png" alt="img"></p>
<p>注意：程序安装时需要使用管理员权限进行安装，才能往注册写入信息</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Smt</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://zwlbird.github.io/2021/06/27/Qt/">https://zwlbird.github.io/2021/06/27/Qt/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://zwlbird.github.io" target="_blank">.oOo.</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Qt/">Qt</a><a class="post-meta__tags" href="/tags/qss/">qss</a></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2023/12/12/SNjXLprxbadKoJ8.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/07/13/C-11/"><img class="prev-cover" src="https://s2.loli.net/2023/12/12/w6gBS4XVHa8hA7O.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">C++11</div></div></a></div><div class="next-post pull-right"><a href="/2021/06/27/C/"><img class="next-cover" src="https://s2.loli.net/2023/12/12/cYpI451Z9oJwFqQ.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">C++</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/04/03/Hexo/" title="Hexo"><img class="cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-03</div><div class="title">Hexo</div></div></a></div><div><a href="/2021/09/21/OpenGL-3D/" title="OpenGL_3D"><img class="cover" src="https://s2.loli.net/2023/12/12/EZS5QGm23HLgvW4.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-09-21</div><div class="title">OpenGL_3D</div></div></a></div><div><a href="/2021/09/06/OpenGL/" title="OpenGL"><img class="cover" src="https://s2.loli.net/2023/12/12/7cnySuV5TfLolQX.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-09-06</div><div class="title">OpenGL</div></div></a></div><div><a href="/2021/06/27/C/" title="C++"><img class="cover" src="https://s2.loli.net/2023/12/12/cYpI451Z9oJwFqQ.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-27</div><div class="title">C++</div></div></a></div><div><a href="/2021/06/27/函数积累/" title="函数积累"><img class="cover" src="https://s2.loli.net/2023/12/12/dkLQxaftyKTzXoR.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-27</div><div class="title">函数积累</div></div></a></div><div><a href="/2021/06/20/头文件/" title="头文件"><img class="cover" src="https://i.loli.net/2021/06/27/bhoY29lQPvSAr6z.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-20</div><div class="title">头文件</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Smt</div><div class="author-info__description">哇咔咔</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/zwlbird/zwlbird.github.io" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:zwl931025@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">This is my Blog This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#qt%E4%B8%B4%E6%97%B6%E5%AD%98%E5%82%A8%E5%BA%93"><span class="toc-number">1.</span> <span class="toc-text">qt临时存储库</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#QT%E4%B8%ADQString-%E6%A0%BC%E5%BC%8F%E5%8C%96-arg%E5%89%8D%E9%9D%A2%E8%87%AA%E5%8A%A8%E8%A1%A50"><span class="toc-number">2.</span> <span class="toc-text">QT中QString 格式化 arg前面自动补0</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E7%94%9F%E6%88%90moc"><span class="toc-number">3.</span> <span class="toc-text">手动生成moc</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BC%96%E8%AF%91rcc"><span class="toc-number">4.</span> <span class="toc-text">编译rcc</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#qimage-%E5%88%9B%E5%BB%BA%E8%83%8C%E6%99%AF%E8%89%B2%E9%80%8F%E6%98%8E"><span class="toc-number">5.</span> <span class="toc-text">qimage 创建背景色透明</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#QPainter-%E8%AE%BE%E7%BD%AE%E7%BA%BF%E5%BD%A2%EF%BC%8C%E5%A1%AB%E5%85%85%EF%BC%8C%E7%AC%94%E5%B8%BD%EF%BC%8C%E5%9C%86%E7%82%B9"><span class="toc-number">6.</span> <span class="toc-text">QPainter 设置线形，填充，笔帽，圆点</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9A%8F%E9%BC%A0%E6%A0%87%E8%BF%9B%E5%85%A5%E7%8E%B0%E5%AE%9E%E5%9B%BE%E7%89%87%E6%94%BE%E5%A4%A7"><span class="toc-number">7.</span> <span class="toc-text">随鼠标进入现实图片放大</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95"><span class="toc-number">8.</span> <span class="toc-text">右键菜单</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#QT%E2%80%945%E7%A7%8D%E6%A0%87%E5%87%86%E5%AF%B9%E8%AF%9D%E6%A1%86"><span class="toc-number">9.</span> <span class="toc-text">QT—5种标准对话框</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#QFileDialog%E6%96%87%E4%BB%B6%E5%AF%B9%E8%AF%9D%E6%A1%86"><span class="toc-number">9.1.</span> <span class="toc-text">QFileDialog文件对话框</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#QColorDialog%E9%A2%9C%E8%89%B2%E5%AF%B9%E8%AF%9D%E6%A1%86"><span class="toc-number">9.2.</span> <span class="toc-text">QColorDialog颜色对话框</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#QFontDialog%E5%AD%97%E4%BD%93%E5%AF%B9%E8%AF%9D%E6%A1%86"><span class="toc-number">9.3.</span> <span class="toc-text">QFontDialog字体对话框</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#QInputDialog%E8%BE%93%E5%85%A5%E5%AF%B9%E8%AF%9D%E6%A1%86"><span class="toc-number">9.4.</span> <span class="toc-text">QInputDialog输入对话框</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#QMessageBox%E6%B6%88%E6%81%AF%E6%A1%86"><span class="toc-number">9.5.</span> <span class="toc-text">QMessageBox消息框</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%B6%88%E6%81%AF%E6%A1%86"><span class="toc-number">9.6.</span> <span class="toc-text">自定义消息框</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%87%8D%E5%86%99QLabel%EF%BC%8C%E6%8F%90%E5%8D%87UI%E9%83%A8%E4%BB%B6%EF%BC%8C%E8%B0%83%E7%94%A8PaintEvent"><span class="toc-number">10.</span> <span class="toc-text">重写QLabel，提升UI部件，调用PaintEvent</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#QThread"><span class="toc-number">11.</span> <span class="toc-text">QThread</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#QCoreApplication%E5%92%8CQApplication%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">12.</span> <span class="toc-text">QCoreApplication和QApplication的区别</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#pro%E6%96%87%E4%BB%B6%E7%9B%B8%E5%85%B3"><span class="toc-number">13.</span> <span class="toc-text">pro文件相关</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ui-%E5%88%9B%E5%BB%BAwidget%E5%B9%B6%E6%94%BE%E5%A4%A7%E5%9B%BE%E7%89%87-dock%E5%81%9C%E9%9D%A0"><span class="toc-number">14.</span> <span class="toc-text">ui 创建widget并放大图片,dock停靠</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8B%96%E6%94%BE%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%88%B0%E4%B8%80%E4%B8%AAexe%EF%BC%8C%E6%89%93%E5%BC%80%E8%AF%A5exe"><span class="toc-number">15.</span> <span class="toc-text">拖放配置文件到一个exe，打开该exe</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%A8%8B%E5%BA%8F%E6%AF%8F%E6%AC%A1%E5%8F%AA%E8%83%BD%E6%9C%89%E4%B8%80%E4%B8%AA%E5%AE%9E%E4%BE%8B%E8%BF%90%E8%A1%8C"><span class="toc-number">16.</span> <span class="toc-text">程序每次只能有一个实例运行</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%90%8E%E7%BC%80%E5%85%B3%E8%81%94%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%EF%BC%8C%E5%8F%8C%E5%87%BB%E6%96%87%E4%BB%B6%E6%89%93%E5%BC%80%E5%AF%B9%E5%BA%94%E7%A8%8B%E5%BA%8F"><span class="toc-number">17.</span> <span class="toc-text">文件后缀关联应用程序，双击文件打开对应程序</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Qt-%E8%B0%83%E7%94%A8%E5%85%B6%E4%BB%96exe"><span class="toc-number">18.</span> <span class="toc-text">Qt 调用其他exe</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B01"><span class="toc-number">18.1.</span> <span class="toc-text">传递参数1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B02"><span class="toc-number">18.2.</span> <span class="toc-text">传递参数2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%A6dos%E7%95%8C%E9%9D%A2"><span class="toc-number">18.3.</span> <span class="toc-text">带dos界面</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E5%B8%A6dos%E7%95%8C%E9%9D%A2"><span class="toc-number">18.4.</span> <span class="toc-text">不带dos界面</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%ACjson"><span class="toc-number">19.</span> <span class="toc-text">字符串转json</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Qt%E4%BD%BF%E7%94%A8HTTP%E9%80%9A%E4%BF%A1%EF%BC%88%E4%BB%A5%E8%B0%83%E7%94%A8%E7%99%BE%E5%BA%A6%E7%BF%BB%E8%AF%91api%E4%B8%BA%E4%BE%8B%EF%BC%89"><span class="toc-number">20.</span> <span class="toc-text">Qt使用HTTP通信（以调用百度翻译api为例）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#TextEdit%E4%B8%AD%E6%98%BE%E7%A4%BA%E6%97%A5%E6%96%87"><span class="toc-number">21.</span> <span class="toc-text">TextEdit中显示日文</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#qt%E5%A4%9A%E6%98%BE%E7%A4%BA%E5%99%A8%E8%8E%B7%E5%8F%96%E4%B8%8D%E5%90%8C%E6%98%BE%E7%A4%BA%E5%99%A8%E7%9A%84%E5%88%86%E8%BE%A8%E7%8E%87%E5%92%8C%E4%BD%8D%E7%BD%AE"><span class="toc-number">22.</span> <span class="toc-text">qt多显示器获取不同显示器的分辨率和位置</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#QPainter%E6%97%8B%E8%BD%AC"><span class="toc-number">23.</span> <span class="toc-text">QPainter旋转</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1%E6%A0%8F%E9%9A%90%E8%97%8F%E5%9B%BE%E6%A0%87"><span class="toc-number">23.1.</span> <span class="toc-text">任务栏隐藏图标</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MQTT"><span class="toc-number">24.</span> <span class="toc-text">MQTT</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#mosquitto-sub"><span class="toc-number">24.1.</span> <span class="toc-text">mosquitto_sub</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mosquitto-pub"><span class="toc-number">24.2.</span> <span class="toc-text">mosquitto_pub</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mosquito-conf-%E9%85%8D%E7%BD%AE"><span class="toc-number">24.3.</span> <span class="toc-text">mosquito.conf 配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE"><span class="toc-number">24.4.</span> <span class="toc-text">用户文件配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%87%8D%E5%90%AF%E6%9C%8D%E5%8A%A1"><span class="toc-number">24.5.</span> <span class="toc-text">重启服务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A2%E9%98%85"><span class="toc-number">24.6.</span> <span class="toc-text">订阅</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%91%E5%B8%83"><span class="toc-number">24.7.</span> <span class="toc-text">发布</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E9%97%AE%E9%A2%98"><span class="toc-number">24.8.</span> <span class="toc-text">编译问题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Ubuntu%E4%B8%8B%EF%BC%8CQt-%E8%B0%83%E7%94%A8bash%E6%89%A7%E8%A1%8Cpython%E8%84%9A%E6%9C%AC"><span class="toc-number">25.</span> <span class="toc-text">Ubuntu下，Qt 调用bash执行python脚本</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Qt-%E5%8F%91%E9%80%81%E5%9B%BE%E7%89%87"><span class="toc-number">26.</span> <span class="toc-text">Qt 发送图片</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#QTableWidget"><span class="toc-number">27.</span> <span class="toc-text">QTableWidget</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Qt-%E5%8F%91%E9%82%AE%E4%BB%B6"><span class="toc-number">28.</span> <span class="toc-text">Qt 发邮件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%99%84-%E5%B8%B8%E7%94%A8%E9%82%AE%E7%AE%B1SMTP%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9C%B0%E5%9D%80%E5%A4%A7%E5%85%A8"><span class="toc-number">28.1.</span> <span class="toc-text">附:常用邮箱SMTP服务器地址大全</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SMTP%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">28.2.</span> <span class="toc-text">SMTP服务器的作用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#stylesheet"><span class="toc-number">29.</span> <span class="toc-text">stylesheet</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E7%BD%91%E7%AB%99"><span class="toc-number">29.1.</span> <span class="toc-text">参考网站</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%93%E5%8D%B0%E6%A0%91%E7%BB%93%E6%9E%84"><span class="toc-number">29.2.</span> <span class="toc-text">打印树结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#box-model"><span class="toc-number">29.3.</span> <span class="toc-text">box model</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%99%84-%E7%9B%92%E5%AD%90%E6%A8%A1%E5%9E%8B%E6%94%AF%E6%8C%81%E7%9A%84%E7%BB%84%E4%BB%B6"><span class="toc-number">29.3.1.</span> <span class="toc-text">附 盒子模型支持的组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Palette"><span class="toc-number">29.4.</span> <span class="toc-text">Palette</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-setBrush"><span class="toc-number">29.4.1.</span> <span class="toc-text">1.1 setBrush</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-1-%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%88%B7QPalette-ColorGroup"><span class="toc-number">29.4.1.1.</span> <span class="toc-text">1.1.1 什么时候刷QPalette::ColorGroup</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-2-%E5%9C%A8%E5%93%AA%E5%88%B7QPalette-ColorRole"><span class="toc-number">29.4.1.2.</span> <span class="toc-text">1.1.2 在哪刷QPalette::ColorRole</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-3-%E5%88%B7%E6%88%90%E4%BB%80%E4%B9%88%E6%A0%B7QBrush"><span class="toc-number">29.4.1.3.</span> <span class="toc-text">1.1.3 刷成什么样QBrush</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-setColor"><span class="toc-number">29.4.2.</span> <span class="toc-text">1.2 setColor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B"><span class="toc-number">29.4.3.</span> <span class="toc-text">示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Style-Sheets"><span class="toc-number">29.5.</span> <span class="toc-text">Style Sheets</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B7%E5%BC%8F%E8%A7%84%E5%88%99"><span class="toc-number">29.5.1.</span> <span class="toc-text">样式规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E5%99%A8"><span class="toc-number">29.5.2.</span> <span class="toc-text">选择器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%B1%BB%E5%9E%8B%E9%80%89%E6%8B%A9%E5%99%A8"><span class="toc-number">29.5.2.1.</span> <span class="toc-text">1 类型选择器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E9%80%9A%E7%94%A8%E9%80%89%E6%8B%A9%E5%99%A8"><span class="toc-number">29.5.2.2.</span> <span class="toc-text">2 通用选择器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E7%BB%84%E9%80%89%E6%8B%A9%E5%99%A8"><span class="toc-number">29.5.2.3.</span> <span class="toc-text">3 组选择器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%90%8E%E4%BB%A3%E9%80%89%E6%8B%A9%E5%99%A8"><span class="toc-number">29.5.2.4.</span> <span class="toc-text">4 后代选择器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E5%AD%90%E9%80%89%E6%8B%A9%E5%99%A8"><span class="toc-number">29.5.2.5.</span> <span class="toc-text">5 子选择器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E5%B1%9E%E6%80%A7%E9%80%89%E6%8B%A9%E5%99%A8"><span class="toc-number">29.5.2.6.</span> <span class="toc-text">6 属性选择器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E5%8A%A8%E6%80%81%E5%B1%9E%E6%80%A7%E9%80%89%E6%8B%A9%E5%99%A8"><span class="toc-number">29.5.2.7.</span> <span class="toc-text">7 动态属性选择器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-%E7%82%B9%E5%8F%B7%E7%B1%BB%E5%9E%8B%E9%80%89%E6%8B%A9%E5%99%A8"><span class="toc-number">29.5.2.8.</span> <span class="toc-text">8 点号类型选择器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-id%E9%80%89%E6%8B%A9%E5%99%A8"><span class="toc-number">29.5.2.9.</span> <span class="toc-text">9 id选择器</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sub-Controls"><span class="toc-number">29.5.3.</span> <span class="toc-text">Sub-Controls</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%99%84-%E5%AD%90%E6%8E%A7%E4%BB%B6%E5%88%97%E8%A1%A8"><span class="toc-number">29.5.3.1.</span> <span class="toc-text">附  子控件列表</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%AA%E7%8A%B6%E6%80%81"><span class="toc-number">29.5.4.</span> <span class="toc-text">伪状态</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%99%84-%E4%BC%AA%E7%8A%B6%E6%80%81%E5%88%97%E8%A1%A8"><span class="toc-number">29.5.4.1.</span> <span class="toc-text">附 伪状态列表</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E5%88%97%E8%A1%A8"><span class="toc-number">29.5.5.</span> <span class="toc-text">属性列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E5%86%B2%E7%AA%81"><span class="toc-number">29.5.6.</span> <span class="toc-text">解决冲突</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%A7%E8%81%94"><span class="toc-number">29.5.7.</span> <span class="toc-text">级联</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%A7%E6%89%BF"><span class="toc-number">29.5.8.</span> <span class="toc-text">继承</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#C-%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%E5%86%85%E7%9A%84%E9%83%A8%E4%BB%B6"><span class="toc-number">29.5.9.</span> <span class="toc-text">C++命名空间内的部件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="toc-number">29.5.10.</span> <span class="toc-text">设置对象的属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E4%B8%BA%E5%85%A8%E5%B1%80%E6%B7%BB%E5%8A%A0QSS%E6%A0%B7%E5%BC%8F%EF%BC%88%E5%85%A8%E5%B1%80%E5%8A%A0%E8%BD%BDQSS%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%89"><span class="toc-number">29.5.11.</span> <span class="toc-text">如何为全局添加QSS样式（全局加载QSS的方法）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Demo"><span class="toc-number">29.6.</span> <span class="toc-text">Demo</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#QTabWidget%E3%80%81QTableView"><span class="toc-number">29.6.1.</span> <span class="toc-text">QTabWidget、QTableView</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#mysue"><span class="toc-number">29.6.1.1.</span> <span class="toc-text">mysue</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BB%9A%E5%8A%A8%E6%9D%A1QScrollBar"><span class="toc-number">29.6.2.</span> <span class="toc-text">滚动条QScrollBar</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#example-1"><span class="toc-number">29.6.2.1.</span> <span class="toc-text">example 1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#example-2"><span class="toc-number">29.6.2.2.</span> <span class="toc-text">example 2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#myuse"><span class="toc-number">29.6.2.3.</span> <span class="toc-text">myuse</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#QProgressBar"><span class="toc-number">29.6.3.</span> <span class="toc-text">QProgressBar</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#myuse-1"><span class="toc-number">29.6.3.1.</span> <span class="toc-text">myuse</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AEQwidget%E7%B1%BB%E8%83%8C%E6%99%AF%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93"><span class="toc-number">29.6.4.</span> <span class="toc-text">设置Qwidget类背景方法总结</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E5%BC%95%E8%A8%80"><span class="toc-number">29.6.4.1.</span> <span class="toc-text">1、引言</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E4%BD%BF%E7%94%A8%E6%A0%B7%E5%BC%8F%E8%A1%A8%EF%BC%88setStyleSheet%EF%BC%89"><span class="toc-number">29.6.4.2.</span> <span class="toc-text">2、使用样式表（setStyleSheet）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E3%80%81QPalette"><span class="toc-number">29.6.4.3.</span> <span class="toc-text">3、QPalette</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E3%80%81paintEvent%E4%BA%8B%E4%BB%B6"><span class="toc-number">29.6.4.4.</span> <span class="toc-text">4、paintEvent事件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#5%E3%80%81%E7%AE%80%E6%B4%81%E6%96%B9%E5%BC%8F"><span class="toc-number">29.6.4.4.1.</span> <span class="toc-text">5、简洁方式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#6%E3%80%81%E6%80%BB%E7%BB%93"><span class="toc-number">29.6.4.4.2.</span> <span class="toc-text">6、总结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#QPushButton"><span class="toc-number">29.6.5.</span> <span class="toc-text">QPushButton</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#setFlat%EF%BC%88TRUE%EF%BC%89%E5%90%8E%EF%BC%8C%E4%BC%9A%E5%8F%96%E6%B6%88%E5%87%B8%E5%87%BA%E6%95%88%E6%9E%9C"><span class="toc-number">29.6.5.1.</span> <span class="toc-text">setFlat（TRUE）后，会取消凸出效果</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#myuse-2"><span class="toc-number">29.6.5.2.</span> <span class="toc-text">myuse</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#QCalendarWidget"><span class="toc-number">29.6.6.</span> <span class="toc-text">QCalendarWidget</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%87%E9%A2%98%E8%83%8C%E6%99%AF"><span class="toc-number">29.6.6.1.</span> <span class="toc-text">标题背景</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8A%E4%B8%80%E4%B8%AA%E6%9C%88%E3%80%81%E4%B8%8B%E4%B8%80%E4%B8%AA%E6%9C%88%E8%B7%B3%E8%BD%AC%E5%9B%BE%E6%A0%87"><span class="toc-number">29.6.6.2.</span> <span class="toc-text">上一个月、下一个月跳转图标</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%88%E4%BB%BD%E9%80%89%E6%8B%A9"><span class="toc-number">29.6.6.3.</span> <span class="toc-text">月份选择</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B9%B4%E4%BB%BD%E9%80%89%E6%8B%A9"><span class="toc-number">29.6.6.4.</span> <span class="toc-text">年份选择</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%91%A8%E4%B8%80%E5%88%B0%E5%91%A8%E6%9C%AB%E6%A0%8F"><span class="toc-number">29.6.6.5.</span> <span class="toc-text">周一到周末栏</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E6%A0%8F%E8%83%8C%E6%99%AF%E8%89%B2"><span class="toc-number">29.6.6.6.</span> <span class="toc-text">日期栏背景色</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#myuse-3"><span class="toc-number">29.6.6.7.</span> <span class="toc-text">myuse</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#QDateEdit%E6%A0%B7%E5%BC%8F"><span class="toc-number">29.6.7.</span> <span class="toc-text">QDateEdit样式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AD%A3%E5%B8%B8%E7%8A%B6%E6%80%81%E4%B8%8E%E9%80%89%E4%B8%AD%E7%8A%B6%E6%80%81"><span class="toc-number">29.6.7.1.</span> <span class="toc-text">正常状态与选中状态</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#QComboBox"><span class="toc-number">29.6.8.</span> <span class="toc-text">QComboBox</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#QMenu"><span class="toc-number">29.6.9.</span> <span class="toc-text">QMenu</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#QIFW%EF%BC%88Qt-Installer-Framework%EF%BC%89"><span class="toc-number">30.</span> <span class="toc-text">QIFW（Qt Installer Framework）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E6%9E%84%E5%BB%BA"><span class="toc-number">30.1.</span> <span class="toc-text">环境构建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%88%B0Qt-Creator%E5%B8%AE%E5%8A%A9%E6%96%87%E6%A1%A3"><span class="toc-number">30.1.1.</span> <span class="toc-text">添加到Qt Creator帮助文档</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8"><span class="toc-number">30.1.2.</span> <span class="toc-text">使用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="toc-number">30.2.</span> <span class="toc-text">离线安装文件结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85%E7%A4%BA%E4%BE%8B%EF%BC%9A"><span class="toc-number">30.3.</span> <span class="toc-text">离线安装示例：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85%E8%AF%A6%E8%A7%A3%EF%BC%9A"><span class="toc-number">30.4.</span> <span class="toc-text">离线安装详解：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#config%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="toc-number">30.4.1.</span> <span class="toc-text">config文件夹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#config-xml"><span class="toc-number">30.4.1.1.</span> <span class="toc-text">config.xml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#control-qs"><span class="toc-number">30.4.1.2.</span> <span class="toc-text">control.qs</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#packages%E7%9A%84com-root%E7%9A%84meta"><span class="toc-number">30.4.2.</span> <span class="toc-text">packages的com.root的meta</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#package-xml"><span class="toc-number">30.4.2.1.</span> <span class="toc-text">package.xml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#installscript-js"><span class="toc-number">30.4.2.2.</span> <span class="toc-text">installscript.js</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#license-txt"><span class="toc-number">30.4.2.3.</span> <span class="toc-text">license.txt</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#packages%E7%9A%84com-root%E7%9A%84data"><span class="toc-number">30.4.3.</span> <span class="toc-text">packages的com.root的data</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#uninstallscript-qs"><span class="toc-number">30.4.3.1.</span> <span class="toc-text">uninstallscript.qs</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#packages%E7%9A%84com-root-foundation%E7%9A%84meta"><span class="toc-number">30.4.4.</span> <span class="toc-text">packages的com.root.foundation的meta</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#package-xml-1"><span class="toc-number">30.4.4.1.</span> <span class="toc-text">package.xml</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8%E7%BA%BF%E5%AE%89%E8%A3%85%E4%B8%8E%E6%9B%B4%E6%96%B0"><span class="toc-number">30.5.</span> <span class="toc-text">在线安装与更新</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%BB%BA%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%8C%E6%9B%BF%E4%BB%A3%E6%96%87%E4%BB%B6%E5%A4%B9%E5%BD%A2%E5%BC%8F%EF%BC%8C%E5%8F%AF%E7%94%A8%E4%BA%8E%E5%9C%A8%E5%B1%80%E5%9F%9F%E7%BD%91%E5%86%85%E5%8F%91%E5%B8%83"><span class="toc-number">30.5.1.</span> <span class="toc-text">自建服务器，替代文件夹形式，可用于在局域网内发布</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Python3%E5%BC%80%E5%90%AFhttp-server%E6%9C%8D%E5%8A%A1"><span class="toc-number">30.5.1.1.</span> <span class="toc-text">Python3开启http server服务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%88%E6%9E%9C"><span class="toc-number">30.5.1.2.</span> <span class="toc-text">效果</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0"><span class="toc-number">30.5.2.</span> <span class="toc-text">自动更新</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NSIS"><span class="toc-number">31.</span> <span class="toc-text">NSIS</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E6%96%87%E4%BB%B6%EF%BC%9A-xiangdao-nsi"><span class="toc-number">31.1.</span> <span class="toc-text">脚本文件： xiangdao.nsi</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B"><span class="toc-number">31.2.</span> <span class="toc-text">流程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%82%B9%E5%87%BB-%E2%80%9C%E8%84%9A%E6%9C%AC%E7%BC%96%E8%BE%91%E5%99%A8VNISEdit%E2%80%9D"><span class="toc-number">31.2.1.</span> <span class="toc-text">1、点击 “脚本编辑器VNISEdit”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E9%80%89%E6%8B%A9%E2%80%9C%E6%96%B0%E5%BB%BA%E8%84%9A%E6%9C%AC%EF%BC%9A%E5%90%91%E5%AF%BC%E2%80%9D"><span class="toc-number">31.2.2.</span> <span class="toc-text">2、选择“新建脚本：向导”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E8%BF%99%E9%87%8C%E7%9A%84%E5%8F%82%E6%95%B0%E8%87%AA%E5%B7%B1%E9%83%BD%E5%8F%AF%E4%BB%A5%E8%AE%BE%E7%BD%AE%E8%AF%95%E4%B8%80%E4%B8%8B%EF%BC%8C%E7%82%B9%E5%87%BB%E4%B8%8B%E4%B8%80%E6%AD%A5%EF%BC%9A"><span class="toc-number">31.2.3.</span> <span class="toc-text">3、这里的参数自己都可以设置试一下，点击下一步：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E6%8E%88%E6%9D%83%E6%96%87%E4%BB%B6"><span class="toc-number">31.2.4.</span> <span class="toc-text">4、授权文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#demo"><span class="toc-number">31.3.</span> <span class="toc-text">demo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF%E5%8A%A8"><span class="toc-number">31.4.</span> <span class="toc-text">开机自启动</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E5%86%8C%E5%90%AF%E5%8A%A8%E9%A1%B9"><span class="toc-number">31.4.1.</span> <span class="toc-text">注册启动项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%90%AF%E5%8A%A8%E9%A1%B9"><span class="toc-number">31.4.2.</span> <span class="toc-text">删除启动项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81"><span class="toc-number">31.4.3.</span> <span class="toc-text">验证</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E7%A8%8B%E5%BA%8F%E5%AE%89%E8%A3%85%E5%90%8E%E8%A6%81%E5%8F%B3%E9%94%AE%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90%E8%BF%90%E8%A1%8C%E9%97%AE%E9%A2%98"><span class="toc-number">31.5.</span> <span class="toc-text">解决程序安装后要右键管理员权限运行问题</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/04/03/Hexo/" title="Hexo"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hexo"/></a><div class="content"><a class="title" href="/2022/04/03/Hexo/" title="Hexo">Hexo</a><time datetime="2022-04-02T16:33:52.000Z" title="发表于 2022-04-03 00:33:52">2022-04-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/10/31/Android/" title="Android"><img src="https://s2.loli.net/2023/12/12/gfXKlqmwMWzPxH7.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android"/></a><div class="content"><a class="title" href="/2021/10/31/Android/" title="Android">Android</a><time datetime="2021-10-31T14:03:21.000Z" title="发表于 2021-10-31 22:03:21">2021-10-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/10/19/OpenGL-highlevel/" title="OpenGL-highlevel"><img src="https://s2.loli.net/2023/12/12/zb5QarqSYDHWZs6.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OpenGL-highlevel"/></a><div class="content"><a class="title" href="/2021/10/19/OpenGL-highlevel/" title="OpenGL-highlevel">OpenGL-highlevel</a><time datetime="2021-10-19T13:35:33.000Z" title="发表于 2021-10-19 21:35:33">2021-10-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/10/17/OpenGL-light/" title="OpenGL-light"><img src="https://s2.loli.net/2023/12/12/Dlf5uYb78R1Firw.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OpenGL-light"/></a><div class="content"><a class="title" href="/2021/10/17/OpenGL-light/" title="OpenGL-light">OpenGL-light</a><time datetime="2021-10-17T14:09:58.000Z" title="发表于 2021-10-17 22:09:58">2021-10-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/09/21/OpenGL-3D/" title="OpenGL_3D"><img src="https://s2.loli.net/2023/12/12/EZS5QGm23HLgvW4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OpenGL_3D"/></a><div class="content"><a class="title" href="/2021/09/21/OpenGL-3D/" title="OpenGL_3D">OpenGL_3D</a><time datetime="2021-09-21T07:31:53.000Z" title="发表于 2021-09-21 15:31:53">2021-09-21</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://s2.loli.net/2023/12/12/SNjXLprxbadKoJ8.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Smt</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'RrMFpOdr0spfIDfRdBukvyf7-gzGzoHsz',
      appKey: 'nipjeGzTyw5yvNk2SgU5KmUQ',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><script src="https://myhkw.cn/api/player/162393526192" id="myhk" key="162393526192" m="1"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="false"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>