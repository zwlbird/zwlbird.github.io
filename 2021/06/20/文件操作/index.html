<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>文件操作 | .oOo.</title><meta name="keywords" content="Qt,C++"><meta name="author" content="Smt"><meta name="copyright" content="Smt"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="C++和Qt的文件相关操作，包含单文件和文件夹">
<meta property="og:type" content="article">
<meta property="og:title" content="文件操作">
<meta property="og:url" content="https://zwlbird.github.io/2021/06/20/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/index.html">
<meta property="og:site_name" content=".oOo.">
<meta property="og:description" content="C++和Qt的文件相关操作，包含单文件和文件夹">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2021/06/27/oW4MJr2aCzHYjZG.jpg">
<meta property="article:published_time" content="2021-06-20T09:23:17.000Z">
<meta property="article:modified_time" content="2023-03-07T09:14:58.692Z">
<meta property="article:author" content="Smt">
<meta property="article:tag" content="Qt">
<meta property="article:tag" content="C++">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/06/27/oW4MJr2aCzHYjZG.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://zwlbird.github.io/2021/06/20/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '文件操作',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-03-07 17:14:58'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://i.loli.net/2021/06/27/oW4MJr2aCzHYjZG.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">.oOo.</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">文件操作</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-06-20T09:23:17.000Z" title="发表于 2021-06-20 17:23:17">2021-06-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-03-07T09:14:58.692Z" title="更新于 2023-03-07 17:14:58">2023-03-07</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%96%87%E4%BB%B6%E7%9B%B8%E5%85%B3/">文件相关</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>28分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="文件操作"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2021/06/20/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/2021/06/20/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="创建文件夹"><a href="#创建文件夹" class="headerlink" title="创建文件夹"></a>创建文件夹</h1><h2 id="Qt"><a href="#Qt" class="headerlink" title="Qt"></a>Qt</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QFileInfo <span class="title">fi</span><span class="params">(<span class="string">&quot;C:/123&quot;</span>)</span></span>; <span class="comment">// 目录存在</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">isFile</span>(); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">isDir</span>(); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">exists</span>(); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">isRoot</span>(); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; QFile::<span class="built_in">exists</span>(<span class="string">&quot;C:/123&quot;</span>); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; <span class="built_in">QDir</span>(<span class="string">&quot;C:/123&quot;</span>).<span class="built_in">exists</span>(); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">fi.<span class="built_in">setFile</span>(<span class="string">&quot;C:/ABC&quot;</span>); <span class="comment">// 目录不存在</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">isFile</span>(); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">isDir</span>(); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">exists</span>(); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">isRoot</span>(); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; QFile::<span class="built_in">exists</span>(<span class="string">&quot;C:/ABC&quot;</span>); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; <span class="built_in">QDir</span>(<span class="string">&quot;C:/ABC&quot;</span>).<span class="built_in">exists</span>(); <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">fi.<span class="built_in">setFile</span>(<span class="string">&quot;C:/&quot;</span>); <span class="comment">// 存在的驱动器</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">isFile</span>(); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">isDir</span>(); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">exists</span>(); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">isRoot</span>(); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; QFile::<span class="built_in">exists</span>(<span class="string">&quot;C:/&quot;</span>); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; <span class="built_in">QDir</span>(<span class="string">&quot;C:/&quot;</span>).<span class="built_in">exists</span>(); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">fi.<span class="built_in">setFile</span>(<span class="string">&quot;Z:/&quot;</span>); <span class="comment">// 不存在的驱动器</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">isFile</span>(); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">isDir</span>(); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">exists</span>(); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">isRoot</span>(); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; QFile::<span class="built_in">exists</span>(<span class="string">&quot;Z:/&quot;</span>); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; <span class="built_in">QDir</span>(<span class="string">&quot;Z:/&quot;</span>).<span class="built_in">exists</span>(); <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">fi.<span class="built_in">setFile</span>(<span class="string">&quot;C:/123.lnk&quot;</span>); <span class="comment">// 快捷方式存在且指向的文件也存在</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">isFile</span>(); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">isDir</span>(); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">exists</span>(); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">isRoot</span>(); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; QFile::<span class="built_in">exists</span>(<span class="string">&quot;C:/123.lnk&quot;</span>); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; <span class="built_in">QDir</span>(<span class="string">&quot;C:/123.lnk&quot;</span>).<span class="built_in">exists</span>(); <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">fi.<span class="built_in">setFile</span>(<span class="string">&quot;C:/456.lnk&quot;</span>); <span class="comment">// 快捷方式存在但指向的文件不存在</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">isFile</span>(); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">isDir</span>(); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">exists</span>(); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; fi.<span class="built_in">isRoot</span>(); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; QFile::<span class="built_in">exists</span>(<span class="string">&quot;C:/456.lnk&quot;</span>); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">qDebug</span>() &lt;&lt; <span class="built_in">QDir</span>(<span class="string">&quot;C:/456.lnk&quot;</span>).<span class="built_in">exists</span>(); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<p>可以看到，容易让人感到混乱的是exists方法，这个方法是通用的判断方法，可以看成是这样的表达式</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exists</span>() == (<span class="built_in">isFile</span>() || <span class="built_in">isDir</span>())</span><br><span class="line">    </span><br><span class="line">准确判断文件是否存在</span><br><span class="line"><span class="number">1.</span>用QFileInfo::<span class="built_in">isFile</span>()方法</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">准确判断文件夹是否存在</span><br><span class="line"><span class="number">1.</span>用QFileInfo::<span class="built_in">isDir</span>()方法</span><br><span class="line"><span class="number">2.</span>用QDir::<span class="built_in">exists</span>()方法</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">&#123;% label 不确定字符串是文件还是文件夹路径 blue %&#125;</span><br><span class="line"><span class="number">1.</span>用QFileInfo::<span class="built_in">exists</span>()方法</span><br><span class="line"><span class="number">2.</span>用QFile::<span class="built_in">exists</span>()方法</span><br></pre></td></tr></table></figure>

<h3 id="创建文件夹-1"><a href="#创建文件夹-1" class="headerlink" title="创建文件夹"></a>创建文件夹</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QDir&gt;</span>#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QMessageBox&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//实例QDir</span></span><br><span class="line">QDir *folder = <span class="keyword">new</span> QDir;</span><br><span class="line"><span class="comment">//判断创建文件夹是否存在</span></span><br><span class="line"><span class="keyword">bool</span> exist = folder-&gt;<span class="built_in">exists</span>(<span class="string">&quot;D:/NewFolder&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(exist)</span><br><span class="line">&#123;</span><br><span class="line">    QMessageBox::<span class="built_in">warning</span>(<span class="keyword">this</span>,<span class="built_in">tr</span>(<span class="string">&quot;创建文件夹&quot;</span>),<span class="built_in">tr</span>(<span class="string">&quot;文件夹已经存在！&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="comment">//如果不存在，创建文件夹</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//创建文件夹</span></span><br><span class="line">    <span class="keyword">bool</span> ok = folder-&gt;<span class="built_in">mkdir</span>(<span class="string">&quot;D:/NewFolder&quot;</span>);</span><br><span class="line">    <span class="comment">//判断是否成功</span></span><br><span class="line">    <span class="keyword">if</span>(ok)</span><br><span class="line">    &#123;</span><br><span class="line">        QMessageBox::<span class="built_in">warning</span>(<span class="keyword">this</span>,<span class="built_in">tr</span>(<span class="string">&quot;创建文件夹&quot;</span>),<span class="built_in">tr</span>(<span class="string">&quot;文件夹创建成功！&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        QMessageBox::<span class="built_in">warning</span>(<span class="keyword">this</span>,<span class="built_in">tr</span>(<span class="string">&quot;创建文件夹&quot;</span>),<span class="built_in">tr</span>(<span class="string">&quot;文件夹创建失败！&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="创建路径"><a href="#创建路径" class="headerlink" title="创建路径"></a>创建路径</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">QString path=QDir::<span class="built_in">currentPath</span>();<span class="comment">//获取程序当前目录</span></span><br><span class="line">path.<span class="built_in">replace</span>(<span class="string">&quot;/&quot;</span>,<span class="string">&quot;\\&quot;</span>);<span class="comment">//将地址中的&quot;/&quot;替换为&quot;\&quot;，因为在Windows下使用的是&quot;\&quot;。</span></span><br><span class="line"><span class="built_in">qDebug</span>()&lt;&lt;path;</span><br><span class="line"><span class="comment">//实例QDir</span></span><br><span class="line">QDir folder;</span><br><span class="line">path.<span class="built_in">append</span>(<span class="string">&quot;\\dat\\video\\src_video\\&quot;</span>);</span><br><span class="line"><span class="comment">//判断创建文件夹是否存在</span></span><br><span class="line"><span class="keyword">bool</span> exist = folder.<span class="built_in">exists</span>(path);</span><br><span class="line"><span class="keyword">if</span>(!exist)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//创建文件夹</span></span><br><span class="line"><span class="keyword">bool</span> ok = folder.<span class="built_in">mkpath</span>(path);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="C"><a href="#C" class="headerlink" title="C++"></a>C++</h2><h3 id="使用-system-调用-dos-命令"><a href="#使用-system-调用-dos-命令" class="headerlink" title="使用 system() 调用 dos 命令"></a>使用 system() 调用 dos 命令</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    string folderPath = <span class="string">&quot;E:\\database\\testFolder&quot;</span>; </span><br><span class="line">    string command;</span><br><span class="line">    command = <span class="string">&quot;mkdir -p &quot;</span> + folderPath;  </span><br><span class="line">    <span class="built_in">system</span>(command.<span class="built_in">c_str</span>());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="使用access-和-mkdir-函数"><a href="#使用access-和-mkdir-函数" class="headerlink" title="使用access 和 mkdir 函数"></a>使用access 和 mkdir 函数</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;direct.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;corecrt_io.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    string folderPath = <span class="string">&quot;E:\\database\\testFolder&quot;</span>; </span><br><span class="line">    <span class="keyword">if</span> (<span class="number">0</span> != _access(folderPath.<span class="built_in">c_str</span>(), <span class="number">0</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// if this folder not exist, create a new one.</span></span><br><span class="line">        <span class="built_in">mkdir</span>(folderPath.<span class="built_in">c_str</span>()); <span class="comment">// 返回 0 表示创建成功，-1 表示失败</span></span><br><span class="line">        <span class="comment">//换成 ::_mkdir ::_access 也行，不知道什么意思</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="调用-Windows-API-函数"><a href="#调用-Windows-API-函数" class="headerlink" title="调用 Windows API 函数"></a>调用 Windows API 函数</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    string folderPath = <span class="string">&quot;E:\\database\\testFolder&quot;</span>; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">GetFileAttributesA</span>(folderPath.<span class="built_in">c_str</span>()) &amp; FILE_ATTRIBUTE_DIRECTORY) &#123;</span><br><span class="line">        <span class="keyword">bool</span> flag = <span class="built_in">CreateDirectory</span>(folderPath.<span class="built_in">c_str</span>(), <span class="literal">NULL</span>);</span><br><span class="line">        <span class="comment">// flag 为 true 说明创建成功</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;Directory already exists.&quot;</span>&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="删除文件夹"><a href="#删除文件夹" class="headerlink" title="删除文件夹"></a>删除文件夹</h1><h2 id="C-1"><a href="#C-1" class="headerlink" title="C++"></a>C++</h2><h3 id="调用Windows-API函数"><a href="#调用Windows-API函数" class="headerlink" title="调用Windows API函数"></a>调用Windows API函数</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BOOL <span class="title">RemoveDirectory</span><span class="params">(LPCTSTR lpPathName)</span></span>;</span><br><span class="line"></span><br><span class="line">头、库文件 </span><br><span class="line">Winbase.h, Coredll.lib</span><br><span class="line"></span><br><span class="line">参数： </span><br><span class="line">\- lpPathName：字符串指针，要删除的文件夹的路径。</span><br><span class="line"></span><br><span class="line">返回值： </span><br><span class="line">成功-非零，失败-零。查看错误使用<span class="built_in">GeLastError</span>();</span><br></pre></td></tr></table></figure>

<h3 id="调用C运行库函数"><a href="#调用C运行库函数" class="headerlink" title="调用C运行库函数"></a>调用C运行库函数</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> _rmdir(<span class="keyword">const</span> <span class="keyword">char</span>* dirname);</span><br><span class="line"><span class="keyword">int</span> _wrmdir(<span class="keyword">const</span> <span class="keyword">wchar_t</span>* dirname);</span><br><span class="line"></span><br><span class="line">头、库文件： </span><br><span class="line">direct.h或者wchar.h，c运行库</span><br><span class="line"></span><br><span class="line">宏定义：</span><br><span class="line">tchar.h _MBCS defined _UNICODE defined</span><br><span class="line">_trmdir _rmdir _wrmdir</span><br><span class="line">参数： </span><br><span class="line">- dirname：字符串指针，要删除的文件夹的路径。</span><br><span class="line"></span><br><span class="line">返回值： </span><br><span class="line"><span class="number">0</span>-成功，<span class="number">-1</span>-失败。</span><br></pre></td></tr></table></figure>

<h1 id="查询是否是文件夹"><a href="#查询是否是文件夹" class="headerlink" title="查询是否是文件夹"></a>查询是否是文件夹</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">string aa = (string)chRtn + fileinfo.name;</span><br><span class="line">WIN32_FIND_DATAA FindFileData;</span><br><span class="line"><span class="built_in">FindFirstFileA</span>(aa.<span class="built_in">c_str</span>(), &amp;FindFileData);</span><br><span class="line"><span class="comment">//FindFirstFileA(tempPath,&amp;FindFileData);</span></span><br><span class="line"><span class="keyword">if</span> (FindFileData.dwFileAttributes &amp; FILE_ATTRIBUTE_DIRECTORY)</span><br><span class="line">&#123;</span><br><span class="line">    foldername.<span class="built_in">push_back</span>(fileinfo.name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取当前exe路径</span></span><br><span class="line">TCHAR szFilePath[MAX_PATH + <span class="number">1</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="built_in">GetModuleFileName</span>(<span class="literal">NULL</span>, szFilePath, MAX_PATH);</span><br><span class="line">(_tcsrchr(szFilePath, _T(<span class="string">&#x27;\\&#x27;</span>)))[<span class="number">1</span>] = <span class="number">0</span>; <span class="comment">// 删除文件名，只获得路径字串</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> iLen = <span class="built_in">WideCharToMultiByte</span>(CP_ACP, <span class="number">0</span>, szFilePath, <span class="number">-1</span>, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line"><span class="keyword">char</span>* chRtn = <span class="keyword">new</span> <span class="keyword">char</span>[iLen*<span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">char</span>)];</span><br><span class="line"><span class="built_in">WideCharToMultiByte</span>(CP_ACP, <span class="number">0</span>, szFilePath, <span class="number">-1</span>, chRtn, iLen, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//拼接路径</span></span><br><span class="line">string to_search = (string)chRtn+<span class="string">&quot;*&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//遍历路径下的文件，找到需要的png</span></span><br><span class="line">vector&lt;string &gt; foldername;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> * point = <span class="string">&quot;.&quot;</span>;<span class="comment">//分割标示</span></span><br><span class="line"><span class="keyword">intptr_t</span> handle;    <span class="comment">//用于查找的句柄</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">finddata_t</span> <span class="title">fileinfo</span>;</span>    <span class="comment">//文件信息的结构体</span></span><br><span class="line">handle = _findfirst(to_search.<span class="built_in">c_str</span>(), &amp;fileinfo);    <span class="comment">//第一次查找</span></span><br><span class="line"><span class="keyword">if</span> (<span class="number">-1</span> == handle) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (fileinfo.attrib == <span class="number">16</span>  &amp;&amp; <span class="built_in">strcmp</span>(fileinfo.name, <span class="string">&quot;.&quot;</span>)!=<span class="number">0</span> &amp;&amp; <span class="built_in">strcmp</span>(fileinfo.name, <span class="string">&quot;..&quot;</span>) != <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">    foldername.<span class="built_in">push_back</span>(fileinfo.name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//finename.push_back(atoi(strtok(fileinfo.name, point)));</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (!_findnext(handle, &amp;fileinfo)) &#123;    <span class="comment">//循环查找其它符合的文件，直到找不到其它的为止</span></span><br><span class="line">    <span class="keyword">if</span> (fileinfo.attrib == <span class="number">16</span> &amp;&amp; <span class="built_in">strcmp</span>(fileinfo.name, <span class="string">&quot;.&quot;</span>) != <span class="number">0</span> &amp;&amp; <span class="built_in">strcmp</span>(fileinfo.name, <span class="string">&quot;..&quot;</span>) != <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        foldername.<span class="built_in">push_back</span>(fileinfo.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">_findclose(handle);</span><br></pre></td></tr></table></figure>

<h1 id="查询子文件夹"><a href="#查询子文件夹" class="headerlink" title="查询子文件夹"></a>查询子文件夹</h1><h2 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h2><h3 id="Qt-1"><a href="#Qt-1" class="headerlink" title="Qt"></a>Qt</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QDir <span class="title">dir</span><span class="params">(_srcDirpath)</span></span>;</span><br><span class="line"><span class="keyword">if</span>(!dir.<span class="built_in">exists</span>())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">dir.<span class="built_in">setFilter</span>(QDir::Dirs );</span><br><span class="line">QFileInfoList list = dir.<span class="built_in">entryInfoList</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> file_count = list.<span class="built_in">count</span>();</span><br><span class="line"><span class="keyword">if</span>(file_count &lt;= <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">QStringList string_list;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;file_count; i++)</span><br><span class="line">&#123;</span><br><span class="line">    QFileInfo file_info = list.<span class="built_in">at</span>(i);</span><br><span class="line">    <span class="keyword">if</span>(file_info.<span class="built_in">fileName</span>() == <span class="string">&quot;.&quot;</span> | file_info.<span class="built_in">fileName</span>() == <span class="string">&quot;..&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(file_info.<span class="built_in">isDir</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        string_list.<span class="built_in">append</span>(file_info.<span class="built_in">absoluteFilePath</span>());</span><br><span class="line">        <span class="comment">//QString suffix = file_info.suffix();</span></span><br><span class="line">        <span class="built_in">qDebug</span>()&lt;&lt;file_info.<span class="built_in">absoluteFilePath</span>();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//        if(QString::compare(suffix, QString(&quot;png&quot;), Qt::CaseInsensitive) == 0)</span></span><br><span class="line">    <span class="comment">//        &#123;</span></span><br><span class="line">    <span class="comment">//            QString absolute_file_path = file_info.absoluteFilePath();</span></span><br><span class="line">    <span class="comment">//            string_list.append(absolute_file_path);</span></span><br><span class="line">    <span class="comment">//            qDebug()&lt;&lt;absolute_file_path;</span></span><br><span class="line">    <span class="comment">//        &#125;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">qDebug</span>()&lt;&lt;string_list.<span class="built_in">size</span>();</span><br></pre></td></tr></table></figure>

<p>C++</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">//获取当前exe路径</span><br><span class="line">TCHAR szFilePath[MAX_PATH + 1] = &#123; 0 &#125;;</span><br><span class="line">GetModuleFileName(NULL, szFilePath, MAX_PATH);</span><br><span class="line">(_tcsrchr(szFilePath, _T(&#x27;\\&#x27;)))[1] = 0; // 删除文件名，只获得路径字串</span><br><span class="line"></span><br><span class="line">int iLen = WideCharToMultiByte(CP_ACP, 0, szFilePath, -1, NULL, 0, NULL, NULL);</span><br><span class="line">char* chRtn = new char[iLen*sizeof(char)];</span><br><span class="line">WideCharToMultiByte(CP_ACP, 0, szFilePath, -1, chRtn, iLen, NULL, NULL);</span><br><span class="line"></span><br><span class="line">//拼接路径</span><br><span class="line">string to_search = (string)chRtn + &quot;*&quot;;</span><br><span class="line"></span><br><span class="line">//遍历路径下的文件夹</span><br><span class="line">vector&lt;string &gt; foldername;</span><br><span class="line">const char * point = &quot;.&quot;;//分割标示</span><br><span class="line">intptr_t handle;    //用于查找的句柄</span><br><span class="line">struct _finddata_t fileinfo;    //文件信息的结构体</span><br><span class="line">handle = _findfirst(to_search.c_str(), &amp;fileinfo);    //第一次查找</span><br><span class="line">if (-1 == handle) &#123;</span><br><span class="line">return -1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (fileinfo.attrib == 16 &amp;&amp; strcmp(fileinfo.name, &quot;.&quot;) != 0 &amp;&amp; strcmp(fileinfo.name, &quot;..&quot;) != 0)</span><br><span class="line">&#123;</span><br><span class="line">foldername.push_back(fileinfo.name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">while (!_findnext(handle, &amp;fileinfo)) &#123;    //循环查找其它符合的文件，直到找不到其它的为止</span><br><span class="line">if ((fileinfo.attrib == 16 || fileinfo.attrib == 48) &amp;&amp; strcmp(fileinfo.name, &quot;.&quot;) != 0 &amp;&amp; strcmp(fileinfo.name, &quot;..&quot;) != 0)</span><br><span class="line">&#123;</span><br><span class="line">foldername.push_back((string)chRtn + fileinfo.name+&quot;\\&quot;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; fileinfo.name &lt;&lt; fileinfo.attrib &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">_findclose(handle);</span><br><span class="line"></span><br><span class="line">cout &lt;&lt; &quot;当前目录下有子文件夹个数：&quot; &lt;&lt; foldername.size() &lt;&lt; endl;</span><br></pre></td></tr></table></figure>



<h1 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h1><h2 id="C-2"><a href="#C-2" class="headerlink" title="C++"></a>C++</h2><h3 id="打开文件-二进制"><a href="#打开文件-二进制" class="headerlink" title="打开文件 二进制"></a>打开文件 二进制</h3><p>Windows下，文件换行是/r /n两个组合，Linux下只有/n，所以在写入文件的时候，windows下会在换行的时候自动转换。</p>
<p>所有的文件在机器里存的都是二进制，只不过显示的时候自动给转换成可以看懂的了。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在实际应用中，根据需要的不同，选择不同的类来定义：如果想以输入方式打开，就用ifstream来定义；</span></span><br><span class="line"><span class="comment">//如果想以输出方式打开，就用ofstream来定义；如果想以输入/输出方式来打开，就用fstream来定</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//ofstream         //文件写操作 内存写入存储设备   </span></span><br><span class="line"><span class="comment">//ifstream         //文件读操作，存储设备读区到内存中  </span></span><br><span class="line"><span class="comment">//fstream          //读写操作，对打开的文件可进行读写操作</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//（一）打开文件的方式在ios类(所以流式I/O的基类)中定义，有如下几种方式：</span></span><br><span class="line"><span class="comment">//ios::in	为输入(读)而打开文件</span></span><br><span class="line"><span class="comment">//ios::out	为输出(写)而打开文件</span></span><br><span class="line"><span class="comment">//ios::ate	初始位置：文件尾</span></span><br><span class="line"><span class="comment">//ios::app	所有输出附加在文件末尾</span></span><br><span class="line"><span class="comment">//ios::trunc	如果文件已存在则先删除该文件</span></span><br><span class="line"><span class="comment">//ios::binary	二进制方式 这些方式是能够进行组合使用的，以“或”运算（“|”）的方式：例如</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//（二）、保护模式</span></span><br><span class="line"><span class="comment">//#define _SH_DENYRW      0x10    /* deny read/write mode */拒绝对文件进行读写 </span></span><br><span class="line"><span class="comment">//#define _SH_DENYWR      0x20    /* deny write mode */拒绝写入文件 </span></span><br><span class="line"><span class="comment">//#define _SH_DENYRD      0x30    /* deny read mode */拒绝文件的读取权限 </span></span><br><span class="line"><span class="comment">//#define _SH_DENYNO      0x40    /* deny none mode */读取和写入许可 </span></span><br><span class="line"><span class="comment">//#define _SH_SECURE      0x80    /* secure mode */共享读取，独占写入 </span></span><br><span class="line"><span class="comment">//注意：假设A进程以_SH_DENYRW 打开，那么是B进程不能再对文件进行读写。</span></span><br><span class="line"> </span><br><span class="line">ofstream ofs;							<span class="comment">//打开文件用于写，若文件不存在就创建它</span></span><br><span class="line"> </span><br><span class="line">locale loc = locale::<span class="built_in">global</span>(<span class="built_in">locale</span>(<span class="string">&quot;&quot;</span>)); 		       <span class="comment">//要打开的文件路径含中文，设置全局locale为本地环境 </span></span><br><span class="line"> </span><br><span class="line">ofs.<span class="built_in">open</span>(<span class="string">&quot;./out.bin&quot;</span>,ios::out| ios::app | ios::binary,_SH_DENYNO); <span class="comment">//输出到文件 ，追加的方式，二进制。 可同时用其他的工具打开此文件</span></span><br><span class="line"> </span><br><span class="line">locale::<span class="built_in">global</span>(loc);					      <span class="comment">//恢复全局locale</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (!ofs.<span class="built_in">is_open</span>())<span class="keyword">return</span>;	<span class="comment">//打开文件失败则结束运行  </span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">char</span>* buffer = <span class="string">&quot;fdsfdsfdsfdsfdsfds\n&quot;</span>;</span><br><span class="line">	ofs.<span class="built_in">write</span>(buffer, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">char</span>)*<span class="number">17</span>); </span><br><span class="line">	ofs.<span class="built_in">flush</span>();</span><br><span class="line">	<span class="built_in">Sleep</span>(<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">ofs.<span class="built_in">close</span>();  </span><br></pre></td></tr></table></figure>

<h3 id="读取-ANSI-UNICODE-UTF-8-二进制"><a href="#读取-ANSI-UNICODE-UTF-8-二进制" class="headerlink" title="读取 ANSI,UNICODE,UTF-8 二进制"></a>读取 ANSI,UNICODE,UTF-8 二进制</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> FBLOCK_MAX_BYTES = <span class="number">256</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// File Type.</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> <span class="title">FileType</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    ANSI = <span class="number">0</span>,</span><br><span class="line">    UNICODE,</span><br><span class="line">    UTF8,</span><br><span class="line">&#125;FILETYPE;</span><br><span class="line"></span><br><span class="line"><span class="function">FILETYPE <span class="title">GetTextFileType</span><span class="params">(<span class="keyword">const</span> std::string &amp; strFileName)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">UnicodeToANSI</span><span class="params">(<span class="keyword">char</span> * pDes, <span class="keyword">const</span> <span class="keyword">wchar_t</span> * pSrc)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// file test.</span></span><br><span class="line">    std::string strFileANSI = <span class="string">&quot;C://Hello_ANSI.txt&quot;</span>;</span><br><span class="line">    std::string strFileUNICODE = <span class="string">&quot;C://Hello_UNICODE.txt&quot;</span>;</span><br><span class="line">    std::string strFileUTF8 = <span class="string">&quot;C://Hello_UTF8.txt&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// please change the file name to test.</span></span><br><span class="line">    std::string strFileName = strFileUTF8;</span><br><span class="line">    FILETYPE fileType = <span class="built_in">GetTextFileType</span>(strFileName);</span><br><span class="line">    <span class="keyword">if</span> (UNICODE == fileType)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">wchar_t</span> szBuf[FBLOCK_MAX_BYTES];</span><br><span class="line">        <span class="built_in">memset</span>(szBuf, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">wchar_t</span>) * FBLOCK_MAX_BYTES);</span><br><span class="line">        std::string strMessage;</span><br><span class="line">        FILE * fp = <span class="literal">NULL</span>;</span><br><span class="line">        fp = <span class="built_in">fopen</span>(strFileName.<span class="built_in">c_str</span>(), <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (fp != <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// Unicode file should offset wchar_t bits(2 byte) from start.</span></span><br><span class="line">            <span class="built_in">fseek</span>(fp, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">wchar_t</span>), <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">while</span>(<span class="built_in">fread</span>(szBuf, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">wchar_t</span>), FBLOCK_MAX_BYTES, fp) &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">char</span> szTemp[FBLOCK_MAX_BYTES] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">                <span class="built_in">UnicodeToANSI</span>(szTemp, szBuf);</span><br><span class="line">                strMessage += szTemp;</span><br><span class="line">                <span class="built_in">memset</span>(szBuf, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">wchar_t</span>) * FBLOCK_MAX_BYTES);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; strMessage &lt;&lt; std::endl;</span><br><span class="line">        <span class="built_in">fclose</span>(fp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (UTF8 == fileType)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">char</span> szBuf[FBLOCK_MAX_BYTES];</span><br><span class="line">        <span class="built_in">memset</span>(szBuf, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">char</span>) * FBLOCK_MAX_BYTES);</span><br><span class="line">        std::string strMessage;</span><br><span class="line">        FILE * fp = <span class="literal">NULL</span>;</span><br><span class="line">        fp = <span class="built_in">fopen</span>(strFileName.<span class="built_in">c_str</span>(), <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (fp != <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// UTF-8 file should offset 3 byte from start position.</span></span><br><span class="line">            <span class="built_in">fseek</span>(fp, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">char</span>) * <span class="number">3</span>, <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">while</span>(<span class="built_in">fread</span>(szBuf, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">char</span>), FBLOCK_MAX_BYTES, fp) &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                strMessage += szBuf;</span><br><span class="line">                <span class="built_in">memset</span>(szBuf, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">char</span>) * FBLOCK_MAX_BYTES);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; strMessage &lt;&lt; std::endl;</span><br><span class="line">        <span class="built_in">fclose</span>(fp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">char</span> szBuf[FBLOCK_MAX_BYTES];</span><br><span class="line">        <span class="built_in">memset</span>(szBuf, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">char</span>) * FBLOCK_MAX_BYTES);</span><br><span class="line">        </span><br><span class="line">        std::string strMessage;</span><br><span class="line">        </span><br><span class="line">        FILE * fp = <span class="literal">NULL</span>;</span><br><span class="line">        fp = <span class="built_in">fopen</span>(strFileName.<span class="built_in">c_str</span>(), <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (fp != <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// common file do not offset.</span></span><br><span class="line">            <span class="keyword">while</span>(<span class="built_in">fread</span>(szBuf, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">char</span>), FBLOCK_MAX_BYTES, fp) &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                strMessage += szBuf;</span><br><span class="line">                <span class="built_in">memset</span>(szBuf, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">char</span>) * FBLOCK_MAX_BYTES);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; strMessage &lt;&lt; std::endl;</span><br><span class="line">        <span class="built_in">fclose</span>(fp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _DEBUG</span></span><br><span class="line">    <span class="built_in">getchar</span>();</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">FILETYPE <span class="title">GetTextFileType</span><span class="params">(<span class="keyword">const</span> std::string &amp; strFileName)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    FILETYPE fileType = ANSI;</span><br><span class="line">    std::ifstream file;</span><br><span class="line">    file.<span class="built_in">open</span>(strFileName.<span class="built_in">c_str</span>(), std::ios_base::in);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">bool</span> bUnicodeFile = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (file.<span class="built_in">good</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">char</span> szFlag[<span class="number">3</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">        file.<span class="built_in">read</span>(szFlag, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">char</span>) * <span class="number">3</span>);</span><br><span class="line">        <span class="keyword">if</span> ((<span class="keyword">unsigned</span> <span class="keyword">char</span>)szFlag[<span class="number">0</span>] == <span class="number">0xFF</span> </span><br><span class="line">            &amp;&amp; (<span class="keyword">unsigned</span> <span class="keyword">char</span>)szFlag[<span class="number">1</span>] == <span class="number">0xFE</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            fileType = UNICODE;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((<span class="keyword">unsigned</span> <span class="keyword">char</span>)szFlag[<span class="number">0</span>] == <span class="number">0xEF</span> </span><br><span class="line">            &amp;&amp; (<span class="keyword">unsigned</span> <span class="keyword">char</span>)szFlag[<span class="number">1</span>] == <span class="number">0xBB</span> </span><br><span class="line">            &amp;&amp; (<span class="keyword">unsigned</span> <span class="keyword">char</span>)szFlag[<span class="number">2</span>] == <span class="number">0xBF</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            fileType = UTF8;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    file.<span class="built_in">close</span>();</span><br><span class="line">    <span class="keyword">return</span> fileType;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">UnicodeToANSI</span><span class="params">(<span class="keyword">char</span> * pDes, <span class="keyword">const</span> <span class="keyword">wchar_t</span> * pSrc)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">assert</span>(pDes != <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">assert</span>(pSrc != <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">int</span> nLen = ::<span class="built_in">WideCharToMultiByte</span>(CP_ACP, <span class="number">0</span>, pSrc, <span class="number">-1</span>, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">if</span> (nLen == <span class="number">0</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ::<span class="built_in">WideCharToMultiByte</span>(CP_ACP, <span class="number">0</span>, pSrc, <span class="number">-1</span>, pDes, nLen, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="宽字符文件C-读取"><a href="#宽字符文件C-读取" class="headerlink" title="宽字符文件C++读取"></a>宽字符文件C++读取</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//第一种方式</span></span><br><span class="line">	CStdioFile file;</span><br><span class="line">	CString strline;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//string 转 wstring</span></span><br><span class="line">	<span class="keyword">int</span> num = <span class="built_in">MultiByteToWideChar</span>(CP_UTF8, <span class="number">0</span>, filename.<span class="built_in">c_str</span>(), <span class="number">-1</span>, <span class="literal">NULL</span>, <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">wchar_t</span> *wide = <span class="keyword">new</span> <span class="keyword">wchar_t</span>[num];</span><br><span class="line">	<span class="built_in">MultiByteToWideChar</span>(CP_UTF8, <span class="number">0</span>, filename.<span class="built_in">c_str</span>(), <span class="number">-1</span>, wide, num);</span><br><span class="line">	<span class="function">std::wstring <span class="title">w_str</span><span class="params">(wide)</span></span>;</span><br><span class="line">	<span class="keyword">delete</span>[] wide;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//wstring.c_str()可用于LPCTSTR</span></span><br><span class="line">	<span class="keyword">if</span> (!file.<span class="built_in">Open</span>(w_str.<span class="built_in">c_str</span>(), CFile::modeRead))</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//第二种方式</span></span><br><span class="line">	<span class="comment">//wifstream infile;</span></span><br><span class="line">	<span class="comment">//infile.open(w_str.c_str(), ios::in);</span></span><br><span class="line">	<span class="comment">//while (!infile.eof())            // 若未到文件结束一直循环</span></span><br><span class="line">	<span class="comment">//&#123;</span></span><br><span class="line">	<span class="comment">//	getline(infile, w_str, L&#x27;\n&#x27;);//读取一行，以换行符结束，存入</span></span><br><span class="line">	<span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">	wstring res=<span class="string">L&quot;&quot;</span>;</span><br><span class="line">	<span class="keyword">wchar_t</span> *next=<span class="literal">NULL</span>;</span><br><span class="line">	abc.<span class="built_in">clear</span>();</span><br><span class="line">	<span class="comment">//整理时间，拼接起来</span></span><br><span class="line">	wstring time;</span><br><span class="line">	<span class="comment">//经纬度的DDD形式</span></span><br><span class="line">	<span class="keyword">float</span> latlonvalue = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> degree;</span><br><span class="line">	<span class="keyword">float</span> minu;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (file.<span class="built_in">ReadString</span>(strline))            <span class="comment">// 若未到文件结束一直循环</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (strline != _T(<span class="string">&quot;&quot;</span>))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">//cstring转wchar *</span></span><br><span class="line">			<span class="keyword">wchar_t</span> *str = (<span class="keyword">wchar_t</span> *)strline.<span class="built_in">GetBufferSetLength</span>(strline.<span class="built_in">GetLength</span>());</span><br><span class="line"></span><br><span class="line">			res = <span class="built_in">wcstok_s</span>(str, <span class="string">L&quot; &quot;</span>, &amp;next);</span><br><span class="line">			<span class="keyword">if</span> (res.<span class="built_in">find</span>(<span class="string">L&quot;LAT&quot;</span>) != string::npos)<span class="comment">//存在。</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">while</span> (*(next) != <span class="number">0</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					res = <span class="built_in">wcstok_s</span>(<span class="literal">NULL</span>, <span class="string">L&quot; &quot;</span>, &amp;next);<span class="comment">//因为是以空格分隔的</span></span><br><span class="line">					<span class="comment">//找到纬度值</span></span><br><span class="line">					<span class="keyword">if</span> (res != <span class="string">L&quot;&quot;</span>)</span><br><span class="line">					&#123;</span><br><span class="line">						<span class="built_in">swscanf_s</span>(res.<span class="built_in">data</span>(),<span class="string">L&quot;%d°%f&quot;</span>,&amp;degree,&amp;minu);</span><br><span class="line">						<span class="comment">////换算成DDD的形式</span></span><br><span class="line">						latlonvalue = degree+(minu)/<span class="number">60</span>;</span><br><span class="line">						abc.<span class="built_in">push_back</span>(<span class="built_in">to_wstring</span>(latlonvalue));</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (res.<span class="built_in">find</span>(<span class="string">L&quot;LONG&quot;</span>) != string::npos)<span class="comment">//存在。</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">while</span> (res.<span class="built_in">data</span>() != <span class="literal">NULL</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					res = <span class="built_in">wcstok_s</span>(<span class="literal">NULL</span>, <span class="string">L&quot; &quot;</span>, &amp;next);</span><br><span class="line">					<span class="keyword">if</span> (res != <span class="string">L&quot;&quot;</span>)</span><br><span class="line">					&#123;</span><br><span class="line">						<span class="built_in">swscanf_s</span>(res.<span class="built_in">data</span>(), <span class="string">L&quot;%d°%f&quot;</span>, &amp;degree, &amp;minu);</span><br><span class="line">						<span class="comment">////换算成DDD的形式</span></span><br><span class="line">						latlonvalue = degree + (minu) / <span class="number">60</span>;</span><br><span class="line">						abc.<span class="built_in">push_back</span>(<span class="built_in">to_wstring</span>(latlonvalue));</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>  <span class="keyword">if</span> (res.<span class="built_in">find</span>(<span class="string">L&quot;DATE&quot;</span>) != string::npos)<span class="comment">//存在。</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">while</span> (res.<span class="built_in">data</span>() != <span class="literal">NULL</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					res = <span class="built_in">wcstok_s</span>(<span class="literal">NULL</span>, <span class="string">L&quot; &quot;</span>, &amp;next);</span><br><span class="line">					<span class="keyword">if</span> (res !=<span class="string">L&quot;&quot;</span>)</span><br><span class="line">					&#123;</span><br><span class="line">						time = res;</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>  <span class="keyword">if</span> (res.<span class="built_in">find</span>(<span class="string">L&quot;TIME&quot;</span>) != string::npos)<span class="comment">//存在。</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">while</span> (res.<span class="built_in">data</span>() != <span class="literal">NULL</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					res = <span class="built_in">wcstok_s</span>(<span class="literal">NULL</span>, <span class="string">L&quot; &quot;</span>, &amp;next);</span><br><span class="line">					<span class="keyword">if</span> (res != <span class="string">L&quot;&quot;</span>)</span><br><span class="line">					&#123;</span><br><span class="line">						abc.<span class="built_in">push_back</span>(time+<span class="string">L&quot; &quot;</span>+res);</span><br><span class="line">						abc.<span class="built_in">push_back</span>(<span class="built_in">to_wstring</span>((<span class="built_in">strTime2unix_</span>(time + <span class="string">L&quot; &quot;</span> + res))));</span><br><span class="line">						filenoutputresult.<span class="built_in">push_back</span>(abc);</span><br><span class="line">						file.<span class="built_in">Close</span>();</span><br><span class="line">						<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;	</span><br><span class="line">	&#125;</span><br><span class="line">	file.<span class="built_in">Close</span>();</span><br></pre></td></tr></table></figure>

<h3 id="宽字符文件C-写"><a href="#宽字符文件C-写" class="headerlink" title="宽字符文件C++写"></a>宽字符文件C++写</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">FILE *fp;</span><br><span class="line"> _wfopen_s(&amp;fp, <span class="string">L&quot;result.txt&quot;</span>, <span class="string">L&quot;w&quot;</span>);</span><br><span class="line"><span class="built_in">fwprintf_s</span>(fp, <span class="string">L&quot;LAT,&quot;</span>);</span><br><span class="line"><span class="built_in">fwprintf_s</span>(fp, <span class="string">L&quot;LON,&quot;</span>);</span><br><span class="line"><span class="built_in">fwprintf_s</span>(fp, <span class="string">L&quot;DATE,&quot;</span>);</span><br><span class="line"><span class="built_in">fwprintf_s</span>(fp, <span class="string">L&quot;\n&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; filenoutputresult.<span class="built_in">size</span>();++i)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">2</span>;j++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">fwprintf_s</span>(fp, filenoutputresult[i][j].<span class="built_in">data</span>());</span><br><span class="line">		<span class="built_in">fwprintf_s</span>(fp, <span class="string">L&quot;,&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">fwprintf_s</span>(fp, filenoutputresult[i][<span class="number">2</span>].<span class="built_in">data</span>());</span><br><span class="line">	<span class="built_in">fwprintf_s</span>(fp, <span class="string">L&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">fclose</span>(fp);</span><br></pre></td></tr></table></figure>



<h3 id="写文件"><a href="#写文件" class="headerlink" title="写文件"></a>写文件</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">std::ofstream <span class="title">output</span><span class="params">(Cfg::get()-&gt;valS(<span class="string">&quot;InputFile&quot;</span>) + <span class="string">&quot;recordReturnTime.txt&quot;</span>, ios::out | std::ios::app, _SH_DENYNO)</span></span>;</span><br><span class="line"><span class="keyword">if</span> (!output.<span class="built_in">is_open</span>()) <span class="keyword">return</span>;</span><br><span class="line">output &lt;&lt; <span class="built_in">strtok</span>(<span class="built_in">strtok</span>(fihenm leinfo.name, point),<span class="string">&quot;new&quot;</span>)[<span class="number">1</span>] &lt;&lt; endl;</span><br><span class="line">output.<span class="built_in">flush</span>();</span><br><span class="line">output.<span class="built_in">close</span>();</span><br></pre></td></tr></table></figure>

<h3 id="读文件"><a href="#读文件" class="headerlink" title="读文件"></a>读文件</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="function">std::ifstream <span class="title">freturn</span><span class="params">(Cfg::get()-&gt;valS(<span class="string">&quot;InputFile&quot;</span>) + <span class="string">&quot;recordReturnTime.txt&quot;</span>, ios::in, _SH_DENYNO)</span></span>;</span><br><span class="line">	<span class="keyword">if</span> (!freturn.<span class="built_in">is_open</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	string str;</span><br><span class="line">	<span class="keyword">while</span> (!freturn.<span class="built_in">eof</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		std::<span class="built_in">getline</span>(freturn, str);</span><br><span class="line">    &#125;</span><br><span class="line">freturn.<span class="built_in">close</span>();</span><br></pre></td></tr></table></figure>



<h2 id="Qt-2"><a href="#Qt-2" class="headerlink" title="Qt"></a>Qt</h2><h3 id="写入文件"><a href="#写入文件" class="headerlink" title="写入文件"></a>写入文件</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QMessageBox&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QFile&gt;</span></span></span><br><span class="line"><span class="comment">//实例QFile</span></span><br><span class="line"><span class="function">QFile <span class="title">file</span><span class="params">(<span class="string">&quot;D:/Qt.txt&quot;</span>)</span></span>;</span><br><span class="line"><span class="comment">//定义文件内容字符串</span></span><br><span class="line">QString content= <span class="string">&quot;写入文件的内容&quot;</span>;</span><br><span class="line"><span class="comment">//判断文件是否存在</span></span><br><span class="line"><span class="keyword">if</span>(file.<span class="built_in">exists</span>())</span><br><span class="line">&#123;</span><br><span class="line">    QMessageBox::<span class="built_in">warning</span>(<span class="keyword">this</span>,<span class="string">&quot;创建文件&quot;</span>,<span class="string">&quot;文件已经存在！&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//存在打开，不存在创建</span></span><br><span class="line">    file.<span class="built_in">open</span>(QIODevice::ReadWrite | QIODevice::Text);</span><br><span class="line">    <span class="comment">//写入内容,这里需要转码，否则报错。</span></span><br><span class="line">    QByteArray str = content.<span class="built_in">toUtf8</span>();</span><br><span class="line">    <span class="comment">//写入QByteArray格式字符串</span></span><br><span class="line">    file.<span class="built_in">write</span>(str);</span><br><span class="line">    <span class="comment">//提示成功</span></span><br><span class="line">    QMessageBox::<span class="built_in">warning</span>(<span class="keyword">this</span>,<span class="string">&quot;创建文件&quot;</span>,<span class="string">&quot;文件创建成功！&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//关闭文件</span></span><br><span class="line">file.<span class="built_in">close</span>();</span><br></pre></td></tr></table></figure>

<h3 id="读文件-1"><a href="#读文件-1" class="headerlink" title="读文件"></a>读文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">QFile file(&quot;in.txt&quot;);</span><br><span class="line">if (!file.open(QIODevice::ReadOnly | QIODevice::Text))</span><br><span class="line">    return;</span><br><span class="line"> </span><br><span class="line">QTextStream in(&amp;file);</span><br><span class="line">while (!in.atEnd()) &#123;</span><br><span class="line">    QString line = in.readLine();</span><br><span class="line">    process_line(line);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="打开多个文件"><a href="#打开多个文件" class="headerlink" title="打开多个文件"></a>打开多个文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">QString strs;</span><br><span class="line">	QStringList file_list, output_name;</span><br><span class="line">	QStringList str_path_list = QFileDialog::getOpenFileNames(this, &quot;open file&quot;, &quot;/&quot;, &quot;cpr file(*.cpr);;All file(*.*)&quot;);</span><br><span class="line">	for (int i = 0; i &lt; str_path_list.size(); i++) &#123;</span><br><span class="line">		QString str_path = str_path_list[i];</span><br><span class="line">		//单个文件路径</span><br><span class="line">		qDebug() &lt;&lt; &quot;path=&quot; &lt;&lt; str_path;</span><br><span class="line">		QFileInfo file = QFileInfo(str_path);</span><br><span class="line">		//获得文件名</span><br><span class="line">		QString file_name = file.fileName();</span><br><span class="line">		file_list.append(str_path);</span><br><span class="line">		output_name.append(file_name);</span><br><span class="line">		strs.append(file_name);</span><br><span class="line">		strs += &quot;\n&quot;;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h3 id="打开文件夹，选择文件"><a href="#打开文件夹，选择文件" class="headerlink" title="打开文件夹，选择文件"></a>打开文件夹，选择文件</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">QString m_srcDirpath = QFileDialog::<span class="built_in">getExistingDirectory</span>(</span><br><span class="line">                     <span class="keyword">this</span>, <span class="string">&quot;choose src Directory&quot;</span>,</span><br><span class="line">                      <span class="string">&quot;/&quot;</span>);</span><br><span class="line"></span><br><span class="line"> QString m_srcDirpath = QFileDialog::<span class="built_in">getOpenFileName</span>(<span class="keyword">this</span>,<span class="string">&quot;open file&quot;</span>,<span class="string">&quot;/&quot;</span>,<span class="string">&quot;text file(*.txt);;C file(*.cpp);;All file(*.*)&quot;</span>);</span><br><span class="line"><span class="comment">//定义变量str接收QFileDialog对话框获取的文件路径</span></span><br><span class="line">QString str = QFileDialog::<span class="built_in">getOpenFileName</span>(<span class="keyword">this</span>,<span class="string">&quot;open file&quot;</span>,<span class="string">&quot;/&quot;</span>,<span class="string">&quot;text file(*.txt);;C file(*.cpp);;All file(*.*)&quot;</span>);</span><br><span class="line"><span class="comment">//文件路径转换为utf8格式</span></span><br><span class="line">QString str_utf8 =str.<span class="built_in">toUtf8</span>();</span><br><span class="line"><span class="comment">//判断是否选择文件</span></span><br><span class="line"><span class="keyword">if</span>(str_utf8.<span class="built_in">isEmpty</span>())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="删除文件"><a href="#删除文件" class="headerlink" title="删除文件"></a>删除文件</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QMessageBox&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QFile&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QFileDialog&gt;</span></span></span><br><span class="line"></span><br><span class="line">QString str = QFileDialog::<span class="built_in">getOpenFileName</span>(<span class="keyword">this</span>,<span class="string">&quot;选择文件&quot;</span>,<span class="string">&quot;/&quot;</span>,<span class="string">&quot;text</span></span><br><span class="line"><span class="string">file(*.txt);;C file(*.cpp);;All file(*.*)&quot;</span>);</span><br><span class="line"><span class="comment">//转换文件路径</span></span><br><span class="line">QString get = str.<span class="built_in">toUtf8</span>();</span><br><span class="line"><span class="comment">//删除文件</span></span><br><span class="line">QFile::<span class="built_in">remove</span>(get);</span><br><span class="line"><span class="comment">//提示</span></span><br><span class="line">QMessageBox::<span class="built_in">warning</span>(<span class="keyword">this</span>,<span class="string">&quot;删除文件&quot;</span>,<span class="string">&quot;删除成功！&quot;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="INI文件写入"><a href="#INI文件写入" class="headerlink" title="INI文件写入"></a>INI文件写入</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QSettings&gt;</span></span></span><br><span class="line"></span><br><span class="line">QSettings *writeIni;</span><br><span class="line"><span class="comment">//QSettings 构造函数的第一个参数是 ini 文件的路径,第二个参数表示针对 ini 文件</span></span><br><span class="line">writeIni = <span class="keyword">new</span> <span class="built_in">QSettings</span>(<span class="string">&quot;D:/CSDN.ini&quot;</span>, QSettings::IniFormat);</span><br><span class="line"><span class="comment">//写入键、值</span></span><br><span class="line">writeIni-&gt;<span class="built_in">setValue</span>(<span class="string">&quot;node&quot;</span>+<span class="string">&quot;/&quot;</span>+<span class="string">&quot;ip&quot;</span>,<span class="string">&quot;192.168.1.1&quot;</span>);</span><br><span class="line"><span class="comment">//写入完成删除指针</span></span><br><span class="line"><span class="keyword">delete</span> writeIni;</span><br></pre></td></tr></table></figure>

<h3 id="INI文件读取"><a href="#INI文件读取" class="headerlink" title="INI文件读取"></a>INI文件读取</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QSettings&gt;</span></span></span><br><span class="line"></span><br><span class="line">QSettings *readIni;</span><br><span class="line">QTextEdit *valEdit = <span class="keyword">new</span> <span class="built_in">QTextEdit</span>(<span class="keyword">this</span>);</span><br><span class="line"><span class="comment">//QSettings 构造函数的第一个参数是 ini 文件的路径,第二个参数表示针对 ini 文件</span></span><br><span class="line">readIni = <span class="keyword">new</span> <span class="built_in">QSettings</span>(<span class="string">&quot;D:/CSDN.ini&quot;</span>, QSettings::IniFormat);</span><br><span class="line"><span class="comment">/*将读取到的 ini 文件保存在 QString 中，先取值，然后通过 toString()函数转换成QString类型*/</span></span><br><span class="line">QString key = <span class="string">&quot;键值&quot;</span>;</span><br><span class="line">QString ipResult = readIni-&gt;<span class="built_in">value</span>(<span class="string">&quot;node&quot;</span>+<span class="string">&quot;/&quot;</span>+key).<span class="built_in">toString</span>();</span><br><span class="line"><span class="comment">//将结果绑定 IP 值控件上</span></span><br><span class="line">valEdit-&gt;<span class="built_in">setText</span>(ipResult);</span><br><span class="line"><span class="comment">//写入完成删除指针</span></span><br><span class="line"><span class="keyword">delete</span> readIni;</span><br></pre></td></tr></table></figure>

<h1 id="遍历文件"><a href="#遍历文件" class="headerlink" title="遍历文件"></a>遍历文件</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//查找当前exe的路径</span></span><br><span class="line">	TCHAR szFilePath[MAX_PATH + <span class="number">1</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="built_in">GetModuleFileName</span>(<span class="literal">NULL</span>, szFilePath, MAX_PATH);</span><br><span class="line">	(_tcsrchr(szFilePath, _T(<span class="string">&#x27;\\&#x27;</span>)))[<span class="number">1</span>] = <span class="number">0</span>; <span class="comment">//删除文件名，只获得路径字串</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> iLen = <span class="built_in">WideCharToMultiByte</span>(CP_ACP, <span class="number">0</span>, szFilePath, <span class="number">-1</span>, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">	<span class="keyword">char</span>* chRtn = <span class="keyword">new</span> <span class="keyword">char</span>[iLen*<span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">char</span>)];</span><br><span class="line">	<span class="built_in">WideCharToMultiByte</span>(CP_ACP, <span class="number">0</span>, szFilePath, <span class="number">-1</span>, chRtn, iLen, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">//读取当前exe下的所有pol文件</span></span><br><span class="line">	string houzhui = (string)chRtn + <span class="string">&quot;*.cpr&quot;</span>;</span><br><span class="line">	<span class="keyword">char</span>* to_search = (<span class="keyword">char</span> *)houzhui.<span class="built_in">data</span>();<span class="comment">// &quot;D:/Examples/Polar_C++/x64/Release/?.png&quot;;</span></span><br><span class="line">	<span class="keyword">intptr_t</span> handle;    <span class="comment">//用于查找的句柄</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> _<span class="title">finddata_t</span> <span class="title">fileinfo</span>;</span>    <span class="comment">//文件信息的结构体</span></span><br><span class="line">	handle = _findfirst(to_search, &amp;fileinfo);    <span class="comment">//第一次查找</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="number">-1</span> == handle) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%s出错啦！请联系我！&quot;</span>, fileinfo.name);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;正在进行%s\n&quot;</span>, fileinfo.name);    <span class="comment">//打印出找到的文件的文件名</span></span><br><span class="line">	</span><br><span class="line">	<span class="built_in">BtnRadarReturnClicked</span>(fileinfo.name);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*if (GetPic((string)chRtn + fileinfo.name, (string)chRtn) == 2)</span></span><br><span class="line"><span class="comment">	&#123;</span></span><br><span class="line"><span class="comment">		printf(&quot;%s出错啦！请联系我！&quot;, fileinfo.name);</span></span><br><span class="line"><span class="comment">		return -1;</span></span><br><span class="line"><span class="comment">	&#125;*/</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (!_findnext(handle, &amp;fileinfo)) &#123;    <span class="comment">//循环查找其它符合的文件，直到找不到其它的为止</span></span><br><span class="line"></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;正在进行%s\n&quot;</span>, fileinfo.name);    <span class="comment">//打印出找到的文件的文件名</span></span><br><span class="line">		<span class="built_in">BtnRadarReturnClicked</span>(fileinfo.name);</span><br><span class="line"></span><br><span class="line">		<span class="comment">/*if (GetPic(fileinfo.name, (string)chRtn) == 2)</span></span><br><span class="line"><span class="comment">		&#123;</span></span><br><span class="line"><span class="comment">			printf(&quot;%s出错啦！请联系我！&quot;, fileinfo.name);</span></span><br><span class="line"><span class="comment">			return -1;</span></span><br><span class="line"><span class="comment">		&#125;*/</span></span><br><span class="line">	&#125;</span><br><span class="line">	_findclose(handle);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;完成！&quot;</span>);</span><br><span class="line">	<span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;io.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">vector&lt;string&gt; vec_path;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">TraverseDirectory</span><span class="params">(std::string path)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	output.<span class="built_in">open</span>(<span class="string">&quot;filepath.txt&quot;</span>, ios::out | std::ios::app, _SH_DENYNO);</span><br><span class="line">	<span class="keyword">if</span> (!output.<span class="built_in">is_open</span>()) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	__int64  Handle;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> __<span class="title">finddata64_t</span>  <span class="title">FileInfo</span>;</span></span><br><span class="line">	string strFind = path + <span class="string">&quot;\\*&quot;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ((Handle = _findfirst64(strFind.<span class="built_in">c_str</span>(), &amp;FileInfo)) == <span class="number">-1L</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;没有找到匹配的项目\n&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//判断是否有子目录</span></span><br><span class="line">		<span class="keyword">if</span> (FileInfo.attrib &amp; _A_SUBDIR)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">//判断是子文件夹</span></span><br><span class="line">			<span class="comment">//下面的判断条件很重要，过滤 . 和 ..</span></span><br><span class="line">			<span class="keyword">if</span> ((<span class="built_in">strcmp</span>(FileInfo.name, <span class="string">&quot;.&quot;</span>) != <span class="number">0</span>) &amp;&amp; (<span class="built_in">strcmp</span>(FileInfo.name, <span class="string">&quot;..&quot;</span>) != <span class="number">0</span>))</span><br><span class="line">			&#123;</span><br><span class="line">				string newPath = path + <span class="string">&quot;\\&quot;</span> + FileInfo.name;</span><br><span class="line">				<span class="built_in">TraverseDirectory</span>(newPath);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>	<span class="comment">//判断是文件</span></span><br><span class="line">		&#123;</span><br><span class="line">			string newPath = path + <span class="string">&quot;\\&quot;</span> + FileInfo.name;</span><br><span class="line">			<span class="keyword">if</span> (newPath.<span class="built_in">find</span>(<span class="string">&quot;.cpr&quot;</span>) != string::npos)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="comment">//自定义操作</span></span><br><span class="line">				vec_path.<span class="built_in">push_back</span>(newPath);</span><br><span class="line">				cout &lt;&lt; newPath &lt;&lt; endl;</span><br><span class="line">				output &lt;&lt; newPath &lt;&lt; endl;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">while</span> (_findnext64(Handle, &amp;FileInfo) == <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	output.<span class="built_in">close</span>();</span><br><span class="line">	_findclose(Handle);</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="文件指针"><a href="#文件指针" class="headerlink" title="文件指针"></a>文件指针</h1><h2 id="C中的文件指针"><a href="#C中的文件指针" class="headerlink" title="C中的文件指针"></a>C中的文件指针</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">声明</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fseek</span><span class="params">(FILE *stream, <span class="keyword">long</span> <span class="keyword">int</span> offset, <span class="keyword">int</span> whence)</span></span></span><br><span class="line"><span class="function">    </span></span><br><span class="line"><span class="function">参数</span></span><br><span class="line"><span class="function">stream -- 这是指向 FILE 对象的指针，该 FILE 对象标识了流。</span></span><br><span class="line"><span class="function">offset -- 这是相对 whence 的偏移量，以字节为单位。（负号前移，正号后移）</span></span><br><span class="line"><span class="function">whence -- 这是表示开始添加偏移 offset 的位置。它一般指定为下列常量之一：</span></span><br><span class="line"><span class="function">    常量	描述</span></span><br><span class="line"><span class="function">    SEEK_SET	文件的开头</span></span><br><span class="line"><span class="function">    SEEK_CUR	文件指针的当前位置</span></span><br><span class="line"><span class="function">    SEEK_END	文件的末尾</span></span><br><span class="line"><span class="function">返回值</span></span><br><span class="line"><span class="function">如果成功，则该函数返回零，否则返回非零值。</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">描述</span></span><br><span class="line"><span class="function">C 库函数 <span class="keyword">long</span> <span class="keyword">int</span> <span class="title">ftell</span><span class="params">(FILE *stream)</span> 返回给定流 stream 的当前文件位置。</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">声明</span></span><br><span class="line"><span class="function">下面是 <span class="title">ftell</span><span class="params">()</span> 函数的声明。</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">int</span> <span class="title">ftell</span><span class="params">(FILE *stream)</span></span></span><br><span class="line"><span class="function">参数</span></span><br><span class="line"><span class="function">stream -- 这是指向 FILE 对象的指针，该 FILE 对象标识了流。</span></span><br><span class="line"><span class="function">返回值</span></span><br><span class="line"><span class="function">该函数返回位置标识符的当前值。如果发生错误，则返回 -1L，全局变量 errno 被设置为一个正值。</span></span><br></pre></td></tr></table></figure>

<h2 id="C-中的文件指针"><a href="#C-中的文件指针" class="headerlink" title="C++中的文件指针"></a>C++中的文件指针</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">C++中<span class="built_in">seep</span>()和<span class="built_in">seekg</span>()函数功能</span><br><span class="line">seekp：设置输出文件流的文件流指针位置（写）</span><br><span class="line">seekg：设置输入文件流的文件流指针位置（读）</span><br><span class="line"></span><br><span class="line">函数原型：</span><br><span class="line"><span class="function">ostream&amp; <span class="title">seekp</span><span class="params">( streampos pos )</span></span>;</span><br><span class="line"><span class="function">ostream&amp; <span class="title">seekp</span><span class="params">( streamoff off, ios::seek_dir dir )</span></span>;</span><br><span class="line"><span class="function">istream&amp; <span class="title">seekg</span><span class="params">( streampos pos )</span></span>;</span><br><span class="line"><span class="function">istream&amp; <span class="title">seekg</span><span class="params">( streamoff off, ios::seek_dir dir )</span></span>;</span><br><span class="line"></span><br><span class="line">函数参数</span><br><span class="line">pos：新的文件流指针位置值</span><br><span class="line">off：需要偏移的值</span><br><span class="line">dir：搜索的起始位置</span><br><span class="line">    dir参数用于对文件流指针的定位操作上，代表搜索的起始位置</span><br><span class="line">    在ios中定义的枚举类型：</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">seek_dir</span> &#123;</span>beg, cur, end&#125;;</span><br><span class="line">    每个枚举常量的含义：</span><br><span class="line">    ios::beg：文件流的起始位置</span><br><span class="line">    ios::cur：文件流的当前位置</span><br><span class="line">    ios::end：文件流的结束位置</span><br></pre></td></tr></table></figure>

<h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">补充：经过调试，发现文件指针有个特性，一旦指针到达文件末尾，就无法再将指针指向文件其他位置，如以下两段代码：</span><br><span class="line"></span><br><span class="line">string str;</span><br><span class="line">srcin.<span class="built_in">seekg</span>(<span class="number">0</span>, ios::end);</span><br><span class="line"><span class="built_in">getline</span>(srcin, str);</span><br><span class="line">cout &lt;&lt; str &lt;&lt; endl;    <span class="comment">//无输出</span></span><br><span class="line">srcin.<span class="built_in">seekg</span>(<span class="number">0</span>, ios::beg);</span><br><span class="line"><span class="built_in">getline</span>(srcin, str);    <span class="comment">//无输出</span></span><br><span class="line"></span><br><span class="line">string str;</span><br><span class="line">srcin.<span class="built_in">seekg</span>(<span class="number">10</span>, ios::beg);</span><br><span class="line"><span class="built_in">getline</span>(srcin, str);</span><br><span class="line">cout &lt;&lt; str &lt;&lt; endl;    <span class="comment">//有输出</span></span><br><span class="line">srcin.<span class="built_in">seekg</span>(<span class="number">0</span>, ios::beg);</span><br><span class="line"><span class="built_in">getline</span>(srcin, str);    <span class="comment">//有输出</span></span><br><span class="line">cout &lt;&lt; str &lt;&lt; endl;</span><br></pre></td></tr></table></figure>



<h1 id="文件大小判断"><a href="#文件大小判断" class="headerlink" title="文件大小判断"></a>文件大小判断</h1><h3 id="Qt-3"><a href="#Qt-3" class="headerlink" title="Qt"></a>Qt</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QFile <span class="title">file</span><span class="params">(record1-&gt;m_SCprName)</span></span>;</span><br><span class="line"><span class="keyword">if</span> (!file.<span class="built_in">open</span>(QIODevice::ReadOnly))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//QMessageBox::information(NULL, record1-&gt;m_SCprName</span></span><br><span class="line">    , QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;cpr文件大小监听失败，只能保存一个文件，请手动停止！&quot;</span>));</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">void</span>*)<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (file.<span class="built_in">size</span>() &gt;= <span class="number">1024</span> * <span class="number">1024</span> * <span class="number">50</span>)</span><br><span class="line">    file.<span class="built_in">close</span>()<span class="comment">//file.size()这个监听的是字节</span></span><br></pre></td></tr></table></figure>

<h3 id="C-3"><a href="#C-3" class="headerlink" title="C++"></a>C++</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ifstream file;</span><br><span class="line">file.<span class="built_in">open</span>(record1-&gt;m_SCprName);</span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">getFileSize</span><span class="params">(ifstream * pFile)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> begin =<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> end = begin;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> FileSize = <span class="number">0</span>;</span><br><span class="line">    pFile-&gt;<span class="built_in">seekg</span>(<span class="number">0</span>, ios_base::end);</span><br><span class="line">    end = pFile-&gt;<span class="built_in">tellg</span>();</span><br><span class="line">    FileSize = end - begin;</span><br><span class="line">    <span class="keyword">return</span> FileSize;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="创建路径-1"><a href="#创建路径-1" class="headerlink" title="创建路径"></a>创建路径</h1><h2 id="Windows-1"><a href="#Windows-1" class="headerlink" title="Windows"></a>Windows</h2><p>不知道为啥，下面的函数动不动就会奔溃，用最上面Qt 的函数</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;direct.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;corecrt_io.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">createDir</span><span class="params">(std::string path)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> m = <span class="number">0</span>, n;</span><br><span class="line">    string str1, str2;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    str1 = path;</span><br><span class="line">    <span class="keyword">if</span> (str1.<span class="built_in">substr</span>(<span class="number">0</span>, <span class="number">2</span>) == <span class="string">&quot;.\\&quot;</span>) &#123;</span><br><span class="line">        str2 = str1.<span class="built_in">substr</span>(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">        str1 = str1.<span class="built_in">substr</span>(<span class="number">2</span>, str1.<span class="built_in">size</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        str2 = str1.<span class="built_in">substr</span>(<span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">        str1 = str1.<span class="built_in">substr</span>(<span class="number">3</span>, str1.<span class="built_in">size</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (m &gt;= <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        m = str1.<span class="built_in">find</span>(<span class="string">&#x27;\\&#x27;</span>);</span><br><span class="line"></span><br><span class="line">        str2 += <span class="string">&#x27;\\&#x27;</span> + str1.<span class="built_in">substr</span>(<span class="number">0</span>, m);</span><br><span class="line">        n = _access(str2.<span class="built_in">c_str</span>(), <span class="number">0</span>); <span class="comment">//判断该目录是否存在</span></span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">-1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (_mkdir(str2.<span class="built_in">c_str</span>()) != <span class="number">0</span>)     <span class="comment">//创建目录</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        str1 = str1.<span class="built_in">substr</span>(m + <span class="number">1</span>, str1.<span class="built_in">size</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/stat.h&gt;</span> 　</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstddef&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">std::string <span class="title">mkdir_path</span><span class="params">(<span class="keyword">char</span> *p_cMkdir)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> file_name[<span class="number">1024</span>];</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">timeval</span> <span class="title">tv</span>;</span><span class="comment">//秒,微秒</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">tm</span> *<span class="title">time</span>;</span><span class="comment">//年月日时分秒</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> name[<span class="number">128</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">char</span> sub_path[<span class="number">128</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">gettimeofday</span>(&amp;tv, <span class="literal">NULL</span>);</span><br><span class="line">    time = <span class="built_in">localtime</span>(&amp;tv.tv_sec);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">strftime</span>(name, <span class="number">128</span>, <span class="string">&quot;%Y%m%d-%H-%M-%S.cpr&quot;</span>, time);</span><br><span class="line">    <span class="built_in">strftime</span>(sub_path, <span class="number">128</span>, <span class="string">&quot;%m%d/&quot;</span>, time);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">sprintf</span>(file_name,<span class="string">&quot;%s%s&quot;</span>,p_cMkdir,sub_path);</span><br><span class="line"></span><br><span class="line">    DIR *dir = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">if</span>((dir = <span class="built_in">opendir</span>(file_name)) == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> ret = <span class="built_in">mkdir</span>(file_name,S_IRWXU|S_IRGRP|S_IXGRP|S_IROTH|S_IXOTH);<span class="comment">//自动创建日期文件夹</span></span><br><span class="line">        <span class="keyword">if</span>(ret &lt; <span class="number">0</span> )</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;current path is not exist!&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;path is created success!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">closedir</span>(dir);</span><br><span class="line">    <span class="built_in">strcat</span>(file_name,name);<span class="comment">//追加文件名</span></span><br><span class="line">    <span class="keyword">return</span> file_name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">std::string strName=<span class="built_in">mkdir_path</span>(<span class="string">&quot;/home/salman/30/&quot;</span>);<span class="comment">//最后一个字符一定要加/</span></span><br></pre></td></tr></table></figure>



<h1 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h1><h2 id="删除非空文件夹及文件夹下的文件"><a href="#删除非空文件夹及文件夹下的文件" class="headerlink" title="删除非空文件夹及文件夹下的文件"></a>删除非空文件夹及文件夹下的文件</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">RadarOverlay::removeDir</span><span class="params">(string dirPath)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">finddata_t</span> <span class="title">fb</span>;</span> <span class="comment">//find the storage structure of the same properties file.</span></span><br><span class="line">    string path;</span><br><span class="line">    <span class="keyword">long</span> handle;</span><br><span class="line">    <span class="keyword">int</span> resultone;</span><br><span class="line">    <span class="keyword">int</span> noFile; <span class="comment">// the tag for the system&#x27;s hidden files</span></span><br><span class="line"></span><br><span class="line">    noFile = <span class="number">0</span>;</span><br><span class="line">    handle = <span class="number">0</span>;</span><br><span class="line">    path = dirPath + <span class="string">&quot;/*&quot;</span>;</span><br><span class="line"></span><br><span class="line">    handle = _findfirst(path.<span class="built_in">c_str</span>(), &amp;fb);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//find the first matching file</span></span><br><span class="line">    <span class="keyword">if</span> (handle != <span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//find next matching file</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="number">0</span> == _findnext(handle, &amp;fb))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// &quot;.&quot; and &quot;..&quot; are not processed</span></span><br><span class="line">            noFile = <span class="built_in">strcmp</span>(fb.name, <span class="string">&quot;..&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="number">0</span> != noFile)</span><br><span class="line">            &#123;</span><br><span class="line">                path.<span class="built_in">clear</span>();</span><br><span class="line">                path = dirPath + <span class="string">&quot;/&quot;</span> + fb.name;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//fb.attrib == 16 means folder</span></span><br><span class="line">                <span class="keyword">if</span> (fb.attrib == <span class="number">16</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">removeDir</span>(path);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">//not folder, delete it. if empty folder, using _rmdir istead.</span></span><br><span class="line">                    <span class="built_in">remove</span>(path.<span class="built_in">c_str</span>());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// close the folder and delete it only if it is closed. For standard c, using closedir instead(findclose -&gt; closedir).</span></span><br><span class="line">        <span class="comment">// when Handle is created, it should be closed at last.</span></span><br><span class="line">        _findclose(handle);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line"> <span class="keyword">char</span> *savePath = “/home/zhuwei/contour/linearIteration.shp”;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span>(<span class="built_in">remove</span>(savePath)==<span class="number">0</span>)</span><br><span class="line"> &#123;</span><br><span class="line"> cout&lt;&lt;“删除成功”&lt;&lt;endl;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line"> &#123;</span><br><span class="line"> cout&lt;&lt;“删除失败”&lt;&lt;endl;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="删除一个文件"><a href="#删除一个文件" class="headerlink" title="删除一个文件"></a>删除一个文件</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">logPath = m_pExportSetting-&gt;m_pathTracks + QString::<span class="built_in">number</span>(<span class="number">0</span>) + QString::<span class="built_in">fromLocal8Bit</span>(<span class="string">&quot;.csv&quot;</span>);</span><br><span class="line"><span class="function">QFileInfo <span class="title">delfile</span><span class="params">(logPath)</span></span>;</span><br><span class="line"><span class="keyword">if</span> (delfile.<span class="built_in">isFile</span>())</span><br><span class="line">&#123;</span><br><span class="line">    QFile f;</span><br><span class="line">    f.<span class="built_in">remove</span>(logPath);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Smt</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://zwlbird.github.io/2021/06/20/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/">https://zwlbird.github.io/2021/06/20/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://zwlbird.github.io" target="_blank">.oOo.</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Qt/">Qt</a><a class="post-meta__tags" href="/tags/C/">C++</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2021/06/27/oW4MJr2aCzHYjZG.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/06/20/%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9B%B8%E5%85%B3/"><img class="prev-cover" src="https://i.loli.net/2021/06/27/W8xTBGA2O7JhRHl.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">字符串相关</div></div></a></div><div class="next-post pull-right"><a href="/2021/06/20/%E5%A4%B4%E6%96%87%E4%BB%B6/"><img class="next-cover" src="https://i.loli.net/2021/06/27/bhoY29lQPvSAr6z.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">头文件</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/04/03/Hexo/" title="Hexo"><img class="cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-03</div><div class="title">Hexo</div></div></a></div><div><a href="/2021/06/27/C/" title="C++"><img class="cover" src="https://s2.loli.net/2023/12/12/cYpI451Z9oJwFqQ.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-27</div><div class="title">C++</div></div></a></div><div><a href="/2021/06/27/函数积累/" title="函数积累"><img class="cover" src="https://s2.loli.net/2023/12/12/dkLQxaftyKTzXoR.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-27</div><div class="title">函数积累</div></div></a></div><div><a href="/2021/06/20/头文件/" title="头文件"><img class="cover" src="https://i.loli.net/2021/06/27/bhoY29lQPvSAr6z.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-20</div><div class="title">头文件</div></div></a></div><div><a href="/2021/06/20/字符串相关/" title="字符串相关"><img class="cover" src="https://i.loli.net/2021/06/27/W8xTBGA2O7JhRHl.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-20</div><div class="title">字符串相关</div></div></a></div><div><a href="/2021/08/11/数据结构/" title="数据结构"><img class="cover" src="https://s2.loli.net/2023/12/12/9iokGWsR2Lrux78.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-11</div><div class="title">数据结构</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Smt</div><div class="author-info__description">哇咔咔</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/zwlbird/zwlbird.github.io" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:zwl931025@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">This is my Blog This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="toc-number">1.</span> <span class="toc-text">创建文件夹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Qt"><span class="toc-number">1.1.</span> <span class="toc-text">Qt</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9-1"><span class="toc-number">1.1.1.</span> <span class="toc-text">创建文件夹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%B7%AF%E5%BE%84"><span class="toc-number">1.1.2.</span> <span class="toc-text">创建路径</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C"><span class="toc-number">1.2.</span> <span class="toc-text">C++</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-system-%E8%B0%83%E7%94%A8-dos-%E5%91%BD%E4%BB%A4"><span class="toc-number">1.2.1.</span> <span class="toc-text">使用 system() 调用 dos 命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8access-%E5%92%8C-mkdir-%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.2.</span> <span class="toc-text">使用access 和 mkdir 函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%83%E7%94%A8-Windows-API-%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.3.</span> <span class="toc-text">调用 Windows API 函数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="toc-number">2.</span> <span class="toc-text">删除文件夹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#C-1"><span class="toc-number">2.1.</span> <span class="toc-text">C++</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%83%E7%94%A8Windows-API%E5%87%BD%E6%95%B0"><span class="toc-number">2.1.1.</span> <span class="toc-text">调用Windows API函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%83%E7%94%A8C%E8%BF%90%E8%A1%8C%E5%BA%93%E5%87%BD%E6%95%B0"><span class="toc-number">2.1.2.</span> <span class="toc-text">调用C运行库函数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%98%AF%E5%90%A6%E6%98%AF%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="toc-number">3.</span> <span class="toc-text">查询是否是文件夹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E5%AD%90%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="toc-number">4.</span> <span class="toc-text">查询子文件夹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Windows"><span class="toc-number">4.1.</span> <span class="toc-text">Windows</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Qt-1"><span class="toc-number">4.1.1.</span> <span class="toc-text">Qt</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="toc-number">5.</span> <span class="toc-text">文件操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#C-2"><span class="toc-number">5.1.</span> <span class="toc-text">C++</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6-%E4%BA%8C%E8%BF%9B%E5%88%B6"><span class="toc-number">5.1.1.</span> <span class="toc-text">打开文件 二进制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96-ANSI-UNICODE-UTF-8-%E4%BA%8C%E8%BF%9B%E5%88%B6"><span class="toc-number">5.1.2.</span> <span class="toc-text">读取 ANSI,UNICODE,UTF-8 二进制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%BD%E5%AD%97%E7%AC%A6%E6%96%87%E4%BB%B6C-%E8%AF%BB%E5%8F%96"><span class="toc-number">5.1.3.</span> <span class="toc-text">宽字符文件C++读取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%BD%E5%AD%97%E7%AC%A6%E6%96%87%E4%BB%B6C-%E5%86%99"><span class="toc-number">5.1.4.</span> <span class="toc-text">宽字符文件C++写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%99%E6%96%87%E4%BB%B6"><span class="toc-number">5.1.5.</span> <span class="toc-text">写文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E6%96%87%E4%BB%B6"><span class="toc-number">5.1.6.</span> <span class="toc-text">读文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Qt-2"><span class="toc-number">5.2.</span> <span class="toc-text">Qt</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6"><span class="toc-number">5.2.1.</span> <span class="toc-text">写入文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E6%96%87%E4%BB%B6-1"><span class="toc-number">5.2.2.</span> <span class="toc-text">读文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%93%E5%BC%80%E5%A4%9A%E4%B8%AA%E6%96%87%E4%BB%B6"><span class="toc-number">5.2.3.</span> <span class="toc-text">打开多个文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6%E5%A4%B9%EF%BC%8C%E9%80%89%E6%8B%A9%E6%96%87%E4%BB%B6"><span class="toc-number">5.2.4.</span> <span class="toc-text">打开文件夹，选择文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6"><span class="toc-number">5.2.5.</span> <span class="toc-text">删除文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#INI%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5"><span class="toc-number">5.2.6.</span> <span class="toc-text">INI文件写入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#INI%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="toc-number">5.2.7.</span> <span class="toc-text">INI文件读取</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6"><span class="toc-number">6.</span> <span class="toc-text">遍历文件</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%8C%87%E9%92%88"><span class="toc-number">7.</span> <span class="toc-text">文件指针</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#C%E4%B8%AD%E7%9A%84%E6%96%87%E4%BB%B6%E6%8C%87%E9%92%88"><span class="toc-number">7.1.</span> <span class="toc-text">C中的文件指针</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C-%E4%B8%AD%E7%9A%84%E6%96%87%E4%BB%B6%E6%8C%87%E9%92%88"><span class="toc-number">7.2.</span> <span class="toc-text">C++中的文件指针</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%A5%E5%85%85"><span class="toc-number">7.3.</span> <span class="toc-text">补充</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F%E5%88%A4%E6%96%AD"><span class="toc-number">8.</span> <span class="toc-text">文件大小判断</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Qt-3"><span class="toc-number">8.0.1.</span> <span class="toc-text">Qt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#C-3"><span class="toc-number">8.0.2.</span> <span class="toc-text">C++</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%B7%AF%E5%BE%84-1"><span class="toc-number">9.</span> <span class="toc-text">创建路径</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Windows-1"><span class="toc-number">9.1.</span> <span class="toc-text">Windows</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Linux"><span class="toc-number">9.2.</span> <span class="toc-text">Linux</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B"><span class="toc-number">10.</span> <span class="toc-text">案例</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E9%9D%9E%E7%A9%BA%E6%96%87%E4%BB%B6%E5%A4%B9%E5%8F%8A%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%E7%9A%84%E6%96%87%E4%BB%B6"><span class="toc-number">10.1.</span> <span class="toc-text">删除非空文件夹及文件夹下的文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6"><span class="toc-number">10.2.</span> <span class="toc-text">删除一个文件</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/04/03/Hexo/" title="Hexo"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hexo"/></a><div class="content"><a class="title" href="/2022/04/03/Hexo/" title="Hexo">Hexo</a><time datetime="2022-04-02T16:33:52.000Z" title="发表于 2022-04-03 00:33:52">2022-04-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/10/31/Android/" title="Android"><img src="https://s2.loli.net/2023/12/12/gfXKlqmwMWzPxH7.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android"/></a><div class="content"><a class="title" href="/2021/10/31/Android/" title="Android">Android</a><time datetime="2021-10-31T14:03:21.000Z" title="发表于 2021-10-31 22:03:21">2021-10-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/10/19/OpenGL-highlevel/" title="OpenGL-highlevel"><img src="https://s2.loli.net/2023/12/12/zb5QarqSYDHWZs6.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OpenGL-highlevel"/></a><div class="content"><a class="title" href="/2021/10/19/OpenGL-highlevel/" title="OpenGL-highlevel">OpenGL-highlevel</a><time datetime="2021-10-19T13:35:33.000Z" title="发表于 2021-10-19 21:35:33">2021-10-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/10/17/OpenGL-light/" title="OpenGL-light"><img src="https://s2.loli.net/2023/12/12/Dlf5uYb78R1Firw.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OpenGL-light"/></a><div class="content"><a class="title" href="/2021/10/17/OpenGL-light/" title="OpenGL-light">OpenGL-light</a><time datetime="2021-10-17T14:09:58.000Z" title="发表于 2021-10-17 22:09:58">2021-10-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/09/21/OpenGL-3D/" title="OpenGL_3D"><img src="https://s2.loli.net/2023/12/12/EZS5QGm23HLgvW4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OpenGL_3D"/></a><div class="content"><a class="title" href="/2021/09/21/OpenGL-3D/" title="OpenGL_3D">OpenGL_3D</a><time datetime="2021-09-21T07:31:53.000Z" title="发表于 2021-09-21 15:31:53">2021-09-21</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://i.loli.net/2021/06/27/oW4MJr2aCzHYjZG.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Smt</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'RrMFpOdr0spfIDfRdBukvyf7-gzGzoHsz',
      appKey: 'nipjeGzTyw5yvNk2SgU5KmUQ',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><script src="https://myhkw.cn/api/player/162393526192" id="myhk" key="162393526192" m="1"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="false"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>